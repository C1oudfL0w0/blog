
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <title>2024网鼎杯半决赛 | 雲流のLowest World</title>
    <meta name="author" content="C1oudfL0w0" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <link rel="icon" href="/blog/images/croppedImage_cropped.jpg" />
    <!-- cdn挂掉的时候要可以引用本地 -->
<!-- <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script> -->
<script src="/blog/js/vue.global.prod.min.js"></script>


<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css" />


<link rel="stylesheet" href="/blog/css/all.min.css" />
<link rel="stylesheet" href="/blog/css/fonts.min.css" />
<link rel="stylesheet" href="/blog/css/search.css" />
<script> const mixins = {}; </script>

<!-- 引入jQuery-->
<!-- <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script> -->
<script src="/blog/js/jquery.min.js"></script>

<!--改成了prismjs高亮-->

<script src="/blog/js/lib/prism.js"></script>
<link rel="stylesheet" href="/blog/css/prism.css" rel="stylesheet" />



<script src="/blog/js/lib/preview.js"></script>










<script src="/blog/js/lib/home.js"></script>

<link rel="stylesheet" href="/blog/css/main.css" />
<!-- 引入不蒜子-->

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<!-- 引入clipboard -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeCopy.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/blog/atom.xml" title="雲流のLowest World" type="application/atom+xml">
</head>

<body>
    <!--flag{never_g0nna g1ve_you up}-->

    <!-- 页面点击特效 -->
    <script type="text/javascript" src="/blog/js/love-click.js"></script>

    <!-- 浏览器标题 -->
    <script async type="text/javascript" src="/blog/js/FunnyTitle.js"></script>

    <!-- 动态背景 -->
    

    <!--文章目录-->
    
    <div id="toc" class="toc-article">
    <h3><i class="fas fa-stream"></i>  目录</h3>
      <div class="toc-title"></div>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B8%97%E9%80%8F"><span class="toc-number">2.</span> <span class="toc-text">渗透</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ip%E6%8E%A2%E6%B5%8B"><span class="toc-number">3.</span> <span class="toc-text">ip探测</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5%E5%85%A5%E5%8F%A3-114-114-114-100"><span class="toc-number">4.</span> <span class="toc-text">首页入口-114.114.114.100</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#app%E9%80%86%E5%90%91"><span class="toc-number">4.1.</span> <span class="toc-text">app逆向</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F"><span class="toc-number">4.2.</span> <span class="toc-text">扫描</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%81%92%E6%B1%87IPO-114-114-114-199%EF%BC%88%E5%A4%8D%E7%8E%B0%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">恒汇IPO-114.114.114.199（复现）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F-1"><span class="toc-number">5.1.</span> <span class="toc-text">扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E5%99%A8getshell"><span class="toc-number">5.2.</span> <span class="toc-text">编辑器getshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">5.3.</span> <span class="toc-text">连接数据库</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%91%E6%94%AF%E4%BB%98-114-114-114-229-44514"><span class="toc-number">6.</span> <span class="toc-text">云支付-114.114.114.229:44514</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F-2"><span class="toc-number">6.1.</span> <span class="toc-text">扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%BA%94%E6%88%90%E5%8A%9F%E7%9A%84%E5%90%8E%E5%8F%B0%E5%BC%B1%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95%EF%BC%88%F0%9F%98%A1%EF%BC%89"><span class="toc-number">6.2.</span> <span class="toc-text">本应成功的后台弱密码登录（😡）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AA%E8%83%BD%E6%8B%BF%E5%88%B0%E7%9A%84%E5%89%8D%E5%8F%B0%E5%95%86%E6%88%B7key"><span class="toc-number">6.3.</span> <span class="toc-text">未能拿到的前台商户key</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%A2%E6%9C%8D%E7%B3%BB%E7%BB%9F-114-114-114-20"><span class="toc-number">7.</span> <span class="toc-text">客服系统-114.114.114.20</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%AB%E6%8F%8F-3"><span class="toc-number">7.1.</span> <span class="toc-text">扫描</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#254-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-number">8.</span> <span class="toc-text">254 端口扫描</span></a></li></ol>
    </div>
  

    <!--返回顶部-->
    <div id="totop" style="position:fixed;bottom:50px;right:60px;font-size: 48px;cursor: pointer;z-index: 10;">
        <a title="返回顶部">↑</a>
    </div>
    <script src="/blog/js/totop.js"></script>

    <div id="layout">
        
            <div id="content-background" ref="contentBackground" data-images="https://pic.imgdb.cn/item/65d61d809f345e8d03b8bc7a.png"></div>
            
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>第一次加载文章图片可能会花费较长时间</p>
                    <p>要不挂个梯子试试？（x</p>
                    <p>加载过慢请开启缓存&ensp;浏览器默认开启</p>
                    <img src="/blog/images/loading.gif" />
                </div>
            </div>
        </transition>
        <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/blog/">
            <span>雲流のLOWEST WORLD</span>
        </a>
        
        <a href="/blog/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/blog/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/blog/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/blog/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/blog/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
        <a href="/blog/links">
            <i class="fa-solid fa-link fa-fw"></i>
            <span>&ensp;Links</span>
        </a>
        
        <a href="/blog/search">
            <i class="fa-solid fa-search fa-fw"></i>
            <span>&ensp;Search</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;雲流のLOWEST WORLD</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/blog/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/blog/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/blog/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/blog/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/blog/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
            <a href="/blog/links">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-link fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Links</div>
                </div>
            </a>
            
            <a href="/blog/search">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-search fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Search</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>2024网鼎杯半决赛</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/11/23
        </span>
        
        <span class="category">
            <a href="/blog/categories/%E7%BA%BF%E4%B8%8B%E8%B5%9B/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                线下赛
            </a>
        </span>
        
        
        <!--文章字数统计-->
        
            
<div style="margin-top:10px;">
    <span class="post-time">
      <span class="post-meta-item-icon">
        <i class="fa fa-keyboard-o"></i>
        <span class="post-meta-item-text">  字数统计: </span>
        <!-- 安装插件npm install hexo-wordcount --save -->
        <span class="post-count">2.3k字</span>
      </span>
    </span>

    <span class="post-time">
      &nbsp; | &nbsp;
      <span class="post-meta-item-icon">
        <i class="fa fa-hourglass-half"></i>
        <span class="post-meta-item-text">  阅读时长: </span>
        <span class="post-count">12分</span>
      </span>
    </span>
    
    <!--不蒜子统计访问数-->
    <span id="busuanzi_container_page_pv">
    &nbsp; | &nbsp;
    总文章阅读量：<span id="busuanzi_value_page_pv"></span>次
    </span>
</div>

          
    </div>
    
    <div class="content" v-pre>
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>谁偷走了我的云支付首页手机号弱密码登录！</p>
<p>ctf没有web，<del>渗透还寄了</del>，可惜队友安全运营一个第3一个第8了，遗憾退场</p>
<p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_30817059/article/details/144030914#t5">https://blog.csdn.net/qq_30817059/article/details/144030914#t5</a></p>
<span id="more"></span>

<hr>
<h1 id="渗透"><a href="#渗透" class="headerlink" title="渗透"></a>渗透</h1><h1 id="ip探测"><a href="#ip探测" class="headerlink" title="ip探测"></a>ip探测</h1><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">114.114.114.1 是存活地址
114.114.114.20 是存活地址
- 在线客服系统
//114.114.114.44 是存活地址
- 工具平台
//114.114.114.55 是存活地址
//114.114.114.88 是存活地址
114.114.114.100 是存活地址
- 80 - 致富国际
114.114.114.199 是存活地址
- 80 - 恒丰IPO
114.114.114.229 是存活地址
- 44514 - 云支付
114.114.114.253 是存活地址
114.114.114.254 是存活地址<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="首页入口-114-114-114-100"><a href="#首页入口-114-114-114-100" class="headerlink" title="首页入口-114.114.114.100"></a>首页入口-114.114.114.100</h1><h2 id="app逆向"><a href="#app逆向" class="headerlink" title="app逆向"></a>app逆向</h2><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203150821945.png" alt="image-20241203150821945"></p>
<p>首页二维码扫出来的链接为</p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;114.114.114.100&#x2F;apk&#x2F;apk-release.apk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>反编译apk，搜flag</p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241123100357678.png" alt="image-20241123100357678"></p>
<h2 id="扫描"><a href="#扫描" class="headerlink" title="扫描"></a>扫描</h2><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203151225193.png" alt="image-20241203151225193"></p>
<p>没东西</p>
<p>nmap</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">PORT      STATE SERVICE    VERSION
25/tcp    open  tcpwrapped
|_smtp-commands: Couldn't establish connection on port 25
53/tcp    open  tcpwrapped
80/tcp    open  http       nginx
|_http-title: \xE8\x87\xB4\xE5\xAF\x8C\xE5\x9B\xBD\xE9\x99\x85
110/tcp   open  tcpwrapped
111/tcp   open  rpcbind    2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      32780/tcp   mountd
|   100005  1,2,3      32780/tcp6  mountd
|   100005  1,2,3      32780/udp   mountd
|   100005  1,2,3      32780/udp6  mountd
|   100021  1,3,4      32777/tcp   nlockmgr
|   100021  1,3,4      32777/tcp6  nlockmgr
|   100021  1,3,4      32777/udp   nlockmgr
|   100021  1,3,4      32777/udp6  nlockmgr
|   100024  1          32778/tcp   status
|   100024  1          32778/tcp6  status
|   100024  1          32778/udp   status
|_  100024  1          32778/udp6  status
2049/tcp  open  nfs        3-4 (RPC #100003)
32780/tcp open  mountd     1-3 (RPC #100005)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h1 id="恒汇IPO-114-114-114-199（复现）"><a href="#恒汇IPO-114-114-114-199（复现）" class="headerlink" title="恒汇IPO-114.114.114.199（复现）"></a>恒汇IPO-114.114.114.199（复现）</h1><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203151014947.png" alt="image-20241203151014947"></p>
<p>模块架构的访问方式，dirsearch扫不出有价值的信息</p>
<p>测出一个admin模块</p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//114.114.114.199/index.php?mod=admin&amp;act=login</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203153801724.png" alt="image-20241203153801724"></p>
<p>弱密码爆破无果，尝试sql注入，发现卧槽挂了个G01</p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203162440194.png" alt="image-20241203162440194"></p>
<p>测试还发现存在mobile模块，还有一个a模块，不知道为什么访问a模块会导致服务被重启（</p>
<p>mobile模块里面没有什么可以利用的东西</p>
<h2 id="扫描-1"><a href="#扫描-1" class="headerlink" title="扫描"></a>扫描</h2><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">PORT      STATE    SERVICE    VERSION
25/tcp    open     tcpwrapped
|_smtp-commands: Couldn't establish connection on port 25
53/tcp    open     tcpwrapped
80/tcp    open     http       wdb
| http-title: \xE6\x81\x92\xE6\xB1\x87IPO - \xE7\x94\xA8\xE6\x88\xB7\xE7\x99\xBB\xE9\x99\x86
|_Requested resource was /index.php?mod=member&amp;act=login&amp;url=P21vZD1tZW1iZXI=
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-server-header: wdb
| fingerprint-strings: 
|   GetRequest: 
|     HTTP/1.1 302 Found
|     Date: Sat, 23 Nov 2024 02:52:35 GMT
|     Server: wdb
|     Set-Cookie: PHPSESSID=9bhitpr8oir6tjjh61804b9bp7; path=/
|     Expires: Thu, 19 Nov 1981 08:52:00 GMT
|     Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
|     Pragma: no-cache
|     Location: /index.php?mod=member
|     Content-Length: 0
|     Connection: close
|     Content-Type: text/html;charset=utf-8
|   HTTPOptions: 
|     HTTP/1.1 404 Not Found
|     Date: Sat, 23 Nov 2024 02:52:36 GMT
|     Server: wdb
|     Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
|     Content-Length: 9545
|     Connection: close
|     Content-Type: text/html; charset=UTF-8
|     &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">&lt;html xmlns="http://www.w3.org/1999/xhtml">&lt;head>&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />&lt;meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, post-check=0, pre-check=0"/>&lt;meta http-equiv="Connection" content="Close"/>&lt;title>&amp;#x7F51;&amp;#x7AD9;&amp;#x9632;&amp;#x706B;&amp;#x5899;&lt;/title>&lt;style type="text/css">a,img,h1,body,p&#123; margin:0; padding:0; list-style:none; border:none;&#125;body&#123; font-family:
|     font-size:12px; background:#fff;&#125;table&#123; margin: 0; padding: 0; width: 100%;&#125;a:hover, a:link,
|   RTSPRequest: 
|     HTTP/1.1 400 Bad Request
|     Date: Sat, 23 Nov 2024 02:52:36 GMT
|     Server: wdb
|     Content-Length: 226
|     Connection: close
|     Content-Type: text/html; charset=iso-8859-1
|     &lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
|     &lt;html>&lt;head>
|     &lt;title>400 Bad Request&lt;/title>
|     &lt;/head>&lt;body>
|     &lt;h1>Bad Request&lt;/h1>
|     &lt;p>Your browser sent a request that this server could not understand.&lt;br />
|     &lt;/p>
|_    &lt;/body>&lt;/html>
110/tcp   open     tcpwrapped
111/tcp   open     rpcbind    2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      32780/tcp   mountd
|   100005  1,2,3      32780/tcp6  mountd
|   100005  1,2,3      32780/udp   mountd
|   100005  1,2,3      32780/udp6  mountd
|   100021  1,3,4      32777/tcp   nlockmgr
|   100021  1,3,4      32777/tcp6  nlockmgr
|   100021  1,3,4      32777/udp   nlockmgr
|   100021  1,3,4      32777/udp6  nlockmgr
|   100024  1          32778/tcp   status
|   100024  1          32778/tcp6  status
|   100024  1          32778/udp   status
|_  100024  1          32778/udp6  status
514/tcp   filtered shell
2049/tcp  open     nfs        3-4 (RPC #100003)
7681/tcp  open     unknown
| fingerprint-strings: 
|   GetRequest, HTTPOptions, RTSPRequest: 
|     HTTP/1.0 200 OK
|     server: ttyd/1.6.3 (libwebsockets/4.2.1-09e6c20)
|     content-type: text/html
|     content-length: 464459
|_    &lt;!DOCTYPE html>&lt;html lang="en">&lt;head>&lt;meta charset="UTF-8">&lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">&lt;title>ttyd - Terminal&lt;/title>&lt;link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAcCAYAAAAAwr0iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA0xpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vb
8620/tcp  open     unknown
| fingerprint-strings: 
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, GetRequest, HTTPOptions, Help, Kerberos, RPCCheck, RTSPRequest, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie: 
|     HTTP/1.1 200 WebSocket
|     Server: workerman/4.0.27
|_    &lt;div style="text-align:center">&lt;h1>WebSocket&lt;/h1>&lt;hr>workerman/4.0.27&lt;/div>
32777/tcp open     nlockmgr   1-4 (RPC #100021)
32778/tcp open     status     1 (RPC #100024)
32780/tcp open     mountd     1-3 (RPC #100005)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="编辑器getshell"><a href="#编辑器getshell" class="headerlink" title="编辑器getshell"></a>编辑器getshell</h2><p>通过信息收集发现 admin 模块下存在一个 shop action，是个编辑器，可以文件上传</p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203163218111.png" alt="image-20241203163218111"></p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203163253822.png" alt="image-20241203163253822"></p>
<p>rce函数都被禁用,但是 file_get_contents 以及 readfile 等读取函数没有被禁用，于是可以拿到 flag</p>
<h2 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h2><p>通过文件读取读到数据库的配置，获取到账密</p>
<p>反正 getshell 了，蚁剑连上去，用php连接数据库应该也不是什么问题</p>
<hr>
<h1 id="云支付-114-114-114-229-44514"><a href="#云支付-114-114-114-229-44514" class="headerlink" title="云支付-114.114.114.229:44514"></a>云支付-114.114.114.229:44514</h1><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203151625344.png" alt="image-20241203151625344"></p>
<h2 id="扫描-2"><a href="#扫描-2" class="headerlink" title="扫描"></a>扫描</h2><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/db76b484-1d8e-403a-93e9-f69d3dff6ede.png" alt="db76b484-1d8e-403a-93e9-f69d3dff6ede"></p>
<p>存在flag.php，可以尝试找个文件读取</p>
<p>访问 admin 下的所有文件都会被重定向到 admin&#x2F;login.php</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">PORT      STATE SERVICE    VERSION
25/tcp    open  tcpwrapped
|_smtp-commands: Couldn't establish connection on port 25
53/tcp    open  tcpwrapped
80/tcp    open  http       nginx
|_http-title: \xE6\xB2\xA1\xE6\x9C\x89\xE6\x89\xBE\xE5\x88\xB0\xE7\xAB\x99\xE7\x82\xB9
110/tcp   open  tcpwrapped
111/tcp   open  rpcbind    2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      32780/tcp   mountd
|   100005  1,2,3      32780/tcp6  mountd
|   100005  1,2,3      32780/udp   mountd
|   100005  1,2,3      32780/udp6  mountd
|   100021  1,3,4      32777/tcp   nlockmgr
|   100021  1,3,4      32777/tcp6  nlockmgr
|   100021  1,3,4      32777/udp   nlockmgr
|   100021  1,3,4      32777/udp6  nlockmgr
|   100024  1          32778/tcp   status
|   100024  1          32778/tcp6  status
|   100024  1          32778/udp   status
|_  100024  1          32778/udp6  status
2049/tcp  open  nfs        3-4 (RPC #100003)
7681/tcp  open  unknown
| fingerprint-strings: 
|   GetRequest, HTTPOptions, RTSPRequest: 
|     HTTP/1.0 200 OK
|     server: ttyd/1.6.3 (libwebsockets/4.2.1-09e6c20)
|     content-type: text/html
|     content-length: 464459
|_    &lt;!DOCTYPE html>&lt;html lang="en">&lt;head>&lt;meta charset="UTF-8">&lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">&lt;title>ttyd - Terminal&lt;/title>&lt;link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAcCAYAAAAAwr0iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA0xpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vb
8620/tcp  open  unknown
| fingerprint-strings: 
|   DNSStatusRequestTCP, DNSVersionBindReqTCP, GetRequest, HTTPOptions, Help, Kerberos, RPCCheck, RTSPRequest, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie: 
|     HTTP/1.1 200 WebSocket
|     Server: workerman/4.0.27
|_    &lt;div style="text-align:center">&lt;h1>WebSocket&lt;/h1>&lt;hr>workerman/4.0.27&lt;/div>
32777/tcp open  nlockmgr   1-4 (RPC #100021)
32778/tcp open  status     1 (RPC #100024)
32780/tcp open  mountd     1-3 (RPC #100005)
44514/tcp open  http       Apache httpd 2.4.6 ((CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16)
|_http-title: \xE4\xBA\x91\xE6\x94\xAF\xE4\xBB\x98 - \xE4\xB8\x93\xE6\xB3\xA8\xE5\x85\x8D\xE7\xAD\xBE\xE7\xBA\xA6\xE8\xAE\xA9\xE6\x94\xAF\xE4\xBB\x98\xE5\xAF\xB9\xE6\x8E\xA5\xE6\x9B\xB4\xE7\xAE\x80\xE5\x8D\x95\xEF\xBC\x81
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>7681端口是个终端，应该是主办方用来管理容器的</p>
<p>尝试爆破弱密码失败</p>
<h2 id="本应成功的后台弱密码登录（😡）"><a href="#本应成功的后台弱密码登录（😡）" class="headerlink" title="本应成功的后台弱密码登录（😡）"></a>本应成功的后台弱密码登录（😡）</h2><p>然后呢，然后尝试拿下面的联系方式作为密码登录admin</p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203152803529.png" alt="image-20241203152803529"></p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203152833405.png" alt="image-20241203152833405"></p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203152847462.png" alt="image-20241203152847462"></p>
<p>？？？赛后看别人的wp和我录屏的时候发现正解就是这个啊</p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203160722494.png" alt="image-20241203160722494"></p>
<p>唉草台班子</p>
<p>后台插件下载这里存在任意文件下载，把flag.php下下来就行（我说admin下面放个几b的php.zip干什么）</p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203162119216.png" alt="image-20241203162119216"></p>
<h2 id="未能拿到的前台商户key"><a href="#未能拿到的前台商户key" class="headerlink" title="未能拿到的前台商户key"></a>未能拿到的前台商户key</h2><p>进去的话就能拿到商户的key</p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203161914233.png" alt="image-20241203161914233"></p>
<p>然后去前台登录商户，在官方公告处得到flag</p>
<p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203161959514.png" alt="image-20241203161959514"></p>
<hr>
<h1 id="客服系统-114-114-114-20"><a href="#客服系统-114-114-114-20" class="headerlink" title="客服系统-114.114.114.20"></a>客服系统-114.114.114.20</h1><p>从云支付右边的弹窗进客服系统</p>
<p>和蓝帽杯决赛一样的客服系统啊，莫非是蓝帽魅力时刻…布豪，客服不读我的xss！</p>
<p>欧内该，不读xss的话，瓦塔西！客服很不高兴为我服务😡</p>
<p>客服：<a target="_blank" rel="noopener" href="http://114.114.114.20:41451/welive.php?a=6168&group=1&url=aHR0cDovLzExNC4xMTQuMTE0LjIyOTo0NDUxNC8=">http://114.114.114.20:41451/welive.php?a=6168&amp;group=1&amp;url=aHR0cDovLzExNC4xMTQuMTE0LjIyOTo0NDUxNC8=</a></p>
<p>后台：<a target="_blank" rel="noopener" href="http://114.114.114.20:51451/">http://114.114.114.20:51451</a></p>
<h2 id="扫描-3"><a href="#扫描-3" class="headerlink" title="扫描"></a>扫描</h2><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203163642001.png" alt="image-20241203163642001"></p>
<hr>
<h1 id="254-端口扫描"><a href="#254-端口扫描" class="headerlink" title="254 端口扫描"></a>254 端口扫描</h1><pre class="line-numbers language-none"><code class="language-none">PORT      STATE SERVICE    VERSION
53&#x2F;tcp    open  tcpwrapped
80&#x2F;tcp    open  http       nginx
|_http-title: \xE6\xB2\xA1\xE6\x9C\x89\xE6\x89\xBE\xE5\x88\xB0\xE7\xAB\x99\xE7\x82\xB9
111&#x2F;tcp   open  rpcbind    2-4 (RPC #100000)
| rpcinfo: 
|   program version    port&#x2F;proto  service
|   100000  2,3,4        111&#x2F;tcp   rpcbind
|   100000  2,3,4        111&#x2F;udp   rpcbind
|   100000  3,4          111&#x2F;tcp6  rpcbind
|   100000  3,4          111&#x2F;udp6  rpcbind
|   100003  3,4         2049&#x2F;tcp   nfs
|   100003  3,4         2049&#x2F;tcp6  nfs
|   100005  1,2,3      32780&#x2F;tcp   mountd
|   100005  1,2,3      32780&#x2F;tcp6  mountd
|   100005  1,2,3      32780&#x2F;udp   mountd
|   100005  1,2,3      32780&#x2F;udp6  mountd
|   100021  1,3,4      32777&#x2F;tcp   nlockmgr
|   100021  1,3,4      32777&#x2F;tcp6  nlockmgr
|   100021  1,3,4      32777&#x2F;udp   nlockmgr
|   100021  1,3,4      32777&#x2F;udp6  nlockmgr
|   100024  1          32778&#x2F;tcp   status
|   100024  1          32778&#x2F;tcp6  status
|   100024  1          32778&#x2F;udp   status
|_  100024  1          32778&#x2F;udp6  status
2049&#x2F;tcp  open  nfs        3-4 (RPC #100003)
32777&#x2F;tcp open  nlockmgr   1-4 (RPC #100021)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>




    </div>
    
    
    
    
    
    
    
</div>

            </div>
        </transition>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/blog/js/main.js"></script>
    
    




    
    

<div id="vcomments"></div>

<script src="/blog/js/lib/valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        app_id: 'U9mZLKunkRUTcBFthjXPjnZE-9Nh9j0Va',
        app_key: 'SzWOnY0PWLGNuL6jW8TZYc7j',
        visitor: 'true',
        placeholder: '写点什么吧(●ˇ∀ˇ●)',
        serverURLs: 'https://u9mzlkun.lc-cn-n1-shared.com',
    });
</script>

    <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2025 雲流のLowest World
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;C1oudfL0w0
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

<script src="/blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/blog/live2dw/assets/z16.model.json"},"display":{"position":"left","width":150,"height":290},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>