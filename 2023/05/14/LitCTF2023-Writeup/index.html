
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <title>LitCTF2023 Writeup | 雲流のLowest World</title>
    <meta name="author" content="C1oudfL0w0" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <link rel="icon" href="/blog/images/croppedImage_cropped.jpg" />
    <!-- cdn挂掉的时候要可以引用本地 -->
<!-- <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script> -->
<script src="/blog/js/vue.global.prod.min.js"></script>


<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css" />


<link rel="stylesheet" href="/blog/css/all.min.css" />
<link rel="stylesheet" href="/blog/css/fonts.min.css" />
<link rel="stylesheet" href="/blog/css/search.css" />
<script> const mixins = {}; </script>

<!-- 引入jQuery-->
<!-- <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script> -->
<script src="/blog/js/jquery.min.js"></script>

<!--改成了prismjs高亮-->

<script src="/blog/js/lib/prism.js"></script>
<link rel="stylesheet" href="/blog/css/prism.css" rel="stylesheet" />



<script src="/blog/js/lib/preview.js"></script>










<script src="/blog/js/lib/home.js"></script>

<link rel="stylesheet" href="/blog/css/main.css" />
<!-- 引入不蒜子-->

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<!-- 引入clipboard -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeCopy.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/blog/atom.xml" title="雲流のLowest World" type="application/atom+xml">
</head>

<body>
    <!--flag{never_g0nna g1ve_you up}-->

    <!-- 页面点击特效 -->
    <script type="text/javascript" src="/blog/js/love-click.js"></script>

    <!-- 浏览器标题 -->
    <script async type="text/javascript" src="/blog/js/FunnyTitle.js"></script>

    <!-- 动态背景 -->
    

    <!--文章目录-->
    
    <div id="toc" class="toc-article">
    <h3><i class="fas fa-stream"></i>  目录</h3>
      <div class="toc-title"></div>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB"><span class="toc-number">2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E5%BC%B9%E8%BF%B7%E8%B8%AA"><span class="toc-number">2.1.</span> <span class="toc-text">导弹迷踪</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP%E6%98%AF%E4%B8%96%E7%95%8C%E4%B8%8A%E6%9C%80%E5%A5%BD%E7%9A%84%E8%AF%AD%E8%A8%80%EF%BC%81%EF%BC%81"><span class="toc-number">2.2.</span> <span class="toc-text">PHP是世界上最好的语言！！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1zjs"><span class="toc-number">2.3.</span> <span class="toc-text">1zjs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91Flag%E5%91%A2%EF%BC%9F"><span class="toc-number">2.4.</span> <span class="toc-text">我Flag呢？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ping"><span class="toc-number">2.5.</span> <span class="toc-text">Ping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Follow-me-and-hack-me"><span class="toc-number">2.6.</span> <span class="toc-text">Follow me and hack me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%9C%E4%B8%9A%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-number">2.7.</span> <span class="toc-text">作业管理系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vim-yyds"><span class="toc-number">2.8.</span> <span class="toc-text">Vim yyds</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Http-pro-max-plus"><span class="toc-number">2.9.</span> <span class="toc-text">Http pro max plus</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9FSQL-%EF%BC%81%E6%B3%A8%E4%B8%80%E4%B8%8B-%EF%BC%81"><span class="toc-number">2.10.</span> <span class="toc-text">这是什么？SQL ！注一下 ！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Flag%E7%82%B9%E5%87%BB%E5%B0%B1%E9%80%81%EF%BC%81"><span class="toc-number">2.11.</span> <span class="toc-text">Flag点击就送！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%B1%E5%BD%93%E6%97%A0%E4%BA%8B%E5%8F%91%E7%94%9F"><span class="toc-number">2.12.</span> <span class="toc-text">就当无事发生</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%A9%E8%9B%8B"><span class="toc-number">2.13.</span> <span class="toc-text">彩蛋</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-number">3.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%A3%E7%AE%97%E9%A2%98%E5%8D%A1"><span class="toc-number">3.1.</span> <span class="toc-text">口算题卡</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">4.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A2%A6%E6%83%B3%E6%98%AF%E7%BA%A2%E8%89%B2%E7%9A%84-%E5%88%9D%E7%BA%A7"><span class="toc-number">4.1.</span> <span class="toc-text">梦想是红色的 (初级)</span></a></li></ol></li></ol>
    </div>
  

    <!--返回顶部-->
    <div id="totop" style="position:fixed;bottom:50px;right:60px;font-size: 48px;cursor: pointer;z-index: 10;">
        <a title="返回顶部">↑</a>
    </div>
    <script src="/blog/js/totop.js"></script>

    <div id="layout">
        
            <div id="content-background" ref="contentBackground" data-images="https://pic.imgdb.cn/item/65d61d809f345e8d03b8bc7a.png"></div>
            
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>第一次加载文章图片可能会花费较长时间</p>
                    <p>要不挂个梯子试试？（x</p>
                    <p>加载过慢请开启缓存&ensp;浏览器默认开启</p>
                    <img src="/blog/images/loading.gif" />
                </div>
            </div>
        </transition>
        <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/blog/">
            <span>雲流のLOWEST WORLD</span>
        </a>
        
        <a href="/blog/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/blog/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/blog/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/blog/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/blog/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
        <a href="/blog/links">
            <i class="fa-solid fa-link fa-fw"></i>
            <span>&ensp;Links</span>
        </a>
        
        <a href="/blog/search">
            <i class="fa-solid fa-search fa-fw"></i>
            <span>&ensp;Search</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;雲流のLOWEST WORLD</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/blog/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/blog/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/blog/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/blog/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/blog/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
            <a href="/blog/links">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-link fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Links</div>
                </div>
            </a>
            
            <a href="/blog/search">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-search fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Search</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>LitCTF2023 Writeup</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/5/14
        </span>
        
        <span class="category">
            <a href="/blog/categories/CTF%E7%BA%BF%E4%B8%8A%E8%B5%9B/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                CTF线上赛
            </a>
        </span>
        
        
        <!--文章字数统计-->
        
            
<div style="margin-top:10px;">
    <span class="post-time">
      <span class="post-meta-item-icon">
        <i class="fa fa-keyboard-o"></i>
        <span class="post-meta-item-text">  字数统计: </span>
        <!-- 安装插件npm install hexo-wordcount --save -->
        <span class="post-count">1.9k字</span>
      </span>
    </span>

    <span class="post-time">
      &nbsp; | &nbsp;
      <span class="post-meta-item-icon">
        <i class="fa fa-hourglass-half"></i>
        <span class="post-meta-item-text">  阅读时长: </span>
        <span class="post-count">7分</span>
      </span>
    </span>
    
    <!--不蒜子统计访问数-->
    <span id="busuanzi_container_page_pv">
    &nbsp; | &nbsp;
    总文章阅读量：<span id="busuanzi_value_page_pv"></span>次
    </span>
</div>

          
    </div>
    
    <div class="content" v-pre>
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><del>探姬杯好耶</del></p>
<p>评价：</p>
<p><del>年轻人的第一次ak</del>，就web而言大多数题目很简单而且考点还是挺明显的，同时也能学到一点新的知识，对新生还是非常友好的，</p>
<p>mc服务器挺好玩的，</p>
<p>尝试用GPT4做KOH（x</p>
<p><del>让我狠狠的社探姬</del></p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/1684412143599.jpg" alt="image"></p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518201803887.png" alt="image-20230518201803887"></p>
<span id="more"></span>

<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="导弹迷踪"><a href="#导弹迷踪" class="headerlink" title="导弹迷踪"></a>导弹迷踪</h2><blockquote>
<p>js</p>
</blockquote>
<p>进去直接翻js文件，在game.js下找到flag</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518202914966.png" alt="image-20230518202914966"></p>
<hr>
<h2 id="PHP是世界上最好的语言！！"><a href="#PHP是世界上最好的语言！！" class="headerlink" title="PHP是世界上最好的语言！！"></a>PHP是世界上最好的语言！！</h2><blockquote>
<p>基本PHP命令执行</p>
</blockquote>
<p>进入后发现右边有个能跑代码的框，直接<code>system(&#39;ls&#39;)</code>尝试回显目录</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518203218304.png" alt="image-20230518203218304"></p>
<p>成功回显，<code>system(&#39;ls /&#39;)</code>查看根目录</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518203415080.png" alt="image-20230518203415080"></p>
<p>那接下来就直接<code>cat /flag</code>获取flag即可</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518203528515.png" alt="image-20230518203528515"></p>
<hr>
<h2 id="1zjs"><a href="#1zjs" class="headerlink" title="1zjs"></a>1zjs</h2><blockquote>
<p>jsfuck</p>
</blockquote>
<p>打开又是一个游戏页面，查看js</p>
<p>先看看(index)</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518203735795.png" alt="image-20230518203735795"></p>
<p>游戏的js脚本指向<code>./dist/index.umd.js</code>，那就顺着去找看看</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518203857046.png" alt="image-20230518203857046"></p>
<p>在开头的注释处发现提示，访问<code>/f@k3f1ag.php</code></p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518203955492.png" alt="image-20230518203955492"></p>
<p>发现jsfuck，复制到控制台跑一下得到flag</p>
<hr>
<h2 id="我Flag呢？"><a href="#我Flag呢？" class="headerlink" title="我Flag呢？"></a>我Flag呢？</h2><blockquote>
<p>f12查看html注释</p>
</blockquote>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518204147442.png" alt="image-20230518204147442"></p>
<p>发现flag</p>
<hr>
<h2 id="Ping"><a href="#Ping" class="headerlink" title="Ping"></a>Ping</h2><blockquote>
<p>ping</p>
</blockquote>
<blockquote>
<p>前端绕过</p>
</blockquote>
<p>进去发现一个ping的命令框，尝试直接<code>127.0.0.1;ls;</code>查看目录</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518204626388.png" alt="image-20230518204626388"></p>
<p>发现被拦下来了，因为弹出的是一个窗口，猜测是前端过滤，使用burpsuite抓包发到重放器中</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518205347255.png" alt="image-20230518205347255"></p>
<p>发现js脚本的前端过滤和文本输入框传入的参数<code>command</code>与方式<code>POST</code></p>
<p>这里用发包的方式进行命令执行（也可以直接禁用js在页面进行命令执行）</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518205629818.png" alt="image-20230518205629818"></p>
<p>成功回显目录</p>
<p>查看根目录发现flag</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518205723747.png" alt="image-20230518205723747"></p>
<p>直接<code>cat /flag</code>即可</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518205808974.png" alt="image-20230518205808974"></p>
<hr>
<h2 id="Follow-me-and-hack-me"><a href="#Follow-me-and-hack-me" class="headerlink" title="Follow me and hack me"></a>Follow me and hack me</h2><blockquote>
<p>get与post请求</p>
</blockquote>
<p>进去按要求传参即可获得flag</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518210009479.png" alt="image-20230518210009479"></p>
<hr>
<h2 id="作业管理系统"><a href="#作业管理系统" class="headerlink" title="作业管理系统"></a>作业管理系统</h2><blockquote>
<p>文件上传</p>
</blockquote>
<p>进入题目f12发现提示</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519113559467.png" alt="image-20230519113559467"></p>
<p>登录进去后发现一个文件上传页面</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519113711571.png" alt="image-20230519113711571"></p>
<p>直接传图片马进去试试</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519113942549.png" alt="image-20230519113942549"></p>
<p>上传成功</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519114009201.png" alt="image-20230519114009201"></p>
<p>访问并执行命令找到flag</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519114111244.png" alt="image-20230519114111244"></p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519114141642.png" alt="image-20230519114141642"></p>
<hr>
<h2 id="Vim-yyds"><a href="#Vim-yyds" class="headerlink" title="Vim yyds"></a>Vim yyds</h2><blockquote>
<p>信息泄露</p>
</blockquote>
<p>题目提示“漏…漏了！”很明显是信息泄露</p>
<p>直接<code>dirsearch</code>开扫</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519114633310.png" alt="image-20230519114633310"></p>
<p>发现在<code>/.index.php.swp</code>处存在泄露</p>
<p>访问可以下载其文件</p>
<p>用记事本打开发现有逆序的php代码</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519115027431.png" alt="image-20230519115027431"></p>
<p>正序的php代码如下</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Give_Me_Your_Flag"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p>can can need Vim &lt;/p>"</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p>Oh You got my password!&lt;/p>"</span><span class="token punctuation">;</span>  
	<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>逻辑很清晰，post传入<code>password</code>，如果<code>password</code>等于base64编码<code>Give_Me_Your_Flag</code>就能在post传入的<code>cmd</code>处执行命令</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519115938717.png" alt="image-20230519115938717"></p>
<p>cat &#x2F;flag即可</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519120216432.png" alt="image-20230519120216432"></p>
<hr>
<h2 id="Http-pro-max-plus"><a href="#Http-pro-max-plus" class="headerlink" title="Http pro max plus"></a>Http pro max plus</h2><blockquote>
<p>http请求头</p>
</blockquote>
<p>进入题目</p>
<p>发现要求我们用本地访问</p>
<p>尝试直接<code>X-Forwarded-For:127.0.0.1</code></p>
<p>执行 发现xff头被过滤了</p>
<p>换个请求头<code>Client-ip:127.0.0.1</code>即可</p>
<p>执行显示 You are not from pornhub.com !</p>
<p>请求头加上<code>Referer:pornhub.com</code></p>
<p>执行显示 用Chrome浏览器啊</p>
<p>把UA头改成<code>user-agent: Chrome</code></p>
<p>执行显示 不开代理你想上p站？代理服务器地址是Clash.win</p>
<p>那请求头加上<code>via:Clash.win </code></p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230521214343329.png" alt="image-20230521214343329"></p>
<p>那么就看到下一步了</p>
<p>访问<code>/wtfwtfwtfwtf.php</code></p>
<p>f12找到下一步(前面两个按钮…<del>不是你来真的啊</del>)</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230521214441635.png" alt="image-20230521214441635"></p>
<p>访问<code>/sejishikong.php</code>得到flag</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230521214607323.png" alt="image-20230521214607323"></p>
<hr>
<h2 id="这是什么？SQL-！注一下-！"><a href="#这是什么？SQL-！注一下-！" class="headerlink" title="这是什么？SQL ！注一下 ！"></a>这是什么？SQL ！注一下 ！</h2><blockquote>
<p>sql注入</p>
</blockquote>
<p>一个sql注入框，下面也给出了查询语句</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230523175738335.png" alt="image-20230523175738335"></p>
<p>很明显就是输入6个<code>)</code>闭合然后执行自己的语句</p>
<p>第一步：查库</p>
<p>比赛的时候问题出在这里，因为本人注入的语句只能查当前库，结果翻了半天字段也没找到flag，最后还得多亏队友（</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> schema_name<span class="token punctuation">,</span><span class="token number">2</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span>schemata<span class="token operator">%</span><span class="token number">23</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>查询所有库的名字</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230523180320374.png" alt="image-20230523180320374"></p>
<p>查ctf库（这里直接搬已有的payload）</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">%</span><span class="token number">23</span>
Array <span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> Array <span class="token punctuation">(</span> <span class="token punctuation">[</span>username<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> ctf <span class="token punctuation">[</span>password<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">2</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>


?id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token string">'ctf'</span><span class="token operator">%</span><span class="token number">23</span>
<span class="token comment">//users</span>


?id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_name<span class="token operator">=</span><span class="token string">'users'</span> <span class="token operator">and</span> table_schema<span class="token operator">=</span><span class="token string">'ctf'</span><span class="token operator">%</span><span class="token number">23</span>
<span class="token comment">// id,username,password</span>


?id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span>username<span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span> <span class="token keyword">from</span> users<span class="token operator">%</span><span class="token number">23</span>
<span class="token comment">//1~tanji~OHHHHHHH,2~fake_flag~F1rst_to_Th3_eggggggggg!&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><del>查一圈会发现根本找不到flag</del></p>
<p>那我们就查下ctftraining库中的表</p>
<p>对指定数据库查询的格式：<code>库名.表名</code></p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token string">'ctftraining'</span><span class="token operator">%</span><span class="token number">23</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>返回<code>Array ( [0] =&gt; Array ( [username] =&gt; 1 [password] =&gt; flag,news,users ) )          </code>   </p>
<p>查列</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_name<span class="token operator">=</span><span class="token string">'flag'</span> <span class="token operator">and</span> table_schema<span class="token operator">=</span><span class="token string">'ctftraining'</span><span class="token operator">%</span><span class="token number">23</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>返回<code>Array ( [0] =&gt; Array ( [username] =&gt; 1 [password] =&gt; flag ) )            </code></p>
<p>查字段(不能使用table_schema，因为是内置库的字段)</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">?id<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token number">1</span><span class="token punctuation">,</span>flag <span class="token keyword">from</span> ctftraining<span class="token punctuation">.</span>flag<span class="token operator">%</span><span class="token number">23</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>获取flag</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230523182221777.png" alt="image-20230523182221777"></p>
<hr>
<h2 id="Flag点击就送！"><a href="#Flag点击就送！" class="headerlink" title="Flag点击就送！"></a>Flag点击就送！</h2><blockquote>
<p>session伪造</p>
</blockquote>
<p>进入题目，要求我们告诉名字，一开始猜测是ssti，<code>&#123;&#123;7*7&#125;&#125;</code>试一下</p>
<p>进入&#x2F;hello路由</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230524145749442.png" alt="image-20230524145749442"></p>
<p>发现没渲染，那应该不是ssti</p>
<p>点一下按钮</p>
<p>进入&#x2F;flag路由，回显 “只有管理员才能拿flag耶”</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230524145815716.png" alt="image-20230524145815716"></p>
<p>那就回到输入名字的页面，输入admin</p>
<p>回车进入&#x2F;hello路由，回显“你怎么可能是管理员哦！”</p>
<p>比赛的时候到这里题目就卡住了，但是可以确定flag应该是在&#x2F;flag路由下获取的</p>
<p>于是回到&#x2F;flag路由下寻找信息，在响应头发现<code>Vary:Cookie</code>，请求头发现session</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230524150306617.png" alt="image-20230524150306617"></p>
<p>猜测是要修改session的值来匹配cookie</p>
<p>那就可以确定这题的题型是<a href="https://c1oudfl0w0.github.io/blog/2023/05/14/session%E4%BC%AA%E9%80%A0/">session伪造</a></p>
<p>在终端使用session解密的脚本（我这里前面传入的name是1），但是接下来最大的问题就是猜测密钥，最后还得靠队友猜出来密钥是LitCTF</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python flask_session_cookie_manager3.py decode <span class="token parameter variable">-s</span> LitCTF <span class="token parameter variable">-c</span> eyJuYW1lIjoiMSJ9.ZG219Q.5vpdfyPWA5_My6yGze7cNds2wfE<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>运行得到<code>&#123;&#39;name&#39;: &#39;1&#39;&#125;</code></p>
<p>接下来要做的就是使session解密后的值修改为<code>&#123;&#39;name&#39;: &#39;admin&#39;&#125;</code>，同样在终端使用脚本进行加密</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python flask_session_cookie_manager3.py encode <span class="token parameter variable">-s</span> LitCTF <span class="token parameter variable">-t</span> <span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token builtin class-name">:</span><span class="token string">'admin'</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>运行得到<code>eyJuYW1lIjoiYWRtaW4ifQ.ZG25fw.C4PC6BrXrAe2n3umTbs1qZSXtXE</code></p>
<p>然后带着这串session在&#x2F;flag路由下传入获取flag</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230524151901072.png" alt="image-20230524151901072"></p>
<hr>
<h2 id="就当无事发生"><a href="#就当无事发生" class="headerlink" title="就当无事发生"></a>就当无事发生</h2><blockquote>
<p>github小知识</p>
</blockquote>
<p>题目是探姬的博客链接</p>
<p>进去之后并不能找到什么有用的信息</p>
<p>回来看题目</p>
<blockquote>
<p>差点数据没脱敏就发出去了，还好还没来得及部署，重新再pull一次（x</p>
</blockquote>
<p>因为github每次pull都会留下修改记录</p>
<p>所以这边直接来到探姬的GitHub博客仓库下</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230522172945909.png" alt="image-20230522172945909"> </p>
<p>点开commit次数旁边的修改记录可以找到flag</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230522173015899.png" alt="image-20230522173015899"></p>
<hr>
<h2 id="彩蛋"><a href="#彩蛋" class="headerlink" title="彩蛋"></a>彩蛋</h2><p>第一个彩蛋在控制台发现，执行题目提示的函数，得到第一段flag</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518204319016.png" alt="image-20230518204319016"></p>
<p>第二个彩蛋在作业管理系统中的远程下载处的那个链接中</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230519113820944.png" alt="image-20230519113820944"></p>
<p>第三个彩蛋在备份文件<code>www.zip</code>下，下载下来，将<code>index.php.bak</code>改成<code>index.php</code>，打开发现第三段flag</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230518210201148.png" alt="image-20230518210201148"></p>
<p>第四个彩蛋查看id&#x3D;2时发现</p>
<p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20230523175600569.png" alt="image-20230523175600569"></p>
<p>拼接四段flag即可(记得改成NSSCTF开头)</p>
<p><code>LitCTF&#123;First_t0_The_k3y!_S0_ne3t?_R3ady_Pl4yer_000ne_F1rst_to_Th3_eggggggggg!&#125;</code></p>
<hr>
<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="口算题卡"><a href="#口算题卡" class="headerlink" title="口算题卡"></a>口算题卡</h2><p><img src="/blog/2023/05/14/LitCTF2023-Writeup/image-20231003231759146.png" alt="image-20231003231759146"></p>
<p>纯计算</p>
<p>pwntools自动计算</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"node4.anna.nssctf.cn"</span><span class="token punctuation">,</span> <span class="token number">28355</span><span class="token punctuation">)</span>
context<span class="token punctuation">(</span>os<span class="token operator">=</span><span class="token string">"linux"</span><span class="token punctuation">,</span> arch<span class="token operator">=</span><span class="token string">"i386"</span><span class="token punctuation">,</span> log_level<span class="token operator">=</span><span class="token string">"debug"</span><span class="token punctuation">)</span>
recv_header <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Have fun!\n"</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"What is"</span><span class="token punctuation">)</span>
    
    key <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"?"</span><span class="token punctuation">)</span>
    payload <span class="token operator">=</span> flat<span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">eval</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="梦想是红色的-初级"><a href="#梦想是红色的-初级" class="headerlink" title="梦想是红色的 (初级)"></a>梦想是红色的 (初级)</h2><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">自由友善公正公正敬业法治自由自由和谐平等自由自由公正法治诚信民主诚信自由自由诚信民主爱国友善平等诚信富强友善爱国自由诚信民主敬业爱国诚信民主友善爱国平等爱国爱国敬业敬业友善爱国公正敬业爱国敬业和谐文明诚信文明友善爱国自由诚信民主爱国爱国诚信和谐友善爱国自由友善平等爱国友善平等友善自由诚信自由平等爱国爱国敬业敬业友善爱国敬业敬业友善自由友善平等诚信自由法治诚信和谐<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>核心价值观编解码：<a target="_blank" rel="noopener" href="http://www.hiencode.com/cvencode.html">http://www.hiencode.com/cvencode.html</a></p>

    </div>
    
    
    
    
    
    
    
</div>

            </div>
        </transition>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/blog/js/main.js"></script>
    
    




    
    

<div id="vcomments"></div>

<script src="/blog/js/lib/valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        app_id: 'U9mZLKunkRUTcBFthjXPjnZE-9Nh9j0Va',
        app_key: 'SzWOnY0PWLGNuL6jW8TZYc7j',
        visitor: 'true',
        placeholder: '写点什么吧(●ˇ∀ˇ●)',
        serverURLs: 'https://u9mzlkun.lc-cn-n1-shared.com',
    });
</script>

    <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2025 雲流のLowest World
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;C1oudfL0w0
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

<script src="/blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/blog/live2dw/assets/z16.model.json"},"display":{"position":"left","width":150,"height":290},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>