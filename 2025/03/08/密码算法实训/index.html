
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <title>密码算法实训 | 雲流のLowest World</title>
    <meta name="author" content="C1oudfL0w0" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <link rel="icon" href="/blog/images/croppedImage_cropped.jpg" />
    <!-- cdn挂掉的时候要可以引用本地 -->
<!-- <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script> -->
<script src="/blog/js/vue.global.prod.min.js"></script>


<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css" />


<link rel="stylesheet" href="/blog/css/all.min.css" />
<link rel="stylesheet" href="/blog/css/fonts.min.css" />
<link rel="stylesheet" href="/blog/css/search.css" />
<script> const mixins = {}; </script>

<!-- 引入jQuery-->
<!-- <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script> -->
<script src="/blog/js/jquery.min.js"></script>

<!--改成了prismjs高亮-->

<script src="/blog/js/lib/prism.js"></script>
<link rel="stylesheet" href="/blog/css/prism.css" rel="stylesheet" />



<script src="/blog/js/lib/preview.js"></script>










<script src="/blog/js/lib/home.js"></script>

<link rel="stylesheet" href="/blog/css/main.css" />
<!-- 引入不蒜子-->

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<!-- 引入clipboard -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeCopy.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/blog/atom.xml" title="雲流のLowest World" type="application/atom+xml">
</head>

<body>
    <!--flag{never_g0nna g1ve_you up}-->

    <!-- 页面点击特效 -->
    <script type="text/javascript" src="/blog/js/love-click.js"></script>

    <!-- 浏览器标题 -->
    <script async type="text/javascript" src="/blog/js/FunnyTitle.js"></script>

    <!-- 动态背景 -->
    

    <!--文章目录-->
    
    <div id="toc" class="toc-article">
    <h3><i class="fas fa-stream"></i>  目录</h3>
      <div class="toc-title"></div>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">古典密码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A7%BB%E4%BD%8D%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.</span> <span class="toc-text">移位密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E7%BD%AE%E6%8D%A2%E5%AF%86%E7%A0%81"><span class="toc-number">2.2.</span> <span class="toc-text">单表置换密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A9%B7%E4%B8%BE%E6%B3%95%E6%94%BB%E5%87%BB%E7%A7%BB%E4%BD%8D%E5%AF%86%E7%A0%81"><span class="toc-number">2.3.</span> <span class="toc-text">穷举法攻击移位密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90%E6%94%BB%E5%87%BB%E7%BD%AE%E6%8D%A2%E5%AF%86%E7%A0%81"><span class="toc-number">2.4.</span> <span class="toc-text">词频分析攻击置换密码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80"><span class="toc-number">3.</span> <span class="toc-text">密码学数学基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95"><span class="toc-number">3.1.</span> <span class="toc-text">欧几里得算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95"><span class="toc-number">3.2.</span> <span class="toc-text">扩展欧几里得算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%89%E9%99%90%E5%9F%9F"><span class="toc-number">3.3.</span> <span class="toc-text">有限域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="toc-number">3.4.</span> <span class="toc-text">中国剩余定理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A0%E6%80%A7%E6%A3%80%E9%AA%8C"><span class="toc-number">3.5.</span> <span class="toc-text">素性检验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%88%B1%E6%8B%89%E6%89%98%E6%96%AF%E6%95%A3%E7%AD%9B%E6%B3%95"><span class="toc-number">3.6.</span> <span class="toc-text">爱拉托斯散筛法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">分组密码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#DES"><span class="toc-number">4.1.</span> <span class="toc-text">DES</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%AA%E5%B4%A9%E6%95%88%E5%BA%94%E6%A3%80%E9%AA%8C"><span class="toc-number">4.1.1.</span> <span class="toc-text">雪崩效应检验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8A%A0%E8%A7%A3%E5%AF%86"><span class="toc-number">4.1.2.</span> <span class="toc-text">文件加解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">4.1.3.</span> <span class="toc-text">性能分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AES"><span class="toc-number">4.2.</span> <span class="toc-text">AES</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8A%A0%E8%A7%A3%E5%AF%86-1"><span class="toc-number">4.2.1.</span> <span class="toc-text">文件加解密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90-1"><span class="toc-number">4.2.2.</span> <span class="toc-text">性能分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81"><span class="toc-number">5.</span> <span class="toc-text">公钥密码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA"><span class="toc-number">5.1.</span> <span class="toc-text">RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%A4%A7%E7%B4%A0%E6%95%B0"><span class="toc-number">5.1.1.</span> <span class="toc-text">生成大素数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">5.1.2.</span> <span class="toc-text">算法实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hash%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text">Hash函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenSSL"><span class="toc-number">6.1.</span> <span class="toc-text">OpenSSL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MD5"><span class="toc-number">6.2.</span> <span class="toc-text">MD5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%AA%E5%B4%A9%E6%95%88%E5%BA%94%E5%88%86%E6%9E%90"><span class="toc-number">6.2.1.</span> <span class="toc-text">雪崩效应分析</span></a></li></ol></li></ol></li></ol>
    </div>
  

    <!--返回顶部-->
    <div id="totop" style="position:fixed;bottom:50px;right:60px;font-size: 48px;cursor: pointer;z-index: 10;">
        <a title="返回顶部">↑</a>
    </div>
    <script src="/blog/js/totop.js"></script>

    <div id="layout">
        
            <div id="content-background" ref="contentBackground" data-images="https://pic.imgdb.cn/item/65d61d809f345e8d03b8bc7a.png"></div>
            
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>第一次加载文章图片可能会花费较长时间</p>
                    <p>要不挂个梯子试试？（x</p>
                    <p>加载过慢请开启缓存&ensp;浏览器默认开启</p>
                    <img src="/blog/images/loading.gif" />
                </div>
            </div>
        </transition>
        <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/blog/">
            <span>雲流のLOWEST WORLD</span>
        </a>
        
        <a href="/blog/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/blog/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/blog/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/blog/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/blog/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
        <a href="/blog/links">
            <i class="fa-solid fa-link fa-fw"></i>
            <span>&ensp;Links</span>
        </a>
        
        <a href="/blog/search">
            <i class="fa-solid fa-search fa-fw"></i>
            <span>&ensp;Search</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;雲流のLOWEST WORLD</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/blog/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/blog/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/blog/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/blog/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/blog/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
            <a href="/blog/links">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-link fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Links</div>
                </div>
            </a>
            
            <a href="/blog/search">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-search fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Search</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>密码算法实训</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2025/3/8
        </span>
        
        <span class="category">
            <a href="/blog/categories/Crypto/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                Crypto
            </a>
        </span>
        
        
        <!--文章字数统计-->
        
            
<div style="margin-top:10px;">
    <span class="post-time">
      <span class="post-meta-item-icon">
        <i class="fa fa-keyboard-o"></i>
        <span class="post-meta-item-text">  字数统计: </span>
        <!-- 安装插件npm install hexo-wordcount --save -->
        <span class="post-count">11.1k字</span>
      </span>
    </span>

    <span class="post-time">
      &nbsp; | &nbsp;
      <span class="post-meta-item-icon">
        <i class="fa fa-hourglass-half"></i>
        <span class="post-meta-item-text">  阅读时长: </span>
        <span class="post-count">59分</span>
      </span>
    </span>
    
    <!--不蒜子统计访问数-->
    <span id="busuanzi_container_page_pv">
    &nbsp; | &nbsp;
    总文章阅读量：<span id="busuanzi_value_page_pv"></span>次
    </span>
</div>

          
    </div>
    
    <div class="content" v-pre>
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学学密码算法</p>
<span id="more"></span>

<hr>
<h1 id="古典密码"><a href="#古典密码" class="headerlink" title="古典密码"></a>古典密码</h1><h2 id="移位密码"><a href="#移位密码" class="headerlink" title="移位密码"></a>移位密码</h2><blockquote>
<p>将英文字母向前或向后移动一个固定位置。例如向后移动3个位置，即对字母表作置换（不分大小写）。</p>
</blockquote>
<p>此时的数学函数：a &#x3D; (a+3) mod 26</p>
<p>初步思路：</p>
<p>遍历明文的每个字符，逐个字符取 ascii 码与起始字符的 ascii 码相减即为起始序号，加密后的字符 ascii 即 (起始序号+偏移量) mod 26 + 起始字符的 ascii</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">cipher <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">for</span> c <span class="token keyword">in</span> plaintext<span class="token punctuation">:</span>
    ser_num <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span>
    ser_num <span class="token operator">=</span> <span class="token punctuation">(</span>ser_num <span class="token operator">+</span> shift<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span>
    cipher_char <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ser_num <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cipher <span class="token operator">+=</span> cipher_char<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>接下来考虑明文存在大小写字母的情况，采用三目运算符进行判断</p>
<p>那么加密部分：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> shift<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> plaintext<span class="token punctuation">:</span>
        ser_num <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        ser_num <span class="token operator">=</span> <span class="token punctuation">(</span>ser_num <span class="token operator">+</span> shift<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span>
        cipher_char <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ser_num <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ser_num <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        cipher <span class="token operator">+=</span> cipher_char
    <span class="token keyword">return</span> cipher<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>解密部分只需要用同样的方式减去偏移量：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">dec</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span>shift<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plain <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> ciphertext<span class="token punctuation">:</span>
        ser_num <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        ser_num <span class="token operator">=</span> <span class="token punctuation">(</span>ser_num <span class="token operator">-</span> shift<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span>
        plain_char <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ser_num <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ser_num <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        plain <span class="token operator">+=</span> plain_char
    <span class="token keyword">return</span> plain<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>最终的代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">Text <span class="token operator">=</span> <span class="token string">"FlagisHere"</span>


<span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> shift<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> plaintext<span class="token punctuation">:</span>
        ser_num <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        ser_num <span class="token operator">=</span> <span class="token punctuation">(</span>ser_num <span class="token operator">+</span> shift<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span>
        cipher_char <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ser_num <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ser_num <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        cipher <span class="token operator">+=</span> cipher_char
    <span class="token keyword">return</span> cipher

<span class="token keyword">def</span> <span class="token function">dec</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span>shift<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plain <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> ciphertext<span class="token punctuation">:</span>
        ser_num <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
        ser_num <span class="token operator">=</span> <span class="token punctuation">(</span>ser_num <span class="token operator">-</span> shift<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span>
        plain_char <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ser_num <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>ser_num <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        plain <span class="token operator">+=</span> plain_char
    <span class="token keyword">return</span> plain

<span class="token keyword">print</span><span class="token punctuation">(</span>enc<span class="token punctuation">(</span>Text<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dec<span class="token punctuation">(</span>enc<span class="token punctuation">(</span>Text<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/2025/03/08/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250309183614959.png" alt="image-20250309183614959"></p>
<hr>
<h2 id="单表置换密码"><a href="#单表置换密码" class="headerlink" title="单表置换密码"></a>单表置换密码</h2><blockquote>
<p>单表置换密码就是根据字母表的置换对明文进行变换的方法</p>
</blockquote>
<p>给定置换</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">A  B  C  D  E  F  G  H  I  J  K  L  M  N  O  P  Q  R  S  T  U  V  W  X  Y  Z
H  K  W  T  X  Y  S  G  B  P  Q  E  J  A  Z  M  L  N  O  F  C  I  D  V  U  R<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>使用字典存储置换表，这里先用 zip 转成元组再遍历到字典中：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">original <span class="token operator">=</span> <span class="token string">"A B C D E F G H I J K L M N O P Q R S T U V W X Y Z"</span>
substitute <span class="token operator">=</span> <span class="token string">"H K W T X Y S G B P Q E J A Z M L N O F C I D V U R"</span>

substitution_table <span class="token operator">=</span> <span class="token punctuation">&#123;</span>o<span class="token punctuation">:</span> s <span class="token keyword">for</span> o<span class="token punctuation">,</span> s <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>original<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> substitute<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>然后设计加密过程：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher<span class="token operator">=</span><span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> plaintext<span class="token punctuation">:</span>
        <span class="token keyword">if</span> c <span class="token keyword">in</span> substitute<span class="token punctuation">:</span>
            cipher <span class="token operator">+=</span> substitution_table<span class="token punctuation">[</span>c<span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            cipher <span class="token operator">+=</span> c
    <span class="token keyword">return</span> cipher<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>解密需要创建一个反向置换表：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">rev_substitution_table <span class="token operator">=</span> <span class="token punctuation">&#123;</span>o<span class="token punctuation">:</span> s <span class="token keyword">for</span> o<span class="token punctuation">,</span> s <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>original<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> substitute<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>同样的解密过程：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">dec</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plain<span class="token operator">=</span><span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> ciphertext<span class="token punctuation">:</span>
        <span class="token keyword">if</span> c <span class="token keyword">in</span> rev_substitution_table<span class="token punctuation">:</span>
            plain <span class="token operator">+=</span> rev_substitution_table<span class="token punctuation">[</span>c<span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            plain <span class="token operator">+=</span> c
    <span class="token keyword">return</span> plain<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>最终的代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">Text <span class="token operator">=</span> <span class="token string">"IOJEDWNFGVEDIOUJWFN"</span>

original <span class="token operator">=</span> <span class="token string">"A B C D E F G H I J K L M N O P Q R S T U V W X Y Z"</span>
substitute <span class="token operator">=</span> <span class="token string">"H K W T X Y S G B P Q E J A Z M L N O F C I D V U R"</span>

substitution_table <span class="token operator">=</span> <span class="token punctuation">&#123;</span>o<span class="token punctuation">:</span> s <span class="token keyword">for</span> o<span class="token punctuation">,</span> s <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>original<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> substitute<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>

<span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher<span class="token operator">=</span><span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> plaintext<span class="token punctuation">:</span>
        <span class="token keyword">if</span> c <span class="token keyword">in</span> substitute<span class="token punctuation">:</span>
            cipher <span class="token operator">+=</span> substitution_table<span class="token punctuation">[</span>c<span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            cipher <span class="token operator">+=</span> c
    <span class="token keyword">return</span> cipher

rev_substitution_table <span class="token operator">=</span> <span class="token punctuation">&#123;</span>v <span class="token punctuation">:</span> k <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> substitution_table<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span>

<span class="token keyword">def</span> <span class="token function">dec</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plain<span class="token operator">=</span><span class="token string">""</span>
    <span class="token keyword">for</span> c <span class="token keyword">in</span> ciphertext<span class="token punctuation">:</span>
        <span class="token keyword">if</span> c <span class="token keyword">in</span> rev_substitution_table<span class="token punctuation">:</span>
            plain <span class="token operator">+=</span> rev_substitution_table<span class="token punctuation">[</span>c<span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            plain <span class="token operator">+=</span> c
    <span class="token keyword">return</span> plain

<span class="token keyword">print</span><span class="token punctuation">(</span>enc<span class="token punctuation">(</span>Text<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>dec<span class="token punctuation">(</span>enc<span class="token punctuation">(</span>Text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/2025/03/08/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250309183552872.png" alt="image-20250309183552872"></p>
<hr>
<h2 id="穷举法攻击移位密码"><a href="#穷举法攻击移位密码" class="headerlink" title="穷举法攻击移位密码"></a>穷举法攻击移位密码</h2><blockquote>
<p>有效密钥空间只有25，穷举密钥即可实现</p>
</blockquote>
<p>实际上就是爆破偏移量，解密方法不变</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Shift_Cipher <span class="token keyword">import</span> <span class="token operator">*</span>

cipher <span class="token operator">=</span> <span class="token string">"MshnpzOlyl"</span>


<span class="token keyword">def</span> <span class="token function">brute_force</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    text <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> shift <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        text <span class="token operator">=</span> dec<span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> shift<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> shift<span class="token punctuation">)</span>


brute_force<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/2025/03/08/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250309174730193.png" alt="image-20250309174730193"></p>
<p>如图，明文为 FlagisHere，密钥（偏移量）为 7</p>
<hr>
<h2 id="词频分析攻击置换密码"><a href="#词频分析攻击置换密码" class="headerlink" title="词频分析攻击置换密码"></a>词频分析攻击置换密码</h2><blockquote>
<p>统计密文的词频特征对照自然语言进行试译</p>
</blockquote>
<p>使用 collections 库进行词频分析：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> collections <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> re

text <span class="token operator">=</span> <span class="token string">"SIC GCBSPNA XPMHACQ JB GPYXSMEPNXIY JR SINS MF SPNBRQJSSJBE JBFMPQNSJMB FPMQ N XMJBS N SM N XMJBS H HY QCNBR MF N XMRRJHAY JBRCGZPC GINBBCA JB RZGI N VNY SINS SIC MPJEJBNA QCRRNEC GNB MBAY HC PCGMTCPCD HY SIC PJEISFZA PCGJXJCBSR SIC XNPSJGJXNBSR JB SIC SPNBRNGSJMB NPC NAJGC SIC MPJEJBNSMP MF SIC QCRRNEC HMH SIC PCGCJTCP NBD MRGNP N XMRRJHAC MXXMBCBS VIM VJRICR SM ENJB ZBNZSIMPJOCD GMBSPMA MF SIC QCRRNEC"</span>


<span class="token keyword">def</span> <span class="token function">word_frequency</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    words <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'\b\w+\b'</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span>
    frequency <span class="token operator">=</span> Counter<span class="token punctuation">(</span>words<span class="token punctuation">)</span>
    <span class="token keyword">return</span> frequency


frequency <span class="token operator">=</span> word_frequency<span class="token punctuation">(</span>text<span class="token punctuation">)</span>
<span class="token keyword">for</span> word<span class="token punctuation">,</span> count <span class="token keyword">in</span> frequency<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>word<span class="token punctuation">&#125;</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>count<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/2025/03/08/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250309180244062.png" alt="image-20250309180244062"></p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">SIC: 9
GCBSPNA: 1
XPMHACQ: 1
JB: 3
GPYXSMEPNXIY: 1
JR: 1
SINS: 2
MF: 4
SPNBRQJSSJBE: 1
JBFMPQNSJMB: 1
FPMQ: 1
N: 6
XMJBS: 2
SM: 2
H: 1
HY: 2
QCNBR: 1
XMRRJHAY: 1
JBRCGZPC: 1
GINBBCA: 1
RZGI: 1
VNY: 1
MPJEJBNA: 1
QCRRNEC: 3
GNB: 1
MBAY: 1
HC: 1
PCGMTCPCD: 1
PJEISFZA: 1
PCGJXJCBSR: 1
XNPSJGJXNBSR: 1
SPNBRNGSJMB: 1
NPC: 1
NAJGC: 1
MPJEJBNSMP: 1
HMH: 1
PCGCJTCP: 1
NBD: 1
MRGNP: 1
XMRRJHAC: 1
MXXMBCBS: 1
VIM: 1
VJRICR: 1
ENJB: 1
ZBNZSIMPJOCD: 1
GMBSPMA: 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>猜测 SIC 对应 THE，N 对应 A</p>
<p>然后进行替换，这里把替换的字符换成小写</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> EN_Words_Frequency <span class="token keyword">import</span> <span class="token operator">*</span>

text <span class="token operator">=</span> <span class="token string">"SIC GCBSPNA XPMHACQ JB GPYXSMEPNXIY JR SINS MF SPNBRQJSSJBE JBFMPQNSJMB FPMQ N XMJBS N SM N XMJBS H HY QCNBR MF N XMRRJHAY JBRCGZPC GINBBCA JB RZGI N VNY SINS SIC MPJEJBNA QCRRNEC GNB MBAY HC PCGMTCPCD HY SIC PJEISFZA PCGJXJCBSR SIC XNPSJGJXNBSR JB SIC SPNBRNGSJMB NPC NAJGC SIC MPJEJBNSMP MF SIC QCRRNEC HMH SIC PCGCJTCP NBD MRGNP N XMRRJHAC MXXMBCBS VIM VJRICR SM ENJB ZBNZSIMPJOCD GMBSPMA MF SIC QCRRNEC"</span>

text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span><span class="token string">"t"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"I"</span><span class="token punctuation">,</span><span class="token string">"h"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"C"</span><span class="token punctuation">,</span><span class="token string">"e"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"N"</span><span class="token punctuation">,</span><span class="token string">"a"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>word_frequency<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python">Counter<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'the'</span><span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">'MF'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">'JB'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'QeRRaEe'</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'that'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'XMJBt'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'tM'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'HY'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'GeBtPaA'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'XPMHAeQ'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'GPYXtMEPaXhY'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'JR'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'tPaBRQJttJBE'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'JBFMPQatJMB'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'FPMQ'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'H'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'QeaBR'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'XMRRJHAY'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'JBReGZPe'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'GhaBBeA'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'RZGh'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'VaY'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'MPJEJBaA'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'GaB'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'MBAY'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'He'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'PeGMTePeD'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'PJEhtFZA'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'PeGJXJeBtR'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'XaPtJGJXaBtR'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'tPaBRaGtJMB'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'aPe'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'aAJGe'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'MPJEJBatMP'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'HMH'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'PeGeJTeP'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'aBD'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'MRGaP'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'XMRRJHAe'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'MXXMBeBt'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'VhM'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'VJRheR'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'EaJB'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'ZBaZthMPJOeD'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'GMBtPMA'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>观察发现 tM 对应 to，aPe 对应 are</p>
<p>按这种方式反复进行替换，直到语义正确为止</p>
<p>最终的替换表</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> EN_Words_Frequency <span class="token keyword">import</span> <span class="token operator">*</span>

text <span class="token operator">=</span> <span class="token string">"SIC GCBSPNA XPMHACQ JB GPYXSMEPNXIY JR SINS MF SPNBRQJSSJBE JBFMPQNSJMB FPMQ N XMJBS N SM N XMJBS H HY QCNBR MF N XMRRJHAY JBRCGZPC GINBBCA JB RZGI N VNY SINS SIC MPJEJBNA QCRRNEC GNB MBAY HC PCGMTCPCD HY SIC PJEISFZA PCGJXJCBSR SIC XNPSJGJXNBSR JB SIC SPNBRNGSJMB NPC NAJGC SIC MPJEJBNSMP MF SIC QCRRNEC HMH SIC PCGCJTCP NBD MRGNP N XMRRJHAC MXXMBCBS VIM VJRICR SM ENJB ZBNZSIMPJOCD GMBSPMA MF SIC QCRRNEC"</span>

text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">,</span><span class="token string">"t"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"I"</span><span class="token punctuation">,</span><span class="token string">"h"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"C"</span><span class="token punctuation">,</span><span class="token string">"e"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"N"</span><span class="token punctuation">,</span><span class="token string">"a"</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"M"</span><span class="token punctuation">,</span><span class="token string">"o"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"P"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"F"</span><span class="token punctuation">,</span><span class="token string">"f"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"V"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"J"</span><span class="token punctuation">,</span><span class="token string">"i"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"R"</span><span class="token punctuation">,</span><span class="token string">"s"</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"Q"</span><span class="token punctuation">,</span><span class="token string">"m"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"E"</span><span class="token punctuation">,</span><span class="token string">"g"</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"X"</span><span class="token punctuation">,</span><span class="token string">"p"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"H"</span><span class="token punctuation">,</span><span class="token string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"A"</span><span class="token punctuation">,</span><span class="token string">"l"</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"Y"</span><span class="token punctuation">,</span><span class="token string">"y"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"B"</span><span class="token punctuation">,</span><span class="token string">"n"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"D"</span><span class="token punctuation">,</span><span class="token string">"d"</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"G"</span><span class="token punctuation">,</span><span class="token string">"c"</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"T"</span><span class="token punctuation">,</span><span class="token string">"v"</span><span class="token punctuation">)</span>
text <span class="token operator">=</span> text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"Z"</span><span class="token punctuation">,</span><span class="token string">"u"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"O"</span><span class="token punctuation">,</span><span class="token string">"z"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>word_frequency<span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>明文：</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">the central problem in cryptography is that of transmitting information from a point a to a point b by means of a possibly insecure channel in such a way that the original message can only be recovered by the rightful recipients the participants in the transaction are alice the originator of the message bob the receiver and oscar a possible opponent who wishes to gain unauthorized control of the message<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>置换表</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span>
    <span class="token string">'A'</span><span class="token punctuation">:</span> <span class="token string">'l'</span><span class="token punctuation">,</span>   <span class="token string">'B'</span><span class="token punctuation">:</span> <span class="token string">'n'</span><span class="token punctuation">,</span>   <span class="token string">'C'</span><span class="token punctuation">:</span> <span class="token string">'e'</span><span class="token punctuation">,</span>   <span class="token string">'D'</span><span class="token punctuation">:</span> <span class="token string">'d'</span><span class="token punctuation">,</span>
    <span class="token string">'E'</span><span class="token punctuation">:</span> <span class="token string">'g'</span><span class="token punctuation">,</span>   <span class="token string">'F'</span><span class="token punctuation">:</span> <span class="token string">'f'</span><span class="token punctuation">,</span>   <span class="token string">'G'</span><span class="token punctuation">:</span> <span class="token string">'c'</span><span class="token punctuation">,</span>   <span class="token string">'H'</span><span class="token punctuation">:</span> <span class="token string">'b'</span><span class="token punctuation">,</span>
    <span class="token string">'I'</span><span class="token punctuation">:</span> <span class="token string">'h'</span><span class="token punctuation">,</span>   <span class="token string">'J'</span><span class="token punctuation">:</span> <span class="token string">'i'</span><span class="token punctuation">,</span>   
    <span class="token string">'M'</span><span class="token punctuation">:</span> <span class="token string">'o'</span><span class="token punctuation">,</span>   <span class="token string">'N'</span><span class="token punctuation">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span>   <span class="token string">'O'</span><span class="token punctuation">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span>   <span class="token string">'P'</span><span class="token punctuation">:</span> <span class="token string">'r'</span><span class="token punctuation">,</span>
    <span class="token string">'Q'</span><span class="token punctuation">:</span> <span class="token string">'m'</span><span class="token punctuation">,</span>   <span class="token string">'R'</span><span class="token punctuation">:</span> <span class="token string">'s'</span><span class="token punctuation">,</span>   <span class="token string">'S'</span><span class="token punctuation">:</span> <span class="token string">'t'</span><span class="token punctuation">,</span>   <span class="token string">'T'</span><span class="token punctuation">:</span> <span class="token string">'v'</span><span class="token punctuation">,</span>
    <span class="token string">'V'</span><span class="token punctuation">:</span> <span class="token string">'w'</span><span class="token punctuation">,</span>   <span class="token string">'X'</span><span class="token punctuation">:</span> <span class="token string">'p'</span><span class="token punctuation">,</span>
    <span class="token string">'Y'</span><span class="token punctuation">:</span> <span class="token string">'y'</span><span class="token punctuation">,</span>   <span class="token string">'Z'</span><span class="token punctuation">:</span> <span class="token string">'u'</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<hr>
<h1 id="密码学数学基础"><a href="#密码学数学基础" class="headerlink" title="密码学数学基础"></a>密码学数学基础</h1><h2 id="欧几里得算法"><a href="#欧几里得算法" class="headerlink" title="欧几里得算法"></a>欧几里得算法</h2><blockquote>
<p>辗转相除法，用于计算两个非负整数a，b的最大公约数</p>
</blockquote>
<p>公式为 <code>gcd(a,b) = gcd(b,a mod b)</code>，a &gt;&#x3D; b</p>
<p>该算法不断地将 b，a mod b 作为新的a，b进行迭代计算，直到当b为0时，此时的a就是最大公约数。</p>
<p>那么就有迭代算法实现：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">%</span> b
    <span class="token keyword">return</span> a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>也可以用递归实现：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> a
    <span class="token keyword">return</span> gcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>于是完整代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> b <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">%</span> b
    <span class="token keyword">return</span> a

<span class="token keyword">print</span><span class="token punctuation">(</span>gcd<span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>gcd<span class="token punctuation">(</span><span class="token number">349</span><span class="token punctuation">,</span><span class="token number">269</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250313143250470.png" alt="image-20250313143250470"></p>
<hr>
<h2 id="扩展欧几里得算法"><a href="#扩展欧几里得算法" class="headerlink" title="扩展欧几里得算法"></a>扩展欧几里得算法</h2><blockquote>
<p>对于不完全为 0 的非负整数 a，b，gcd(a,b) 表示 a，b 的最大公约数，必然存在整数对 x，y ，使得 <code>gcd(a,b) = ax+by</code></p>
</blockquote>
<p><strong>换句话说，如果 ax+by&#x3D;m 有解，那么 m 一定是 gcd(a,b) 的若干倍</strong></p>
<p>该算法核心思想是使用<strong>递归</strong>地进行辗转相除来求解 gcd (a, b) ，同时在递归的过程中，维护两个变量 x , y，满足 ax + by &#x3D; gcd(a, b)</p>
<p>在上面 gcd 递归算法的基础上，尝试求出方程的一组 x 和 y：</p>
<p>设 a*x1 + b*y1 &#x3D; gcd(a, b)，b*x2 + (a mod b)*y2 &#x3D; gcd(b, a mod b)</p>
<p>由欧几里得定理知：<code>gcd(a, b) = gcd(b, a mod b)</code></p>
<p>则 <code>a*x1 + b*y1 = b*x2 + (a mod b)*y2</code></p>
<p>又因为 a mod b &#x3D; a - (a&#x2F;&#x2F;b)*b </p>
<p>所以 <code>a*x1 + b*y1 = b*x2 + (a - (a//b)*b)*y2</code></p>
<p>合并一下得 <code>a*x1 + b*y1 = a*y2 + b*(x2-(a//b)*y2)</code></p>
<p>那么 <code>x1 = y2</code>，<code>y1 = x2-(a//b)*y2</code></p>
<p>到这里相邻两层递归的状态关系就显示出来了，由上一层的解 x2，y2，可以推出下一层 x1，y1 的状态</p>
<p>通过把这样的 x2, y2 不断代入，递归求解直至到达边界 gcd 为 0 即余数为 0 时，除数 a 就是最大公约数，此时得到方程的一组解：x&#x3D;1，y&#x3D;0，则 <strong>a*1+b*0&#x3D;gcd(a,b)</strong></p>
<br>

<p>由上述模板可以求出方程 ax+by&#x3D;gcd(a,b) 的任意一组解 x0，y0</p>
<p>代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">ex_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> a
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> d <span class="token operator">=</span> ex_gcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>
    <span class="token keyword">return</span> y<span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">,</span> d


<span class="token keyword">print</span><span class="token punctuation">(</span>ex_gcd<span class="token punctuation">(</span><span class="token number">1769</span><span class="token punctuation">,</span> <span class="token number">550</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ex_gcd<span class="token punctuation">(</span><span class="token number">269</span><span class="token punctuation">,</span> <span class="token number">349</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250314083748560.png" alt="image-20250314083748560"></p>
<hr>
<h2 id="有限域"><a href="#有限域" class="headerlink" title="有限域"></a>有限域</h2><p>含有 2<sup>n</sup> 个元素的有限域，被称为 GF(2<sup>n</sup>)</p>
<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250314084115289.png" alt="image-20250314084115289"></p>
<p>加减法：各项异或</p>
<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250315104427548.png" alt="image-20250315104427548"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">gf_add</span><span class="token punctuation">(</span><span class="token builtin">int</span> a<span class="token punctuation">,</span><span class="token builtin">int</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">^</span> b<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>乘法：左移?位，超过有限域需要取模回到有限域</p>
<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250315104522179.png" alt="image-20250315104522179"></p>
<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250315111656599.png" alt="image-20250315111656599"></p>
<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250315110744669.png" alt="image-20250315110744669"></p>
<p>对于例4，加法运算拆成乘法运算，乘法式子内部左移运算</p>
<p>算法中利用位运算，这里视为 11 0111 与 00 1010</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">a:11 0111
b:00 1010 ^ 1 = 0
result: 0
a:110 1110
b:00 0101 ^ 1 = 1
result:110 1110
a:1101 1100
b:00 0010
result:110 1110
a:1 1011 1000 ^ 1 0001 1011 = 1010 0011
b:00 0001
result:1100 1101<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>对于 a * b，在GF(2<sup>8</sup>)上遍历8次</p>
<p>a 每次左移，b 每次右移，如果 b 的当前位为 1 即存在某一项，就让结果加上 a 当前的值（此时 a 左移的位数就是两式相乘的结果），最高位溢出时模指定的不可约多项式，这里指定为0x11B（1 0001 1011)</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">gf_multiply</span><span class="token punctuation">(</span>a<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> modulus<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0x11B</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># GF(2^8) 需要处理 8 位</span>
        <span class="token keyword">if</span> b <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">:</span>       <span class="token comment"># 如果当前位是 1</span>
            result <span class="token operator">^</span><span class="token operator">=</span> a  <span class="token comment"># 异或操作相当于加法</span>
        a <span class="token operator">&lt;&lt;</span><span class="token operator">=</span> <span class="token number">1</span>         <span class="token comment"># 左移相当于乘以 x</span>
        <span class="token keyword">if</span> a <span class="token operator">&amp;</span> <span class="token number">0x100</span><span class="token punctuation">:</span>   <span class="token comment"># 即 1 0000 0000，检测第9位是否为1，即溢出</span>
            a <span class="token operator">^</span><span class="token operator">=</span> modulus  <span class="token comment"># 模不可约多项式</span>
        b <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span>         <span class="token comment"># 处理下一位</span>
    <span class="token keyword">return</span> result

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>gf_multiply<span class="token punctuation">(</span><span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>gf_multiply<span class="token punctuation">(</span><span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250315115347111.png" alt="image-20250315115347111"></p>
<hr>
<h2 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h2><p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250317000304899.png" alt="image-20250317000304899"></p>
<p>过程：</p>
<ol>
<li><p>计算所有模数的积 n</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">M <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">for</span> m <span class="token keyword">in</span> moduli<span class="token punctuation">:</span>
    M <span class="token operator">*=</span> m<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>对于第 i 个方程：</p>
<ul>
<li><p>计算 m<sub>i</sub> &#x3D; n &#x2F; n<sub>i</sub></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">Mi <span class="token operator">=</span> M <span class="token operator">//</span> m<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>计算 m<sub>i</sub> 在模 n<sub>i</sub> 意义下的逆元 m<sub>i</sub><sup>-1</sup></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">mod_inverse</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""计算模逆元 (a^&#123;-1&#125; mod m)"""</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> d <span class="token operator">=</span> ex_gcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span> m<span class="token punctuation">)</span>
    <span class="token keyword">if</span> d <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"模数不互质，无唯一解"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> x <span class="token operator">%</span> m

Mi_inv <span class="token operator">=</span> mod_inverse<span class="token punctuation">(</span>Mi<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>计算 c<sub>i</sub> &#x3D; m<sub>i</sub>m<sub>i</sub><sup>-1</sup></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">solution <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> a<span class="token punctuation">,</span> m <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>remainders<span class="token punctuation">,</span> moduli<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Mi <span class="token operator">=</span> M <span class="token operator">//</span> m
    Mi_inv <span class="token operator">=</span> mod_inverse<span class="token punctuation">(</span>Mi<span class="token punctuation">,</span> m<span class="token punctuation">)</span>
    solution <span class="token operator">+=</span> a <span class="token operator">*</span> Mi <span class="token operator">*</span> Mi_inv<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li><p>方程组在模 n 意义下的唯一解为</p>
<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250317005602134.png" alt="image-20250317005602134"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">return</span> solution <span class="token operator">%</span> M<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<p>最终代码：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> EX_Euclid <span class="token keyword">import</span> <span class="token operator">*</span>


<span class="token keyword">def</span> <span class="token function">mod_inverse</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""计算模逆元 (a^&#123;-1&#125; mod m)"""</span>
    x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> d <span class="token operator">=</span> ex_gcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span> m<span class="token punctuation">)</span>
    <span class="token keyword">if</span> d <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"模数不互质，无唯一解"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> x <span class="token operator">%</span> m


<span class="token keyword">def</span> <span class="token function">crt</span><span class="token punctuation">(</span>remainders<span class="token punctuation">,</span> moduli<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""中国剩余定理求解"""</span>
    M <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># 所有模数的乘积</span>
    <span class="token keyword">for</span> m <span class="token keyword">in</span> moduli<span class="token punctuation">:</span>
        M <span class="token operator">*=</span> m

    solution <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> a<span class="token punctuation">,</span> m <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>remainders<span class="token punctuation">,</span> moduli<span class="token punctuation">)</span><span class="token punctuation">:</span>
        Mi <span class="token operator">=</span> M <span class="token operator">//</span> m
        Mi_inv <span class="token operator">=</span> mod_inverse<span class="token punctuation">(</span>Mi<span class="token punctuation">,</span> m<span class="token punctuation">)</span>
        solution <span class="token operator">+=</span> a <span class="token operator">*</span> Mi <span class="token operator">*</span> Mi_inv

    <span class="token keyword">return</span> solution <span class="token operator">%</span> M


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    rem <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    mod <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>crt<span class="token punctuation">(</span>rem<span class="token punctuation">,</span> mod<span class="token punctuation">)</span><span class="token punctuation">)</span>
    rem <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
    mod <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>crt<span class="token punctuation">(</span>rem<span class="token punctuation">,</span> mod<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250317112946510.png" alt="image-20250317112946510"></p>
<hr>
<h2 id="素性检验"><a href="#素性检验" class="headerlink" title="素性检验"></a>素性检验</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> math

<span class="token keyword">def</span> <span class="token function">is_prime</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bool</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""判断一个整数是否为素数"""</span>
    <span class="token keyword">if</span> n <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"No"</span>
    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"Yes"</span>
    <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"No"</span>
    
    <span class="token comment"># 计算平方根并取整，减少循环次数</span>
    sqrt_n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    
    <span class="token comment"># 检查3到平方根范围内的所有奇数</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> sqrt_n<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> n <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"No"</span>
    <span class="token keyword">return</span> <span class="token string">"Yes"</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>is_prime<span class="token punctuation">(</span><span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>is_prime<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>is_prime<span class="token punctuation">(</span><span class="token number">8000001239</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250317113650710.png" alt="image-20250317113650710"></p>
<hr>
<h2 id="爱拉托斯散筛法"><a href="#爱拉托斯散筛法" class="headerlink" title="爱拉托斯散筛法"></a>爱拉托斯散筛法</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> math

<span class="token keyword">def</span> <span class="token function">eratosthenes_sieve</span><span class="token punctuation">(</span>n<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">list</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""使用埃拉托斯特尼筛法求N以内的素数"""</span>
    <span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 初始化筛子数组（0和1非素数）</span>
    sieve <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
    sieve<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> sieve<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>
    
    <span class="token comment"># 仅需筛选到平方根即可</span>
    sqrt_n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> sqrt_n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> sieve<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token comment"># 标记i的倍数（从i²开始优化速度）</span>
            sieve<span class="token punctuation">[</span>i<span class="token operator">*</span>i <span class="token punctuation">:</span> n<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">:</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sieve<span class="token punctuation">[</span>i<span class="token operator">*</span>i <span class="token punctuation">:</span> n<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">:</span> i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 收集所有素数</span>
    primes <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i<span class="token punctuation">,</span> is_prime <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>sieve<span class="token punctuation">)</span> <span class="token keyword">if</span> is_prime<span class="token punctuation">]</span>
    <span class="token keyword">return</span> primes


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    test1 <span class="token operator">=</span> eratosthenes_sieve<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>test1<span class="token punctuation">)</span>
    test2 <span class="token operator">=</span> eratosthenes_sieve<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>test2<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250317114117728.png" alt="image-20250317114117728"></p>
<hr>
<h1 id="分组密码"><a href="#分组密码" class="headerlink" title="分组密码"></a>分组密码</h1><h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> binascii
 
<span class="token keyword">class</span> <span class="token class-name">DES</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># 初始化DES加密的参数</span>
        self<span class="token punctuation">.</span>ip <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
            <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
            <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>  <span class="token comment"># ip置换</span>
 
        self<span class="token punctuation">.</span>ip1 <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span>
            <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span>
            <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span>
            <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>  <span class="token comment"># 逆ip置换</span>
        self<span class="token punctuation">.</span>E <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
            <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span>
            <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span>
            <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>
            <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span>
            <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span>
            <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span>
            <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>  <span class="token comment"># E置换，将32位明文置换位48位</span>
        self<span class="token punctuation">.</span>P <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span>
            <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
            <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span>
            <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>  <span class="token comment"># P置换，对经过S盒之后的数据再次进行置换</span>
        self<span class="token punctuation">.</span>K <span class="token operator">=</span> <span class="token string">''</span>
        self<span class="token punctuation">.</span>k1 <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span>
            <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span>
            <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span>
            <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span>
            <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>
            <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span>
            <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span>
            <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>  <span class="token comment"># 密钥的K1初始置换</span>
        self<span class="token punctuation">.</span>k2 <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span>
            <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>
            <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span>
            <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span>
            <span class="token number">34</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
 
        self<span class="token punctuation">.</span>k0 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">]</span>  <span class="token comment"># 秘钥循环移位的位数</span>
 
        self<span class="token punctuation">.</span>S <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">[</span>
                <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span>
                <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
                <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">13</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span>
                <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span>
                <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>
                <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">9</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
                <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span>
                <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span>
                <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span>
                <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span>
                <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span>
                <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>
                <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span>
                <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span>
                <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
                <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>
                <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span>
                <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
                <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span>
                <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span>
                <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span>
                <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">11</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>  <span class="token comment"># 16进制表示S盒的数据，S盒是为了将48位转换为32位，有8个盒子</span>
 
    <span class="token keyword">def</span> <span class="token function">__substitution</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> table<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> self_table<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        :param table: 需要进行置换的列表,是一个01字符串
        :param self_table: 置换表，在__init__中初始化了
        :return: 返回置换后的01字符串
        """</span>
        sub_result <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> self_table<span class="token punctuation">:</span>
            sub_result <span class="token operator">+=</span> table<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> sub_result
 
    <span class="token keyword">def</span> <span class="token function">str2bin</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> string<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        将明文转为二进制字符串:
        :param string: 任意字符串
        :return:二进制字符串
        """</span>
        plaintext_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>string<span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 将字符串转成bytes类型，再转成list</span>
        result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># 定义返回结果</span>
        <span class="token keyword">for</span> num <span class="token keyword">in</span> plaintext_list<span class="token punctuation">:</span>
            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 将列表的每个元素转成二进制字符串，8位宽度</span>
        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">bin2str</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> binary<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        二进制字符串转成字符串
        :param binary:
        :return:
        """</span>
        list_bin <span class="token operator">=</span> <span class="token punctuation">[</span>binary<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>binary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment"># 对二进制字符串进行切分，每8位为一组</span>
        list_int <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> b <span class="token keyword">in</span> list_bin<span class="token punctuation">:</span>
            list_int<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 对二进制转成int</span>
        result <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>list_int<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 将列表转成bytes，在进行解码，得到字符串</span>
        <span class="token keyword">return</span> result
 
    <span class="token keyword">def</span> <span class="token function">__bin2int</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> binary<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">list</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        由于加密之后的二进制无法直接转成字符，有不可见字符在，utf8可能无法解码，所以需要将二进制字符串每8位转成int型号列表，用于转成bytes再转hex
        :param binary: 二进制字符串
        :return: int型列表
        """</span>
        list_bin <span class="token operator">=</span> <span class="token punctuation">[</span>binary<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>binary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span>  <span class="token comment"># 对二进制字符串进行切分，每8位为一组</span>
        list_int <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> b <span class="token keyword">in</span> list_bin<span class="token punctuation">:</span>
            list_int<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> list_int
 
    <span class="token keyword">def</span> <span class="token function">__int2bin</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> list_int<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> num <span class="token keyword">in</span> list_int<span class="token punctuation">:</span>
            result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">__get_block_list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> binary<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">list</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        对明文二进制串进行切分，每64位为一块，DES加密以64位为一组进行加密的
        :type binary: 二进制串
        """</span>
        len_binary <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>binary<span class="token punctuation">)</span>
        <span class="token keyword">if</span> len_binary <span class="token operator">%</span> <span class="token number">64</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            binary_block <span class="token operator">=</span> binary <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">"0"</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">64</span> <span class="token operator">-</span> <span class="token punctuation">(</span>len_binary <span class="token operator">%</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token punctuation">[</span>binary_block<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>binary_block<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">[</span>binary<span class="token punctuation">[</span>j<span class="token punctuation">:</span>j <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>binary<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
 
    <span class="token keyword">def</span> <span class="token function">modify_secretkey</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        修改默认密钥函数
        :return: None
        """</span>
        newkey <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"输入密钥（长度为8）："</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>newkey<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">8</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"密钥长度不符合，请重新输入："</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>modify_secretkey<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            bin_key <span class="token operator">=</span> self<span class="token punctuation">.</span>str2bin<span class="token punctuation">(</span>newkey<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>K <span class="token operator">=</span> bin_key
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"当前二进制形式密钥为：&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>K<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">__f_funtion</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> right<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> key<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        :param right: 明文二进制的字符串加密过程的右半段
        :param key: 当前轮数的密钥
        :return: 进行E扩展，与key异或操作，S盒操作后返回32位01字符串
        """</span>
        <span class="token comment"># 对right进行E扩展</span>
        e_result <span class="token operator">=</span> self<span class="token punctuation">.</span>__substitution<span class="token punctuation">(</span>right<span class="token punctuation">,</span> self<span class="token punctuation">.</span>E<span class="token punctuation">)</span>
        <span class="token comment"># 与key 进行异或操作</span>
        xor_result <span class="token operator">=</span> self<span class="token punctuation">.</span>__xor_function<span class="token punctuation">(</span>e_result<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
        <span class="token comment"># 进入S盒子</span>
        s_result <span class="token operator">=</span> self<span class="token punctuation">.</span>__s_box<span class="token punctuation">(</span>xor_result<span class="token punctuation">)</span>
        <span class="token comment"># 进行P置换</span>
        p_result <span class="token operator">=</span> self<span class="token punctuation">.</span>__substitution<span class="token punctuation">(</span>s_result<span class="token punctuation">,</span> self<span class="token punctuation">.</span>P<span class="token punctuation">)</span>
        <span class="token keyword">return</span> p_result
 
    <span class="token keyword">def</span> <span class="token function">__get_key_list</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        :return: 返回加密过程中16轮的子密钥
        """</span>
        key <span class="token operator">=</span> self<span class="token punctuation">.</span>__substitution<span class="token punctuation">(</span>self<span class="token punctuation">.</span>K<span class="token punctuation">,</span> self<span class="token punctuation">.</span>k1<span class="token punctuation">)</span>
        left_key <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">]</span>
        right_key <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">:</span><span class="token number">56</span><span class="token punctuation">]</span>
        keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            move <span class="token operator">=</span> self<span class="token punctuation">.</span>k0<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
            move_left <span class="token operator">=</span> left_key<span class="token punctuation">[</span>move<span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> left_key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>move<span class="token punctuation">]</span>
            move_right <span class="token operator">=</span> right_key<span class="token punctuation">[</span>move<span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> right_key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>move<span class="token punctuation">]</span>
            left_key <span class="token operator">=</span> move_left
            right_key <span class="token operator">=</span> move_right
            move_key <span class="token operator">=</span> left_key <span class="token operator">+</span> right_key
            ki <span class="token operator">=</span> self<span class="token punctuation">.</span>__substitution<span class="token punctuation">(</span>move_key<span class="token punctuation">,</span> self<span class="token punctuation">.</span>k2<span class="token punctuation">)</span>
            keys<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ki<span class="token punctuation">)</span>
        <span class="token keyword">return</span> keys
 
    <span class="token keyword">def</span> <span class="token function">__xor_function</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> str1<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> str2<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        :param str1: 01字符串
        :param str2: 01字符串
        :return: 异或操作返回的结果
        """</span>
        result <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>str1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> str1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> str2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
                result <span class="token operator">+=</span> <span class="token string">"0"</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                result <span class="token operator">+=</span> <span class="token string">"1"</span>
        <span class="token keyword">return</span> result
 
    <span class="token keyword">def</span> <span class="token function">__s_box</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> xor_result<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        :param xor_result: 48位01字符串
        :return: 返回32位01字符串
        """</span>
        result <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment"># 将48位数据分为6组，循环进行</span>
            block <span class="token operator">=</span> xor_result<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">]</span>
            line <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>block<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> block<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
            colmn <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>block<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
            res <span class="token operator">=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>S<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>line<span class="token operator">*</span><span class="token number">16</span> <span class="token operator">+</span> colmn<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">:</span>
                res <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> res
            result <span class="token operator">+=</span> res
        <span class="token keyword">return</span> result
 
    <span class="token keyword">def</span> <span class="token function">__iteration</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> bin_plaintext<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> key_list<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        :param bin_plaintext: 01字符串，64位
        :param key_list: 密钥列表，共16个
        :return: 进行F函数以及和left异或操作之后的字符串
        """</span>
        left <span class="token operator">=</span> bin_plaintext<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>
        right <span class="token operator">=</span> bin_plaintext<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            next_lift <span class="token operator">=</span> right
            f_result <span class="token operator">=</span> self<span class="token punctuation">.</span>__f_funtion<span class="token punctuation">(</span>right<span class="token punctuation">,</span> key_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            next_right <span class="token operator">=</span> self<span class="token punctuation">.</span>__xor_function<span class="token punctuation">(</span>left<span class="token punctuation">,</span> f_result<span class="token punctuation">)</span>
            left <span class="token operator">=</span> next_lift
            right <span class="token operator">=</span> next_right
        bin_plaintext_result <span class="token operator">=</span> left <span class="token operator">+</span> right
        <span class="token keyword">return</span> bin_plaintext_result<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">+</span> bin_plaintext_result<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>
 
    <span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> plaintext<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        :param plaintext: 明文字符串
        :return: 密文字符串
        """</span>
        bin_plaintext <span class="token operator">=</span> self<span class="token punctuation">.</span>str2bin<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>
        bin_plaintext_block <span class="token operator">=</span> self<span class="token punctuation">.</span>__get_block_list<span class="token punctuation">(</span>bin_plaintext<span class="token punctuation">)</span>
        ciphertext_bin_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        key_list <span class="token operator">=</span> self<span class="token punctuation">.</span>__get_key_list<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> block <span class="token keyword">in</span> bin_plaintext_block<span class="token punctuation">:</span>
            <span class="token comment"># 初代ip置换</span>
            sub_ip <span class="token operator">=</span> self<span class="token punctuation">.</span>__substitution<span class="token punctuation">(</span>block<span class="token punctuation">,</span> self<span class="token punctuation">.</span>ip<span class="token punctuation">)</span>
            ite_result <span class="token operator">=</span> self<span class="token punctuation">.</span>__iteration<span class="token punctuation">(</span>sub_ip<span class="token punctuation">,</span> key_list<span class="token punctuation">)</span>
            <span class="token comment"># 逆ip置换</span>
            sub_ip1 <span class="token operator">=</span> self<span class="token punctuation">.</span>__substitution<span class="token punctuation">(</span>ite_result<span class="token punctuation">,</span> self<span class="token punctuation">.</span>ip1<span class="token punctuation">)</span>
            ciphertext_bin_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sub_ip1<span class="token punctuation">)</span>
        ciphertext_bin <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>ciphertext_bin_list<span class="token punctuation">)</span>
        result <span class="token operator">=</span> self<span class="token punctuation">.</span>__bin2int<span class="token punctuation">(</span>ciphertext_bin<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ciphertext<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">'''
        :param ciphertext: 密文字符串
        :return: 明文字符串
        '''</span>
        b_ciphertext <span class="token operator">=</span> binascii<span class="token punctuation">.</span>a2b_hex<span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span>
        bin_ciphertext <span class="token operator">=</span> self<span class="token punctuation">.</span>__int2bin<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>b_ciphertext<span class="token punctuation">)</span><span class="token punctuation">)</span>
        bin_plaintext_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        key_list <span class="token operator">=</span> self<span class="token punctuation">.</span>__get_key_list<span class="token punctuation">(</span><span class="token punctuation">)</span>
        key_list <span class="token operator">=</span> key_list<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        bin_ciphertext_block <span class="token operator">=</span> <span class="token punctuation">[</span>bin_ciphertext<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bin_ciphertext<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> block <span class="token keyword">in</span> bin_ciphertext_block<span class="token punctuation">:</span>
            sub_ip <span class="token operator">=</span> self<span class="token punctuation">.</span>__substitution<span class="token punctuation">(</span>block<span class="token punctuation">,</span> self<span class="token punctuation">.</span>ip<span class="token punctuation">)</span>
            ite <span class="token operator">=</span> self<span class="token punctuation">.</span>__iteration<span class="token punctuation">(</span>sub_ip<span class="token punctuation">,</span> key_list<span class="token punctuation">)</span>
            sub_ip1 <span class="token operator">=</span> self<span class="token punctuation">.</span>__substitution<span class="token punctuation">(</span>ite<span class="token punctuation">,</span> self<span class="token punctuation">.</span>ip1<span class="token punctuation">)</span>
            bin_plaintext_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>sub_ip1<span class="token punctuation">)</span>
        bin_plaintext <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>bin_plaintext_list<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'00000000'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>bin2str<span class="token punctuation">(</span>bin_plaintext<span class="token punctuation">)</span>
 
    <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        select <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Please selecting:\n1、Encryption\t 2、Decrpytion\t 3、Exit\nYour selecting："</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> select <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
            plaintext <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Input plaintext："</span><span class="token punctuation">)</span>
            <span class="token comment"># print("Your plaintext is:&#123;&#125;".format(plaintext))</span>
            ciphertext <span class="token operator">=</span> self<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The ciphertext is：&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> select <span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">:</span>
            plaintext <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Input ciphertext："</span><span class="token punctuation">)</span>
            <span class="token comment"># print("Your ciphertext is:&#123;&#125;".format(plaintext))</span>
            plaintext <span class="token operator">=</span> self<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The plaintext is：&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment"># print(len(plaintext))</span>
        <span class="token keyword">elif</span> select <span class="token operator">==</span> <span class="token string">'3'</span><span class="token punctuation">:</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Please selecting again！"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>
 
 
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    mydes <span class="token operator">=</span> DES<span class="token punctuation">(</span><span class="token punctuation">)</span>
    mydes<span class="token punctuation">.</span>modify_secretkey<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        mydes<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250323225835213.png" alt="image-20250323225835213"></p>
<hr>
<h3 id="雪崩效应检验"><a href="#雪崩效应检验" class="headerlink" title="雪崩效应检验"></a>雪崩效应检验</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> DES
<span class="token keyword">import</span> binascii

<span class="token keyword">def</span> <span class="token function">count_bit_differences</span><span class="token punctuation">(</span>str1<span class="token punctuation">,</span> str2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""计算两个等长字符串之间的比特差异数"""</span>
    xor_result <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>str1<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token builtin">int</span><span class="token punctuation">(</span>str2<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>xor_result<span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">pad_text</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""填充文本至8字节的倍数"""</span>
    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        text <span class="token operator">+=</span> <span class="token string">b' '</span>
    <span class="token keyword">return</span> text

<span class="token keyword">def</span> <span class="token function">test_avalanche_plaintext</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> plaintext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""测试明文改变一位对密文的影响"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n测试明文雪崩效应:"</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 初始加密</span>
    cipher <span class="token operator">=</span> DES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> DES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
    padded_text <span class="token operator">=</span> pad_text<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>
    original_cipher <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>padded_text<span class="token punctuation">)</span>
    original_hex <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>original_cipher<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    total_changes <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token comment"># 逐位改变明文</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        byte_pos <span class="token operator">=</span> i <span class="token operator">//</span> <span class="token number">8</span>
        bit_pos <span class="token operator">=</span> i <span class="token operator">%</span> <span class="token number">8</span>
        
        <span class="token comment"># 改变一位</span>
        modified_text <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>
        modified_text<span class="token punctuation">[</span>byte_pos<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> bit_pos<span class="token punctuation">)</span>
        modified_text <span class="token operator">=</span> pad_text<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>modified_text<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 加密修改后的明文</span>
        new_cipher <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>modified_text<span class="token punctuation">)</span>
        new_hex <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>new_cipher<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 计算差异位数</span>
        diff_bits <span class="token operator">=</span> count_bit_differences<span class="token punctuation">(</span>original_hex<span class="token punctuation">,</span> new_hex<span class="token punctuation">)</span>
        total_changes <span class="token operator">+=</span> diff_bits
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"改变第 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">&#125;</span></span><span class="token string"> 位后，密文改变了 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>diff_bits<span class="token punctuation">&#125;</span></span><span class="token string"> 位"</span></span><span class="token punctuation">)</span>
    
    avg_changes <span class="token operator">=</span> total_changes <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"平均每位改变影响了 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>avg_changes<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">&#125;</span></span><span class="token string"> 位密文"</span></span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test_avalanche_key</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> plaintext<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""测试密钥改变一位对密文的影响"""</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n测试密钥雪崩效应:"</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 初始加密</span>
    cipher <span class="token operator">=</span> DES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> DES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
    padded_text <span class="token operator">=</span> pad_text<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>
    original_cipher <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>padded_text<span class="token punctuation">)</span>
    original_hex <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>original_cipher<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    total_changes <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token comment"># 逐位改变密钥</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        byte_pos <span class="token operator">=</span> i <span class="token operator">//</span> <span class="token number">8</span>
        bit_pos <span class="token operator">=</span> i <span class="token operator">%</span> <span class="token number">8</span>
        
        <span class="token comment"># 改变一位</span>
        modified_key <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        modified_key<span class="token punctuation">[</span>byte_pos<span class="token punctuation">]</span> <span class="token operator">^</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> bit_pos<span class="token punctuation">)</span>
        new_cipher <span class="token operator">=</span> DES<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>modified_key<span class="token punctuation">)</span><span class="token punctuation">,</span> DES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
        
        <span class="token comment"># 加密</span>
        new_ciphertext <span class="token operator">=</span> new_cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>padded_text<span class="token punctuation">)</span>
        new_hex <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>new_ciphertext<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 计算差异位数</span>
        diff_bits <span class="token operator">=</span> count_bit_differences<span class="token punctuation">(</span>original_hex<span class="token punctuation">,</span> new_hex<span class="token punctuation">)</span>
        total_changes <span class="token operator">+=</span> diff_bits
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"改变密钥第 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">&#125;</span></span><span class="token string"> 位后，密文改变了 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>diff_bits<span class="token punctuation">&#125;</span></span><span class="token string"> 位"</span></span><span class="token punctuation">)</span>
    
    avg_changes <span class="token operator">=</span> total_changes <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"平均每位改变影响了 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>avg_changes<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">&#125;</span></span><span class="token string"> 位密文"</span></span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 测试数据</span>
    key <span class="token operator">=</span> <span class="token string">b'12345678'</span>  <span class="token comment"># 8字节密钥</span>
    plaintext <span class="token operator">=</span> <span class="token string">b'Hello123'</span>  <span class="token comment"># 测试明文</span>
    
    <span class="token comment"># 进行测试</span>
    test_avalanche_plaintext<span class="token punctuation">(</span>key<span class="token punctuation">,</span> plaintext<span class="token punctuation">)</span>
    test_avalanche_key<span class="token punctuation">(</span>key<span class="token punctuation">,</span> plaintext<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250323230131639.png" alt="image-20250323230131639"></p>
<hr>
<h3 id="文件加解密"><a href="#文件加解密" class="headerlink" title="文件加解密"></a>文件加解密</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> DES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Random <span class="token keyword">import</span> get_random_bytes
<span class="token keyword">import</span> os
<span class="token keyword">import</span> argparse

<span class="token keyword">class</span> <span class="token class-name">DESFileCipher</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化DES加密器，可以指定密钥或使用随机密钥"""</span>
        <span class="token keyword">if</span> key <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>key <span class="token operator">=</span> get_random_bytes<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>  <span class="token comment"># DES需要8字节密钥</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 确保密钥长度为8字节</span>
            self<span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">b'\0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span>
    
    <span class="token keyword">def</span> <span class="token function">pad_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""对数据进行PKCS7填充"""</span>
        pad_len <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">)</span>
        padding <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>pad_len<span class="token punctuation">]</span> <span class="token operator">*</span> pad_len<span class="token punctuation">)</span>
        <span class="token keyword">return</span> data <span class="token operator">+</span> padding
    
    <span class="token keyword">def</span> <span class="token function">unpad_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""去除PKCS7填充"""</span>
        pad_len <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span>pad_len<span class="token punctuation">]</span>
    
    <span class="token keyword">def</span> <span class="token function">encrypt_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_file<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""加密文件"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 创建DES加密器</span>
            cipher <span class="token operator">=</span> DES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> DES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
            
            <span class="token comment"># 读取并加密文件</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> infile<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">:</span>
                <span class="token comment"># 首先写入密钥（在实际应用中应该通过安全渠道传输）</span>
                outfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">)</span>
                
                <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                    chunk <span class="token operator">=</span> infile<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>  <span class="token comment"># 每次读取1KB</span>
                    <span class="token keyword">if</span> <span class="token keyword">not</span> chunk<span class="token punctuation">:</span>
                        <span class="token keyword">break</span>
                    
                    <span class="token comment"># 对最后一块数据进行填充</span>
                    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
                        chunk <span class="token operator">=</span> self<span class="token punctuation">.</span>pad_data<span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
                    
                    <span class="token comment"># 加密并写入</span>
                    encrypted_chunk <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
                    outfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>encrypted_chunk<span class="token punctuation">)</span>
            
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"文件加密成功！加密后的文件保存为: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>output_file<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"加密过程中出错: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    
    <span class="token keyword">def</span> <span class="token function">decrypt_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_file<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""解密文件"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> infile<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">:</span>
                <span class="token comment"># 读取密钥（前8字节）</span>
                key <span class="token operator">=</span> infile<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>
                
                <span class="token comment"># 创建解密器</span>
                cipher <span class="token operator">=</span> DES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> DES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
                
                <span class="token comment"># 读取并解密数据</span>
                is_last_chunk <span class="token operator">=</span> <span class="token boolean">False</span>
                <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                    chunk <span class="token operator">=</span> infile<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>  <span class="token comment"># 每次读取1KB</span>
                    <span class="token keyword">if</span> <span class="token keyword">not</span> chunk<span class="token punctuation">:</span>
                        <span class="token keyword">break</span>
                    
                    <span class="token comment"># 检查是否为最后一块数据</span>
                    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token punctuation">:</span>
                        is_last_chunk <span class="token operator">=</span> <span class="token boolean">True</span>
                    
                    <span class="token comment"># 解密数据</span>
                    decrypted_chunk <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
                    
                    <span class="token comment"># 如果是最后一块，去除填充</span>
                    <span class="token keyword">if</span> is_last_chunk<span class="token punctuation">:</span>
                        decrypted_chunk <span class="token operator">=</span> self<span class="token punctuation">.</span>unpad_data<span class="token punctuation">(</span>decrypted_chunk<span class="token punctuation">)</span>
                    
                    outfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>decrypted_chunk<span class="token punctuation">)</span>
            
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"文件解密成功！解密后的文件保存为: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>output_file<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"解密过程中出错: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span>description<span class="token operator">=</span><span class="token string">'DES文件加密解密工具'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'mode'</span><span class="token punctuation">,</span> choices<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'encrypt'</span><span class="token punctuation">,</span> <span class="token string">'decrypt'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'操作模式：encrypt（加密）或decrypt（解密）'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'input_file'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'输入文件路径'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'output_file'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'输出文件路径'</span><span class="token punctuation">)</span>
    parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--key'</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">'可选：指定密钥（8字节）'</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
    
    args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 创建DES加密器实例</span>
    <span class="token keyword">if</span> args<span class="token punctuation">.</span>key<span class="token punctuation">:</span>
        des_cipher <span class="token operator">=</span> DESFileCipher<span class="token punctuation">(</span>args<span class="token punctuation">.</span>key<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        des_cipher <span class="token operator">=</span> DESFileCipher<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 执行加密或解密操作</span>
    <span class="token keyword">if</span> args<span class="token punctuation">.</span>mode <span class="token operator">==</span> <span class="token string">'encrypt'</span><span class="token punctuation">:</span>
        des_cipher<span class="token punctuation">.</span>encrypt_file<span class="token punctuation">(</span>args<span class="token punctuation">.</span>input_file<span class="token punctuation">,</span> args<span class="token punctuation">.</span>output_file<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        des_cipher<span class="token punctuation">.</span>decrypt_file<span class="token punctuation">(</span>args<span class="token punctuation">.</span>input_file<span class="token punctuation">,</span> args<span class="token punctuation">.</span>output_file<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250323230546877.png" alt="image-20250323230546877"></p>
<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250323230657667.png" alt="image-20250323230657667"></p>
<h3 id="性能分析"><a href="#性能分析" class="headerlink" title="性能分析"></a>性能分析</h3><p>使用伪随机数生成程序，生成不同大小的文件，然后采用DES加密解密，记录时间</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> DES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Random <span class="token keyword">import</span> get_random_bytes
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm

<span class="token keyword">class</span> <span class="token class-name">FileGenerator</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">generate_random_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> size_mb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""生成指定大小的随机文件"""</span>
        size_bytes <span class="token operator">=</span> size_mb <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>  <span class="token comment"># 转换为字节</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            remaining_bytes <span class="token operator">=</span> size_bytes
            chunk_size <span class="token operator">=</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>  <span class="token comment"># 每次写入1MB</span>
            
            <span class="token keyword">with</span> tqdm<span class="token punctuation">(</span>total<span class="token operator">=</span>size_bytes<span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'B'</span><span class="token punctuation">,</span> unit_scale<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> 
                     desc<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f'生成 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>size_mb<span class="token punctuation">&#125;</span></span><span class="token string">MB 文件'</span></span><span class="token punctuation">)</span> <span class="token keyword">as</span> pbar<span class="token punctuation">:</span>
                <span class="token keyword">while</span> remaining_bytes <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
                    current_chunk <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>chunk_size<span class="token punctuation">,</span> remaining_bytes<span class="token punctuation">)</span>
                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>get_random_bytes<span class="token punctuation">(</span>current_chunk<span class="token punctuation">)</span><span class="token punctuation">)</span>
                    remaining_bytes <span class="token operator">-=</span> current_chunk
                    pbar<span class="token punctuation">.</span>update<span class="token punctuation">(</span>current_chunk<span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">DESPerformanceTester</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>key <span class="token operator">=</span> get_random_bytes<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>  <span class="token comment"># 生成8字节密钥</span>
        
    <span class="token keyword">def</span> <span class="token function">pad_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""PKCS7填充"""</span>
        pad_len <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">)</span>
        padding <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>pad_len<span class="token punctuation">]</span> <span class="token operator">*</span> pad_len<span class="token punctuation">)</span>
        <span class="token keyword">return</span> data <span class="token operator">+</span> padding
    
    <span class="token keyword">def</span> <span class="token function">unpad_data</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""去除PKCS7填充"""</span>
        pad_len <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span>pad_len<span class="token punctuation">]</span>
    
    <span class="token keyword">def</span> <span class="token function">encrypt_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_file<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""加密文件并返回耗时"""</span>
        start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        cipher <span class="token operator">=</span> DES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> DES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
        file_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>input_file<span class="token punctuation">)</span>
        
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> infile<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">:</span>
            <span class="token keyword">with</span> tqdm<span class="token punctuation">(</span>total<span class="token operator">=</span>file_size<span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'B'</span><span class="token punctuation">,</span> unit_scale<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> 
                     desc<span class="token operator">=</span><span class="token string">'加密进度'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> pbar<span class="token punctuation">:</span>
                <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                    chunk <span class="token operator">=</span> infile<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span>  <span class="token comment"># 读取1MB</span>
                    <span class="token keyword">if</span> <span class="token keyword">not</span> chunk<span class="token punctuation">:</span>
                        <span class="token keyword">break</span>
                    
                    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
                        chunk <span class="token operator">=</span> self<span class="token punctuation">.</span>pad_data<span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
                    
                    encrypted_chunk <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
                    outfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>encrypted_chunk<span class="token punctuation">)</span>
                    pbar<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time
    
    <span class="token keyword">def</span> <span class="token function">decrypt_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_file<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""解密文件并返回耗时"""</span>
        start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        
        cipher <span class="token operator">=</span> DES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> DES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
        file_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>input_file<span class="token punctuation">)</span>
        
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> infile<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">:</span>
            is_last_chunk <span class="token operator">=</span> <span class="token boolean">False</span>
            <span class="token keyword">with</span> tqdm<span class="token punctuation">(</span>total<span class="token operator">=</span>file_size<span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">'B'</span><span class="token punctuation">,</span> unit_scale<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> 
                     desc<span class="token operator">=</span><span class="token string">'解密进度'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> pbar<span class="token punctuation">:</span>
                <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                    chunk <span class="token operator">=</span> infile<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span>  <span class="token comment"># 读取1MB</span>
                    <span class="token keyword">if</span> <span class="token keyword">not</span> chunk<span class="token punctuation">:</span>
                        <span class="token keyword">break</span>
                    
                    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">:</span>
                        is_last_chunk <span class="token operator">=</span> <span class="token boolean">True</span>
                    
                    decrypted_chunk <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
                    
                    <span class="token keyword">if</span> is_last_chunk<span class="token punctuation">:</span>
                        decrypted_chunk <span class="token operator">=</span> self<span class="token punctuation">.</span>unpad_data<span class="token punctuation">(</span>decrypted_chunk<span class="token punctuation">)</span>
                    
                    outfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>decrypted_chunk<span class="token punctuation">)</span>
                    pbar<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">)</span>
        
        <span class="token keyword">return</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time

<span class="token keyword">def</span> <span class="token function">run_performance_test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 测试文件大小（MB）</span>
    file_sizes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">]</span>
    results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    generator <span class="token operator">=</span> FileGenerator<span class="token punctuation">(</span><span class="token punctuation">)</span>
    tester <span class="token operator">=</span> DESPerformanceTester<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">for</span> size <span class="token keyword">in</span> file_sizes<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\n测试文件大小: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>size<span class="token punctuation">&#125;</span></span><span class="token string">MB"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 生成随机文件</span>
        input_file <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"test_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>size<span class="token punctuation">&#125;</span></span><span class="token string">mb.dat"</span></span>
        encrypted_file <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"encrypted_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>size<span class="token punctuation">&#125;</span></span><span class="token string">mb.dat"</span></span>
        decrypted_file <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"decrypted_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>size<span class="token punctuation">&#125;</span></span><span class="token string">mb.dat"</span></span>
        
        generator<span class="token punctuation">.</span>generate_random_file<span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> size<span class="token punctuation">)</span>
        
        <span class="token comment"># 测试加密</span>
        encrypt_time <span class="token operator">=</span> tester<span class="token punctuation">.</span>encrypt_file<span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> encrypted_file<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"加密耗时: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>encrypt_time<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">&#125;</span></span><span class="token string">秒"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 测试解密</span>
        decrypt_time <span class="token operator">=</span> tester<span class="token punctuation">.</span>decrypt_file<span class="token punctuation">(</span>encrypted_file<span class="token punctuation">,</span> decrypted_file<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"解密耗时: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>decrypt_time<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">&#125;</span></span><span class="token string">秒"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 记录结果</span>
        results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
            <span class="token string">'size_mb'</span><span class="token punctuation">:</span> size<span class="token punctuation">,</span>
            <span class="token string">'encrypt_time'</span><span class="token punctuation">:</span> encrypt_time<span class="token punctuation">,</span>
            <span class="token string">'decrypt_time'</span><span class="token punctuation">:</span> decrypt_time
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 清理临时文件</span>
        <span class="token keyword">for</span> f <span class="token keyword">in</span> <span class="token punctuation">[</span>input_file<span class="token punctuation">,</span> encrypted_file<span class="token punctuation">,</span> decrypted_file<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">:</span>
                os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> results

<span class="token keyword">def</span> <span class="token function">plot_results</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""绘制性能测试结果图表"""</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>results<span class="token punctuation">)</span>
    
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'size_mb'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'encrypt_time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'b-o'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'加密时间'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'size_mb'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">'decrypt_time'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'r-o'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'解密时间'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'文件大小 (MB)'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'处理时间 (秒)'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'DES加密解密性能测试'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'des_performance.png'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 打印详细结果表格</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n性能测试结果:"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>to_string<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始DES加密性能测试..."</span><span class="token punctuation">)</span>
    results <span class="token operator">=</span> run_performance_test<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plot_results<span class="token punctuation">(</span>results<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n测试完成！结果图表已保存为 'des_performance.png'"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250323231110209.png" alt="image-20250323231110209"></p>
<hr>
<h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><h3 id="文件加解密-1"><a href="#文件加解密-1" class="headerlink" title="文件加解密"></a>文件加解密</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Random <span class="token keyword">import</span> get_random_bytes
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>Padding <span class="token keyword">import</span> pad<span class="token punctuation">,</span> unpad
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> os

<span class="token keyword">class</span> <span class="token class-name">AESCipher</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> mode<span class="token operator">=</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        初始化AES加密器
        :param key: 密钥（16、24或32字节，对应AES-128、AES-192、AES-256）
        :param mode: 加密模式（CBC、ECB、CFB等）
        """</span>
        self<span class="token punctuation">.</span>block_size <span class="token operator">=</span> AES<span class="token punctuation">.</span>block_size
        <span class="token keyword">if</span> key <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token comment"># 如果没有提供密钥，默认生成256位(32字节)的密钥</span>
            self<span class="token punctuation">.</span>key <span class="token operator">=</span> get_random_bytes<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token comment"># 确保密钥长度正确（16、24或32字节）</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"密钥长度必须为16、24或32字节"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>key <span class="token operator">=</span> key
        self<span class="token punctuation">.</span>mode <span class="token operator">=</span> mode

    <span class="token keyword">def</span> <span class="token function">_create_cipher</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> iv<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        创建加密器实例
        :param iv: 初始化向量（CBC、CFB模式需要）
        :return: Cipher对象
        """</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>mode <span class="token keyword">in</span> <span class="token punctuation">[</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CFB<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> iv <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                iv <span class="token operator">=</span> get_random_bytes<span class="token punctuation">(</span>self<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>
            <span class="token keyword">return</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> self<span class="token punctuation">.</span>mode<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token punctuation">,</span> iv
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> self<span class="token punctuation">.</span>mode<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">encrypt_string</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> plaintext<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        加密字符串
        :param plaintext: 明文字符串
        :return: base64编码的密文
        """</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 创建加密器</span>
            cipher<span class="token punctuation">,</span> iv <span class="token operator">=</span> self<span class="token punctuation">.</span>_create_cipher<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
            <span class="token comment"># 将字符串转换为字节并填充</span>
            plaintext_bytes <span class="token operator">=</span> plaintext<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
            padded_data <span class="token operator">=</span> pad<span class="token punctuation">(</span>plaintext_bytes<span class="token punctuation">,</span> self<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>
            
            <span class="token comment"># 加密</span>
            ciphertext <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>padded_data<span class="token punctuation">)</span>
            
            <span class="token comment"># 组合IV和密文（如果使用了IV）</span>
            <span class="token keyword">if</span> iv<span class="token punctuation">:</span>
                final_data <span class="token operator">=</span> iv <span class="token operator">+</span> ciphertext
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                final_data <span class="token operator">=</span> ciphertext
            
            <span class="token comment"># 转换为base64编码</span>
            <span class="token keyword">return</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>final_data<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"加密失败: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">decrypt_string</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> ciphertext_b64<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        解密字符串
        :param ciphertext_b64: base64编码的密文
        :return: 解密后的明文字符串
        """</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 解码base64</span>
            ciphertext <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>ciphertext_b64<span class="token punctuation">)</span>
            
            <span class="token comment"># 提取IV（如果有）</span>
            <span class="token keyword">if</span> self<span class="token punctuation">.</span>mode <span class="token keyword">in</span> <span class="token punctuation">[</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CFB<span class="token punctuation">]</span><span class="token punctuation">:</span>
                iv <span class="token operator">=</span> ciphertext<span class="token punctuation">[</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>block_size<span class="token punctuation">]</span>
                ciphertext <span class="token operator">=</span> ciphertext<span class="token punctuation">[</span>self<span class="token punctuation">.</span>block_size<span class="token punctuation">:</span><span class="token punctuation">]</span>
                cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> self<span class="token punctuation">.</span>mode<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> self<span class="token punctuation">.</span>mode<span class="token punctuation">)</span>
            
            <span class="token comment"># 解密并去除填充</span>
            decrypted_data <span class="token operator">=</span> unpad<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>ciphertext<span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>
            
            <span class="token comment"># 转换为字符串</span>
            <span class="token keyword">return</span> decrypted_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"解密失败: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">encrypt_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_file<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        加密文件
        :param input_file: 输入文件路径
        :param output_file: 输出文件路径
        """</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 创建加密器</span>
            cipher<span class="token punctuation">,</span> iv <span class="token operator">=</span> self<span class="token punctuation">.</span>_create_cipher<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> infile<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">:</span>
                <span class="token comment"># 写入IV（如果有）</span>
                <span class="token keyword">if</span> iv<span class="token punctuation">:</span>
                    outfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>iv<span class="token punctuation">)</span>
                
                <span class="token comment"># 分块读取并加密</span>
                <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                    chunk <span class="token operator">=</span> infile<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span>  <span class="token comment"># 每次读取1MB</span>
                    <span class="token keyword">if</span> <span class="token keyword">not</span> chunk<span class="token punctuation">:</span>
                        <span class="token keyword">break</span>
                    
                    <span class="token comment"># 对最后一块进行填充</span>
                    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>block_size <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
                        chunk <span class="token operator">=</span> pad<span class="token punctuation">(</span>chunk<span class="token punctuation">,</span> self<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>
                    
                    <span class="token comment"># 加密并写入</span>
                    encrypted_chunk <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
                    outfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>encrypted_chunk<span class="token punctuation">)</span>
                    
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"文件加密成功: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>output_file<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"文件加密失败: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">decrypt_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_file<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        解密文件
        :param input_file: 输入文件路径
        :param output_file: 输出文件路径
        """</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> infile<span class="token punctuation">:</span>
                <span class="token comment"># 读取IV（如果需要）</span>
                <span class="token keyword">if</span> self<span class="token punctuation">.</span>mode <span class="token keyword">in</span> <span class="token punctuation">[</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CFB<span class="token punctuation">]</span><span class="token punctuation">:</span>
                    iv <span class="token operator">=</span> infile<span class="token punctuation">.</span>read<span class="token punctuation">(</span>self<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>
                    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> self<span class="token punctuation">.</span>mode<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> self<span class="token punctuation">.</span>mode<span class="token punctuation">)</span>
                
                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> outfile<span class="token punctuation">:</span>
                    <span class="token comment"># 分块读取并解密</span>
                    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                        chunk <span class="token operator">=</span> infile<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">)</span>  <span class="token comment"># 每次读取1MB</span>
                        <span class="token keyword">if</span> <span class="token keyword">not</span> chunk<span class="token punctuation">:</span>
                            <span class="token keyword">break</span>
                        
                        decrypted_chunk <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>chunk<span class="token punctuation">)</span>
                        
                        <span class="token comment"># 对最后一块去除填充</span>
                        <span class="token keyword">if</span> <span class="token keyword">not</span> infile<span class="token punctuation">.</span>peek<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 如果是最后一块</span>
                            decrypted_chunk <span class="token operator">=</span> unpad<span class="token punctuation">(</span>decrypted_chunk<span class="token punctuation">,</span> self<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>
                        
                        outfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>decrypted_chunk<span class="token punctuation">)</span>
                    
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"文件解密成功: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>output_file<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"文件解密失败: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 示例用法</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># 创建AES加密器（使用CBC模式）</span>
        key <span class="token operator">=</span> get_random_bytes<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>  <span class="token comment"># 使用256位密钥</span>
        aes <span class="token operator">=</span> AESCipher<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">)</span>
        
        <span class="token comment"># 字符串加解密示例</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n=== 字符串加解密测试 ==="</span><span class="token punctuation">)</span>
        original_text <span class="token operator">=</span> <span class="token string">"这是一个测试文本！Hello, AES!"</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"原始文本: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>original_text<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 加密</span>
        encrypted_text <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt_string<span class="token punctuation">(</span>original_text<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"加密后: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>encrypted_text<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 解密</span>
        decrypted_text <span class="token operator">=</span> aes<span class="token punctuation">.</span>decrypt_string<span class="token punctuation">(</span>encrypted_text<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"解密后: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>decrypted_text<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        
        <span class="token comment"># 文件加解密示例</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n=== 文件加解密测试 ==="</span><span class="token punctuation">)</span>
        <span class="token comment"># 创建测试文件</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"这是测试文件的内容\nTest file content!"</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 加密文件</span>
        aes<span class="token punctuation">.</span>encrypt_file<span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string">"encrypted.bin"</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 解密文件</span>
        aes<span class="token punctuation">.</span>decrypt_file<span class="token punctuation">(</span><span class="token string">"encrypted.bin"</span><span class="token punctuation">,</span> <span class="token string">"decrypted.txt"</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 验证解密结果</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f1<span class="token punctuation">,</span> \
             <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"decrypted.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f2<span class="token punctuation">:</span>
            original <span class="token operator">=</span> f1<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
            decrypted <span class="token operator">=</span> f2<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"文件解密验证:"</span><span class="token punctuation">,</span> <span class="token string">"成功"</span> <span class="token keyword">if</span> original <span class="token operator">==</span> decrypted <span class="token keyword">else</span> <span class="token string">"失败"</span><span class="token punctuation">)</span>
        
        <span class="token comment"># 清理测试文件</span>
        <span class="token keyword">for</span> <span class="token builtin">file</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string">"encrypted.bin"</span><span class="token punctuation">,</span> <span class="token string">"decrypted.txt"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
                
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"错误: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250331014744630.png" alt="image-20250331014744630"></p>
<hr>
<h3 id="性能分析-1"><a href="#性能分析-1" class="headerlink" title="性能分析"></a>性能分析</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Random <span class="token keyword">import</span> get_random_bytes
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>Padding <span class="token keyword">import</span> pad<span class="token punctuation">,</span> unpad
<span class="token keyword">import</span> os
<span class="token keyword">import</span> time
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns

<span class="token keyword">class</span> <span class="token class-name">FileGenerator</span><span class="token punctuation">:</span>
    <span class="token decorator annotation punctuation">@staticmethod</span>
    <span class="token keyword">def</span> <span class="token function">generate_random_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> size_kb<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""生成指定大小的随机文件"""</span>
        size_bytes <span class="token operator">=</span> size_kb <span class="token operator">*</span> <span class="token number">1024</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>get_random_bytes<span class="token punctuation">(</span>size_bytes<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> size_bytes

<span class="token keyword">class</span> <span class="token class-name">AESCipher</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""初始化AES加密器，默认使用256位密钥"""</span>
        self<span class="token punctuation">.</span>key <span class="token operator">=</span> key <span class="token keyword">if</span> key <span class="token keyword">else</span> get_random_bytes<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>  <span class="token comment"># 256位密钥</span>
        self<span class="token punctuation">.</span>block_size <span class="token operator">=</span> AES<span class="token punctuation">.</span>block_size

    <span class="token keyword">def</span> <span class="token function">encrypt_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_file<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""加密文件并返回处理时间"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 记录开始时间</span>
            start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
            <span class="token comment"># 创建加密器（CBC模式）</span>
            iv <span class="token operator">=</span> get_random_bytes<span class="token punctuation">(</span>self<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>
            cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
            
            <span class="token comment"># 读取文件并加密</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> in_file<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> out_file<span class="token punctuation">:</span>
                <span class="token comment"># 写入IV</span>
                out_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>iv<span class="token punctuation">)</span>
                
                <span class="token comment"># 读取并加密数据</span>
                data <span class="token operator">=</span> in_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
                padded_data <span class="token operator">=</span> pad<span class="token punctuation">(</span>data<span class="token punctuation">,</span> self<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>
                encrypted_data <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>padded_data<span class="token punctuation">)</span>
                out_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>encrypted_data<span class="token punctuation">)</span>
            
            <span class="token comment"># 计算处理时间</span>
            end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> end_time <span class="token operator">-</span> start_time
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"加密错误: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>

    <span class="token keyword">def</span> <span class="token function">decrypt_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_file<span class="token punctuation">,</span> output_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""解密文件并返回处理时间"""</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 记录开始时间</span>
            start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            
            <span class="token comment"># 读取并解密数据</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> in_file<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output_file<span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> out_file<span class="token punctuation">:</span>
                <span class="token comment"># 读取IV</span>
                iv <span class="token operator">=</span> in_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span>self<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>
                cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>self<span class="token punctuation">.</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
                
                <span class="token comment"># 读取并解密数据</span>
                encrypted_data <span class="token operator">=</span> in_file<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
                decrypted_data <span class="token operator">=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>encrypted_data<span class="token punctuation">)</span>
                unpadded_data <span class="token operator">=</span> unpad<span class="token punctuation">(</span>decrypted_data<span class="token punctuation">,</span> self<span class="token punctuation">.</span>block_size<span class="token punctuation">)</span>
                out_file<span class="token punctuation">.</span>write<span class="token punctuation">(</span>unpadded_data<span class="token punctuation">)</span>
            
            <span class="token comment"># 计算处理时间</span>
            end_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> end_time <span class="token operator">-</span> start_time
            
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"解密错误: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">None</span>

<span class="token keyword">def</span> <span class="token function">test_aes_performance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 测试文件大小（KB）</span>
    file_sizes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">,</span> <span class="token number">5120</span><span class="token punctuation">]</span>  <span class="token comment"># 1KB到5MB</span>
    results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    
    <span class="token comment"># 创建加密器实例</span>
    aes <span class="token operator">=</span> AESCipher<span class="token punctuation">(</span><span class="token punctuation">)</span>
    file_gen <span class="token operator">=</span> FileGenerator<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\nAES加密性能测试"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"="</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'文件大小'</span><span class="token punctuation">:</span><span class="token format-spec">>10</span><span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'加密时间(s)'</span><span class="token punctuation">:</span><span class="token format-spec">>12</span><span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'解密时间(s)'</span><span class="token punctuation">:</span><span class="token format-spec">>12</span><span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'加密速度(MB/s)'</span><span class="token punctuation">:</span><span class="token format-spec">>15</span><span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'解密速度(MB/s)'</span><span class="token punctuation">:</span><span class="token format-spec">>15</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>
    
    <span class="token keyword">for</span> size <span class="token keyword">in</span> file_sizes<span class="token punctuation">:</span>
        <span class="token comment"># 生成测试文件</span>
        input_file <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"test_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>size<span class="token punctuation">&#125;</span></span><span class="token string">kb.dat"</span></span>
        encrypted_file <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"encrypted_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>size<span class="token punctuation">&#125;</span></span><span class="token string">kb.bin"</span></span>
        decrypted_file <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"decrypted_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>size<span class="token punctuation">&#125;</span></span><span class="token string">kb.dat"</span></span>
        
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># 生成随机文件</span>
            file_size <span class="token operator">=</span> file_gen<span class="token punctuation">.</span>generate_random_file<span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> size<span class="token punctuation">)</span>
            
            <span class="token comment"># 测试加密</span>
            encrypt_time <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt_file<span class="token punctuation">(</span>input_file<span class="token punctuation">,</span> encrypted_file<span class="token punctuation">)</span>
            
            <span class="token comment"># 测试解密</span>
            decrypt_time <span class="token operator">=</span> aes<span class="token punctuation">.</span>decrypt_file<span class="token punctuation">(</span>encrypted_file<span class="token punctuation">,</span> decrypted_file<span class="token punctuation">)</span>
            
            <span class="token comment"># 计算速度（MB/s）</span>
            size_mb <span class="token operator">=</span> size <span class="token operator">/</span> <span class="token number">1024</span>  <span class="token comment"># 转换为MB</span>
            encrypt_speed <span class="token operator">=</span> size_mb <span class="token operator">/</span> encrypt_time <span class="token keyword">if</span> encrypt_time <span class="token keyword">else</span> <span class="token number">0</span>
            decrypt_speed <span class="token operator">=</span> size_mb <span class="token operator">/</span> decrypt_time <span class="token keyword">if</span> decrypt_time <span class="token keyword">else</span> <span class="token number">0</span>
            
            <span class="token comment"># 记录结果</span>
            results<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
                <span class="token string">'size_kb'</span><span class="token punctuation">:</span> size<span class="token punctuation">,</span>
                <span class="token string">'encrypt_time'</span><span class="token punctuation">:</span> encrypt_time<span class="token punctuation">,</span>
                <span class="token string">'decrypt_time'</span><span class="token punctuation">:</span> decrypt_time<span class="token punctuation">,</span>
                <span class="token string">'encrypt_speed'</span><span class="token punctuation">:</span> encrypt_speed<span class="token punctuation">,</span>
                <span class="token string">'decrypt_speed'</span><span class="token punctuation">:</span> decrypt_speed
            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
            
            <span class="token comment"># 打印结果</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>size<span class="token punctuation">:</span><span class="token format-spec">>8</span><span class="token punctuation">&#125;</span></span><span class="token string">KB </span><span class="token interpolation"><span class="token punctuation">&#123;</span>encrypt_time<span class="token punctuation">:</span><span class="token format-spec">>12.4f</span><span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>decrypt_time<span class="token punctuation">:</span><span class="token format-spec">>12.4f</span><span class="token punctuation">&#125;</span></span><span class="token string"> "</span></span>
                  <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>encrypt_speed<span class="token punctuation">:</span><span class="token format-spec">>14.2f</span><span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>decrypt_speed<span class="token punctuation">:</span><span class="token format-spec">>14.2f</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            
        <span class="token keyword">finally</span><span class="token punctuation">:</span>
            <span class="token comment"># 清理文件</span>
            <span class="token keyword">for</span> f <span class="token keyword">in</span> <span class="token punctuation">[</span>input_file<span class="token punctuation">,</span> encrypted_file<span class="token punctuation">,</span> decrypted_file<span class="token punctuation">]</span><span class="token punctuation">:</span>
                <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    os<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    
    <span class="token keyword">return</span> results

<span class="token keyword">def</span> <span class="token function">plot_results</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""绘制性能测试结果图表"""</span>
    df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>results<span class="token punctuation">)</span>
    
    <span class="token comment"># 设置图表风格</span>
    sns<span class="token punctuation">.</span>set_style<span class="token punctuation">(</span><span class="token string">"whitegrid"</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 创建图表</span>
    fig<span class="token punctuation">,</span> <span class="token punctuation">(</span>ax1<span class="token punctuation">,</span> ax2<span class="token punctuation">)</span> <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 处理时间图表</span>
    sns<span class="token punctuation">.</span>lineplot<span class="token punctuation">(</span>data<span class="token operator">=</span>df<span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token string">'size_kb'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'encrypt_time'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'加密时间'</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>ax1<span class="token punctuation">)</span>
    sns<span class="token punctuation">.</span>lineplot<span class="token punctuation">(</span>data<span class="token operator">=</span>df<span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token string">'size_kb'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'decrypt_time'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'解密时间'</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>ax1<span class="token punctuation">)</span>
    ax1<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'文件大小 (KB)'</span><span class="token punctuation">)</span>
    ax1<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'处理时间 (秒)'</span><span class="token punctuation">)</span>
    ax1<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'AES加密解密时间'</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 处理速度图表</span>
    sns<span class="token punctuation">.</span>lineplot<span class="token punctuation">(</span>data<span class="token operator">=</span>df<span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token string">'size_kb'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'encrypt_speed'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'加密速度'</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>ax2<span class="token punctuation">)</span>
    sns<span class="token punctuation">.</span>lineplot<span class="token punctuation">(</span>data<span class="token operator">=</span>df<span class="token punctuation">,</span> x<span class="token operator">=</span><span class="token string">'size_kb'</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">'decrypt_speed'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'o'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'解密速度'</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>ax2<span class="token punctuation">)</span>
    ax2<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'文件大小 (KB)'</span><span class="token punctuation">)</span>
    ax2<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'处理速度 (MB/s)'</span><span class="token punctuation">)</span>
    ax2<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'AES加密解密速度'</span><span class="token punctuation">)</span>
    
    plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'aes_performance.png'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 打印详细结果表格</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n性能测试结果:"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>to_string<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 保存结果到CSV文件</span>
    df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'aes_performance_results.csv'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">verify_encryption</span><span class="token punctuation">(</span>original_file<span class="token punctuation">,</span> decrypted_file<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""验证加密解密结果"""</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>original_file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f1<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span>decrypted_file<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f2<span class="token punctuation">:</span>
        <span class="token keyword">return</span> f1<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> f2<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始AES加密性能测试..."</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 运行测试</span>
    results <span class="token operator">=</span> test_aes_performance<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># 绘制结果</span>
    plot_results<span class="token punctuation">(</span>results<span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n测试完成！"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"结果已保存到 'aes_performance.png' 和 'aes_performance_results.csv'"</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250331093348027.png" alt="image-20250331093348027"></p>
<hr>
<h1 id="公钥密码"><a href="#公钥密码" class="headerlink" title="公钥密码"></a>公钥密码</h1><h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><h3 id="生成大素数"><a href="#生成大素数" class="headerlink" title="生成大素数"></a>生成大素数</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> random
<span class="token keyword">from</span> math <span class="token keyword">import</span> gcd

<span class="token keyword">def</span> <span class="token function">is_prime</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""素性检测算法"""</span>
    <span class="token keyword">if</span> n <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">elif</span> n <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    s<span class="token punctuation">,</span> d <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">while</span> d <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        d <span class="token operator">//=</span> <span class="token number">2</span>
        s <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
        a <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">min</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        <span class="token keyword">if</span> x <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">or</span> x <span class="token operator">==</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">for</span> __ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>s <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            x <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
            <span class="token keyword">if</span> x <span class="token operator">==</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">return</span> <span class="token boolean">True</span> 

<span class="token keyword">def</span> <span class="token function">generate_prime</span><span class="token punctuation">(</span>bits<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""生成指定位数的素数"""</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        num <span class="token operator">=</span> random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>
        num <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>bits <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">1</span>
        <span class="token keyword">if</span> is_prime<span class="token punctuation">(</span>num<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> num
        
<span class="token keyword">print</span><span class="token punctuation">(</span>generate_prime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250421101947721.png" alt="image-20250421101947721"></p>
<hr>
<h3 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">mod_inverse</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""扩展欧几里得算法求模逆元"""</span>
    g<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span> m<span class="token punctuation">)</span>
    <span class="token keyword">if</span> g <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"模逆元不存在"</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> x <span class="token operator">%</span> m

<span class="token keyword">def</span> <span class="token function">extended_gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""扩展欧几里得算法求解ax + by = gcd(a, b)"""</span>
    <span class="token keyword">if</span> a <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        g<span class="token punctuation">,</span> y<span class="token punctuation">,</span> x <span class="token operator">=</span> extended_gcd<span class="token punctuation">(</span>b <span class="token operator">%</span> a<span class="token punctuation">,</span> a<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>g<span class="token punctuation">,</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>b <span class="token operator">//</span> a<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">rsa_key_gen</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""生成RSA的公钥和私钥"""</span>
    n <span class="token operator">=</span> p <span class="token operator">*</span> q
    phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    e <span class="token operator">=</span> <span class="token number">65537</span>
    <span class="token comment"># 验证e与φ(n)是否互质</span>
    <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"e与φ(n)不互质，需重新选择e"</span><span class="token punctuation">)</span>
    d <span class="token operator">=</span> mod_inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">rsa_encrypt</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> pub_key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""使用公钥加密明文"""</span>
    e<span class="token punctuation">,</span> n <span class="token operator">=</span> pub_key
    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>plaintext<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">rsa_decrypt</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> priv_key<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""使用私钥解密密文"""</span>
    d<span class="token punctuation">,</span> n <span class="token operator">=</span> priv_key
    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>利用1中生成的素数，构建一个n的长度为1024比特的RSA算法</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> generate_prime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
    q <span class="token operator">=</span> generate_prime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>

    public_key<span class="token punctuation">,</span> private_key <span class="token operator">=</span> rsa_key_gen<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>
    e<span class="token punctuation">,</span> n <span class="token operator">=</span> public_key
    d<span class="token punctuation">,</span> _ <span class="token operator">=</span> private_key
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"公钥 (e, n): </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"私钥 (d, n): </span><span class="token interpolation"><span class="token punctuation">&#123;</span>d<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    plaintext_str <span class="token operator">=</span> <span class="token string">"Hello, RSA!"</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"明文: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>plaintext_str<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token comment"># 将明文转换为整数</span>
    plaintext_bytes <span class="token operator">=</span> plaintext_str<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    plaintext_int <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>plaintext_bytes<span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"明文整数: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>plaintext_int<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token comment"># 检查明文长度是否合法</span>
    <span class="token keyword">if</span> plaintext_int <span class="token operator">>=</span> n<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"明文过长，无法加密"</span><span class="token punctuation">)</span>

    ciphertext <span class="token operator">=</span> rsa_encrypt<span class="token punctuation">(</span>plaintext_int<span class="token punctuation">,</span> public_key<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"密文: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>ciphertext<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    decrypted_int <span class="token operator">=</span> rsa_decrypt<span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> private_key<span class="token punctuation">)</span>
    decrypted_bytes <span class="token operator">=</span> decrypted_int<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token punctuation">(</span>decrypted_int<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">8</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big'</span><span class="token punctuation">)</span>
    decrypted_str <span class="token operator">=</span> decrypted_bytes<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">'replace'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"解密后的明文: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>decrypted_str<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250421102359921.png" alt="image-20250421102359921"></p>
<hr>
<h1 id="Hash函数"><a href="#Hash函数" class="headerlink" title="Hash函数"></a>Hash函数</h1><h2 id="OpenSSL"><a href="#OpenSSL" class="headerlink" title="OpenSSL"></a>OpenSSL</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token parameter variable">-n</span> <span class="token string">"helloworld"</span> <span class="token operator">></span> hello.txt
openssl genrsa <span class="token parameter variable">-out</span> privacy.pem <span class="token number">1024</span>
openssl rsa <span class="token parameter variable">-in</span> privacy.pem <span class="token parameter variable">-pubout</span> <span class="token parameter variable">-out</span> public.pem
openssl rsautl <span class="token parameter variable">-encrypt</span> <span class="token parameter variable">-inkey</span> public.pem <span class="token parameter variable">-pubin</span> <span class="token parameter variable">-in</span> hello.txt <span class="token parameter variable">-out</span> hello.en
openssl rsautl <span class="token parameter variable">-decrypt</span> <span class="token parameter variable">-inkey</span> privacy.pem <span class="token parameter variable">-in</span> hello.en <span class="token parameter variable">-out</span> hello.de<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250427121641057.png" alt="image-20250427121641057"></p>
<hr>
<h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ktsm/p/16350268.html">https://www.cnblogs.com/ktsm/p/16350268.html</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">T <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0xd76aa478</span><span class="token punctuation">,</span> <span class="token number">0xe8c7b756</span><span class="token punctuation">,</span> <span class="token number">0x242070db</span><span class="token punctuation">,</span> <span class="token number">0xc1bdceee</span><span class="token punctuation">,</span>
     <span class="token number">0xf57c0faf</span><span class="token punctuation">,</span> <span class="token number">0x4787c62a</span><span class="token punctuation">,</span> <span class="token number">0xa8304613</span><span class="token punctuation">,</span> <span class="token number">0xfd469501</span><span class="token punctuation">,</span>
     <span class="token number">0x698098d8</span><span class="token punctuation">,</span> <span class="token number">0x8b44f7af</span><span class="token punctuation">,</span> <span class="token number">0xffff5bb1</span><span class="token punctuation">,</span> <span class="token number">0x895cd7be</span><span class="token punctuation">,</span>
     <span class="token number">0x6b901122</span><span class="token punctuation">,</span> <span class="token number">0xfd987193</span><span class="token punctuation">,</span> <span class="token number">0xa679438e</span><span class="token punctuation">,</span> <span class="token number">0x49b40821</span><span class="token punctuation">,</span>
     <span class="token number">0xf61e2562</span><span class="token punctuation">,</span> <span class="token number">0xc040b340</span><span class="token punctuation">,</span> <span class="token number">0x265e5a51</span><span class="token punctuation">,</span> <span class="token number">0xe9b6c7aa</span><span class="token punctuation">,</span>
     <span class="token number">0xd62f105d</span><span class="token punctuation">,</span> <span class="token number">0x2441453</span><span class="token punctuation">,</span> <span class="token number">0xd8a1e681</span><span class="token punctuation">,</span> <span class="token number">0xe7d3fbc8</span><span class="token punctuation">,</span>
     <span class="token number">0x21e1cde6</span><span class="token punctuation">,</span> <span class="token number">0xc33707d6</span><span class="token punctuation">,</span> <span class="token number">0xf4d50d87</span><span class="token punctuation">,</span> <span class="token number">0x455a14ed</span><span class="token punctuation">,</span>
     <span class="token number">0xa9e3e905</span><span class="token punctuation">,</span> <span class="token number">0xfcefa3f8</span><span class="token punctuation">,</span> <span class="token number">0x676f02d9</span><span class="token punctuation">,</span> <span class="token number">0x8d2a4c8a</span><span class="token punctuation">,</span>
     <span class="token number">0xfffa3942</span><span class="token punctuation">,</span> <span class="token number">0x8771f681</span><span class="token punctuation">,</span> <span class="token number">0x6d9d6122</span><span class="token punctuation">,</span> <span class="token number">0xfde5380c</span><span class="token punctuation">,</span>
     <span class="token number">0xa4beea44</span><span class="token punctuation">,</span> <span class="token number">0x4bdecfa9</span><span class="token punctuation">,</span> <span class="token number">0xf6bb4b60</span><span class="token punctuation">,</span> <span class="token number">0xbebfbc70</span><span class="token punctuation">,</span>
     <span class="token number">0x289b7ec6</span><span class="token punctuation">,</span> <span class="token number">0xeaa127fa</span><span class="token punctuation">,</span> <span class="token number">0xd4ef3085</span><span class="token punctuation">,</span> <span class="token number">0x4881d05</span><span class="token punctuation">,</span>
     <span class="token number">0xd9d4d039</span><span class="token punctuation">,</span> <span class="token number">0xe6db99e5</span><span class="token punctuation">,</span> <span class="token number">0x1fa27cf8</span><span class="token punctuation">,</span> <span class="token number">0xc4ac5665</span><span class="token punctuation">,</span>
     <span class="token number">0xf4292244</span><span class="token punctuation">,</span> <span class="token number">0x432aff97</span><span class="token punctuation">,</span> <span class="token number">0xab9423a7</span><span class="token punctuation">,</span> <span class="token number">0xfc93a039</span><span class="token punctuation">,</span>
     <span class="token number">0x655b59c3</span><span class="token punctuation">,</span> <span class="token number">0x8f0ccc92</span><span class="token punctuation">,</span> <span class="token number">0xffeff47d</span><span class="token punctuation">,</span> <span class="token number">0x85845dd1</span><span class="token punctuation">,</span>
     <span class="token number">0x6fa87e4f</span><span class="token punctuation">,</span> <span class="token number">0xfe2ce6e0</span><span class="token punctuation">,</span> <span class="token number">0xa3014314</span><span class="token punctuation">,</span> <span class="token number">0x4e0811a1</span><span class="token punctuation">,</span>
     <span class="token number">0xf7537e82</span><span class="token punctuation">,</span> <span class="token number">0xbd3af235</span><span class="token punctuation">,</span> <span class="token number">0x2ad7d2bb</span><span class="token punctuation">,</span> <span class="token number">0xeb86d391</span><span class="token punctuation">)</span>

SFF <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span>
SGG <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
SHH <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span>
SII <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">&amp;</span> y <span class="token operator">|</span> <span class="token operator">~</span>x <span class="token operator">&amp;</span> z


<span class="token keyword">def</span> <span class="token function">g</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">&amp;</span> z <span class="token operator">|</span> y <span class="token operator">&amp;</span> <span class="token operator">~</span>z


<span class="token keyword">def</span> <span class="token function">h</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> x <span class="token operator">^</span> y <span class="token operator">^</span> z


<span class="token keyword">def</span> <span class="token function">i</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> y <span class="token operator">^</span> <span class="token punctuation">(</span>x <span class="token operator">|</span> <span class="token operator">~</span>z<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">rol</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># num需要是32位的</span>
    <span class="token triple-quoted-string string">"""
    :param num:
    :param count:
    :return:
    """</span>
    b <span class="token operator">=</span> <span class="token punctuation">(</span>num <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> count
    <span class="token keyword">return</span> <span class="token punctuation">(</span>b <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>b <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span>
    <span class="token comment"># return (num &lt;&lt; count) | (num >> 32 - count)</span>


<span class="token keyword">def</span> <span class="token function">ff</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token punctuation">,</span> s<span class="token punctuation">,</span> ti<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    返回值不需要控制长度 超过32位也可以
    :param a:
    :param b:
    :param c:
    :param d:
    :param mj:
    :param s:
    :param ti:
    :return:
    """</span>
    <span class="token keyword">return</span> b <span class="token operator">+</span> rol<span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">+</span> f<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">+</span> mj <span class="token operator">+</span> ti<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">gg</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token punctuation">,</span> s<span class="token punctuation">,</span> ti<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> b <span class="token operator">+</span> rol<span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">+</span> g<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">+</span> mj <span class="token operator">+</span> ti<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">hh</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token punctuation">,</span> s<span class="token punctuation">,</span> ti<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> b <span class="token operator">+</span> rol<span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">+</span> h<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">+</span> mj <span class="token operator">+</span> ti<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">ii</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token punctuation">,</span> s<span class="token punctuation">,</span> ti<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> b <span class="token operator">+</span> rol<span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">+</span> i<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token operator">+</span> mj <span class="token operator">+</span> ti<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">plain2bit</span><span class="token punctuation">(</span>plain<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    三个部分，原文需要小端序就是 0xabce f012   ---> 0x12f0 cdab
            中间的补充码和前面原文一起小端序  8bit小端序
            最后的长度需要单独处理，前后32位进行交换即可
    :param plain:
    :return:
    """</span>
    bit_lis <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    bit_str <span class="token operator">=</span> <span class="token string">""</span>
    bit_lis_32 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> char <span class="token keyword">in</span> plain<span class="token punctuation">:</span>
        bit_str <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">08</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>

    <span class="token comment"># 补位 使总长度除以512的余数为448 512->64B  一个ascii码 8位->1个B</span>
    rmd <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bit_str<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">512</span>
    <span class="token keyword">if</span> rmd <span class="token operator">==</span> <span class="token number">448</span><span class="token punctuation">:</span>
        bit_str <span class="token operator">+=</span> <span class="token string">'1'</span> <span class="token operator">+</span> <span class="token string">'0'</span> <span class="token operator">*</span> <span class="token number">511</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        bit_str <span class="token operator">+=</span> <span class="token string">'1'</span> <span class="token operator">+</span> <span class="token string">'0'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">448</span> <span class="token operator">-</span> rmd <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># 后64位补充长度信息 采用小端序</span>
    <span class="token comment"># len 是比特的数量，不是字符串的数量</span>
    len2_str <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">064</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>
    bit_str <span class="token operator">+=</span> len2_str
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>bit_str<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        bit_lis<span class="token punctuation">.</span>append<span class="token punctuation">(</span>bit_str<span class="token punctuation">[</span>j <span class="token operator">*</span> <span class="token number">512</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">512</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> block <span class="token keyword">in</span> bit_lis<span class="token punctuation">:</span>
        bit_lis_32_item <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">512</span> <span class="token operator">/</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            hex_str <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>block<span class="token punctuation">[</span>j <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">:</span><span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            bit_lis_32_item<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>reverse_hex<span class="token punctuation">(</span>hex_str<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"0x"</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        bit_lis_32<span class="token punctuation">.</span>append<span class="token punctuation">(</span>bit_lis_32_item<span class="token punctuation">)</span>
    <span class="token comment"># 最后64位是32位小端序</span>
    bit_lis_32<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>len2_str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    bit_lis_32<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>len2_str<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>

    <span class="token comment"># print(bit_lis_32)</span>
    <span class="token keyword">return</span> bit_lis_32


<span class="token keyword">def</span> <span class="token function">reverse_hex</span><span class="token punctuation">(</span>hex_str<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    hex_str <span class="token operator">=</span> hex_str<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0x'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    hex_str_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>hex_str<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        hex_str <span class="token operator">=</span> <span class="token string">"0"</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>hex_str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> hex_str

    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        hex_str_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>hex_str<span class="token punctuation">[</span>j<span class="token punctuation">:</span> j <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    hex_str_list<span class="token punctuation">.</span>reverse<span class="token punctuation">(</span><span class="token punctuation">)</span>
    hex_str <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>hex_str_list<span class="token punctuation">)</span>
    <span class="token keyword">return</span> hex_str


<span class="token keyword">def</span> <span class="token function">main_loop</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">:</span>
    lis <span class="token operator">=</span> plain2bit<span class="token punctuation">(</span>plain<span class="token punctuation">)</span>

    A <span class="token operator">=</span> <span class="token number">0x67452301</span>
    B <span class="token operator">=</span> <span class="token number">0xefcdab89</span>
    C <span class="token operator">=</span> <span class="token number">0x98badcfe</span>
    D <span class="token operator">=</span> <span class="token number">0x10325476</span>

    <span class="token keyword">for</span> item <span class="token keyword">in</span> lis<span class="token punctuation">:</span>
        a <span class="token operator">=</span> A
        b <span class="token operator">=</span> B
        c <span class="token operator">=</span> C
        d <span class="token operator">=</span> D
        <span class="token comment"># Round 1   --->  1</span>
        a <span class="token operator">=</span> ff<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> ff<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> ff<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> ff<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> ff<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> ff<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> ff<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> ff<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> ff<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> ff<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> ff<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> ff<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> ff<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> ff<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> ff<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> ff<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SFF<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment"># Round 2   ---> 5</span>
        a <span class="token operator">=</span> gg<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> gg<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> gg<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> gg<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> gg<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> gg<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> gg<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> gg<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> gg<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> gg<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> gg<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> gg<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> gg<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> gg<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> gg<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> gg<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SGG<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment"># Round 3 --->3</span>
        a <span class="token operator">=</span> hh<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> hh<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> hh<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> hh<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> hh<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> hh<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> hh<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> hh<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> hh<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> hh<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> hh<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> hh<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> hh<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> hh<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> hh<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> hh<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SHH<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token comment"># Round 4 --->7</span>
        a <span class="token operator">=</span> ii<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">0</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> ii<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> ii<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> ii<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> ii<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> ii<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> ii<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> ii<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> ii<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> ii<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> ii<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> ii<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        a <span class="token operator">=</span> ii<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        d <span class="token operator">=</span> ii<span class="token punctuation">(</span>d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        c <span class="token operator">=</span> ii<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> ii<span class="token punctuation">(</span>b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> a<span class="token punctuation">,</span> mj<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span>SII<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ti<span class="token operator">=</span>T<span class="token punctuation">[</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">16</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        A <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> A<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span>
        B <span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">+</span> B<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span>
        C <span class="token operator">=</span> <span class="token punctuation">(</span>c <span class="token operator">+</span> C<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span>
        D <span class="token operator">=</span> <span class="token punctuation">(</span>d <span class="token operator">+</span> D<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span>

    result <span class="token operator">=</span> reverse_hex<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> reverse_hex<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> reverse_hex<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> reverse_hex<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>D<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result


<span class="token keyword">def</span> <span class="token function">md5_encrypt</span><span class="token punctuation">(</span>plain_txt<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> main_loop<span class="token punctuation">(</span>plain_txt<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>md5_encrypt<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>运行脚本，返回 <code>d41d8cd98f00b204e9800998ecf8427e</code> ，即空字符串对应的 MD5 值为 d41d8cd98f00b204e9800998ecf8427e</p>
<h3 id="雪崩效应分析"><a href="#雪崩效应分析" class="headerlink" title="雪崩效应分析"></a>雪崩效应分析</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib

<span class="token keyword">def</span> <span class="token function">calculate_md5</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">count_bit_difference</span><span class="token punctuation">(</span>hex1<span class="token punctuation">,</span> hex2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    bin1 <span class="token operator">=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>hex1<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>
    bin2 <span class="token operator">=</span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>hex2<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>b1 <span class="token operator">!=</span> b2 <span class="token keyword">for</span> b1<span class="token punctuation">,</span> b2 <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>bin1<span class="token punctuation">,</span> bin2<span class="token punctuation">)</span><span class="token punctuation">)</span>

original <span class="token operator">=</span> <span class="token string">"The quick brown fox jumps over the lazy dog"</span>
modified <span class="token operator">=</span> original <span class="token operator">+</span> <span class="token string">"."</span>  <span class="token comment"># 微小改动：添加句号</span>

hash_orig <span class="token operator">=</span> calculate_md5<span class="token punctuation">(</span>original<span class="token punctuation">)</span>  <span class="token comment"># 原哈希：9e107d9d372bb6826bd81d3542a419d6</span>
hash_mod <span class="token operator">=</span> calculate_md5<span class="token punctuation">(</span>modified<span class="token punctuation">)</span>

diff_bits <span class="token operator">=</span> count_bit_difference<span class="token punctuation">(</span>hash_orig<span class="token punctuation">,</span> hash_mod<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"修改前后哈希值差异位数：</span><span class="token interpolation"><span class="token punctuation">&#123;</span>diff_bits<span class="token punctuation">&#125;</span></span><span class="token string"> 位"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95%E5%AE%9E%E8%AE%AD/image-20250427123159687.png" alt="image-20250427123159687"></p>
<p>微小输入变化导致哈希值显著变化（约50%位不同）</p>

    </div>
    
    
    
    
    
    
    
</div>

            </div>
        </transition>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/blog/js/main.js"></script>
    
    




    
    

<div id="vcomments"></div>

<script src="/blog/js/lib/valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        app_id: 'U9mZLKunkRUTcBFthjXPjnZE-9Nh9j0Va',
        app_key: 'SzWOnY0PWLGNuL6jW8TZYc7j',
        visitor: 'true',
        placeholder: '写点什么吧(●ˇ∀ˇ●)',
        serverURLs: 'https://u9mzlkun.lc-cn-n1-shared.com',
    });
</script>

    <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2025 雲流のLowest World
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;C1oudfL0w0
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

<script src="/blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/blog/live2dw/assets/z16.model.json"},"display":{"position":"left","width":150,"height":290},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>